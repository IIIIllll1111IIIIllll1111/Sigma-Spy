--[[
	⣿⣿⣿⣿⣿ SIGMA SPY ⣿⣿⣿⣿⣿
	⣿⣿⣯⡉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉
	⠉⠻⣿⣿⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠈⠻⣿⣿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⠙⢿⣿⣿⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⠀⠀⣉⣿⣿⣿⠆⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⣠⣾⣿⣿⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⢀⣴⣿⣿⡿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⣀⣴⣿⣿⠟⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⣿⣿⣟⣁⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀
	⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿

	@author depso (depthso) - Original Creator
	@original_repo https://github.com/depthso (deleted)
	@reupload_by Dexz00 and Ababa and ncwwcn
	@repo https://github.com/IIIIllll1111IIIIllll1111/Sigma-Spy
	@license MIT
	@description v12.1.0 - Reupload with bug fixes (original repo was deleted)
    
	This file is COMPILED, check /src folder for the source
	Build scripts are available in /build
	
	NOTE: This is a REUPLOAD of the original Sigma Spy by depso.
	The original repository was deleted, so this version includes
	bug fixes and maintenance to keep the project working.
]]

local a={UseWorkspace=false,NoActors=false,FolderName='Sigma Spy',RepoUrl=
'https://raw.githubusercontent.com/IIIIllll1111IIIIllll1111/Sigma-Spy/main',ParserUrl=
[[https://raw.githubusercontent.com/IIIIllll1111IIIIllll1111/Roblox-parser/refs/heads/main/dist/Main.luau]]
}print[[[Sigma Spy] v12.1.0 by depso - Reupload & Bug Fixes by Dexz00 and Ababa and ncwwcn]]local b={
...}local c=b[1]if typeof(c)=='table'then for d,e in c do a[d]=e end end local d
=setmetatable({},{__index=function(d,e)local f=game:GetService(e)return
cloneref(f)end})local e=(function()local e,f={UseWorkspace=false,Folder=
'Sigma spy',RepoUrl=nil,FolderStructure={['Sigma Spy']={'assets'}}}function e:
Init(g)local h,i=self.FolderStructure,g.Services f=i.HttpService self:
CheckFolders(h)end function e:PushConfig(g)for h,i in next,g do self[h]=i end
end function e:UrlFetch(g)local h={Url=g:gsub(' ','%%20'),Method='GET'}local i,j
=pcall(request,h)if not i then warn'[!] HTTP request error! Check console (F9)'
warn('> Url:',g)error(j)return''end local k,l=j.Body,j.StatusCode if l==404 then
warn'[!] The file requested has moved or been deleted.'warn(' >',g)return''end
return k,j end function e:MakePath(g)local h=self.Folder return`{h}/{g}`end
function e:LoadCustomasset(g)if not getcustomasset then return end if not g then
return end local h=readfile(g)if#h<=0 then return end local i,j=pcall(
getcustomasset,g)if not i then return end if not j or#j<=0 then return end
return j end function e:GetFile(g,h)local i,j,k,l=self.RepoUrl,self.UseWorkspace
,self:MakePath(g),''if j then l=readfile(k)else l=self:UrlFetch(`{i}/{g}`)end if
h then self:FileCheck(k,function()return l end)return self:LoadCustomasset(k)end
return l end function e:GetTemplate(g)return self:GetFile(`templates/{g}.lua`)
end function e:FileCheck(g,h)if isfile(g)then return end local i=h()writefile(g,
i)end function e:FolderCheck(g)if isfolder(g)then return end makefolder(g)end
function e:CheckPath(g,h)return g and`{g}/{h}`or h end function e:CheckFolders(g
,h)for i,j in next,g do if typeof(j)=='table'then local k=self:CheckPath(h,i)
self:FolderCheck(k)self:CheckFolders(j,k)continue end local k=self:CheckPath(h,j
)self:FolderCheck(k)end end function e:TemplateCheck(g,h)self:FileCheck(g,
function()return self:GetTemplate(h)end)end function e:GetAsset(g,h)return self:
GetFile(`assets/{g}`,h)end function e:GetModule(g,h)local i=`{g}.lua`if h then
self:TemplateCheck(i,h)local j=readfile(i)local k=loadstring(j)if k then return
j end return self:GetTemplate(h)end return self:GetFile(i)end function e:
LoadLibraries(g,...)local h={}for i,j in next,g do local k=typeof(j)=='table'and
j[1]=='base64'j=k and j[2]or j if typeof(j)~='string'and not k then h[i]=j
continue end if k then j=crypt.base64decode(j)g[i]=j end local l,m=loadstring(j,
i)assert(l,`Failed to load {i}: {m}`)h[i]=l(...)end return h end function e:
LoadModules(g,h)for i,j in next,g do local k=j.Init if not k then continue end j
:Init(h)end end function e:CreateFont(g,h)if not h then return end local i=`assets/{
g}.json`local j,k=self:MakePath(i),{name=g,faces={{name='Regular',weight=400,
style='Normal',assetId=h}}}local l=f:JSONEncode(k)writefile(j,l)return j end
function e:CompileModule(g)local h='local Libraries = {'for i,j in g do if
typeof(j)~='string'then continue end h..=`\t{i} = (function()\n{j}\nend)(),\n`
end h..='}'return h end function e:MakeActorScript(g,h)local i=e:CompileModule(g
)i..='\r\n\tlocal ExtraData = {\r\n\t\tIsActor = true\r\n\t}\r\n\t'i..=`Libraries.Hook:BeginService(Libraries, ExtraData, {
h})`return i end return e end)()e:PushConfig(a)e:Init{Services=d}local f=e.
FolderName local g,h={Config=e:GetModule(`{f}/Config`,'Config'),ReturnSpoofs=e:
GetModule(`{f}/Return spoofs`,'Return Spoofs'),Configuration=a,Files=e,Process={
'base64',
[[dHlwZSB0YWJsZSA9IHsNCiAgICBbYW55XTogYW55DQp9DQoNCnR5cGUgUmVtb3RlRGF0YSA9IHsNCglSZW1vdGU6IEluc3RhbmNlLA0KICAgIE5vQmFja3RyYWNlOiBib29sZWFuPywNCglJc1JlY2VpdmU6IGJvb2xlYW4/LA0KCUFyZ3M6IHRhYmxlLA0KICAgIElkOiBzdHJpbmcsDQoJTWV0aG9kOiBzdHJpbmcsDQogICAgVHJhbnNmZXJUeXBlOiBzdHJpbmcsDQoJVmFsdWVSZXBsYWNlbWVudHM6IHRhYmxlLA0KICAgIFJldHVyblZhbHVlczogdGFibGUsDQogICAgT3JpZ2luYWxGdW5jOiAoSW5zdGFuY2UsIC4uLmFueSkgLT4gLi4uYW55DQp9DQoNCi0tLy8gTW9kdWxlDQpsb2NhbCBQcm9jZXNzID0gew0KICAgIC0tLy8gUmVtb3RlIGNsYXNzZXMNCiAgICBSZW1vdGVDbGFzc0RhdGEgPSB7DQogICAgICAgIFsiUmVtb3RlRXZlbnQiXSA9IHsNCiAgICAgICAgICAgIFNlbmQgPSB7DQogICAgICAgICAgICAgICAgIkZpcmVTZXJ2ZXIiLA0KICAgICAgICAgICAgICAgICJmaXJlU2VydmVyIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBSZWNlaXZlID0gew0KICAgICAgICAgICAgICAgICJPbkNsaWVudEV2ZW50IiwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgWyJSZW1vdGVGdW5jdGlvbiJdID0gew0KICAgICAgICAgICAgSXNSZW1vdGVGdW5jdGlvbiA9IHRydWUsDQogICAgICAgICAgICBTZW5kID0gew0KICAgICAgICAgICAgICAgICJJbnZva2VTZXJ2ZXIiLA0KICAgICAgICAgICAgICAgICJpbnZva2VTZXJ2ZXIiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIFJlY2VpdmUgPSB7DQogICAgICAgICAgICAgICAgIk9uQ2xpZW50SW52b2tlIiwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgWyJVbnJlbGlhYmxlUmVtb3RlRXZlbnQiXSA9IHsNCiAgICAgICAgICAgIFNlbmQgPSB7DQogICAgICAgICAgICAgICAgIkZpcmVTZXJ2ZXIiLA0KICAgICAgICAgICAgICAgICJmaXJlU2VydmVyIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBSZWNlaXZlID0gew0KICAgICAgICAgICAgICAgICJPbkNsaWVudEV2ZW50IiwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgWyJCaW5kYWJsZUV2ZW50Il0gPSB7DQogICAgICAgICAgICBOb1JlY2l2ZUhvb2sgPSB0cnVlLA0KICAgICAgICAgICAgU2VuZCA9IHsNCiAgICAgICAgICAgICAgICAiRmlyZSIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgUmVjZWl2ZSA9IHsNCiAgICAgICAgICAgICAgICAiRXZlbnQiLA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBbIkJpbmRhYmxlRnVuY3Rpb24iXSA9IHsNCiAgICAgICAgICAgIElzUmVtb3RlRnVuY3Rpb24gPSB0cnVlLA0KICAgICAgICAgICAgTm9SZWNpdmVIb29rID0gdHJ1ZSwNCiAgICAgICAgICAgIFNlbmQgPSB7DQogICAgICAgICAgICAgICAgIkludm9rZSIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgUmVjZWl2ZSA9IHsNCiAgICAgICAgICAgICAgICAiT25JbnZva2UiLA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSwNCiAgICBSZW1vdGVPcHRpb25zID0ge30sDQogICAgTG9vcGluZ1JlbW90ZXMgPSB7fSwNCiAgICBDb25maWdPdmVyd3JpdGVzID0gew0KICAgICAgICBbeyJzaXJodXJ0IiwgInBvdGFzc2l1bSIsICJ3YXZlIn1dID0gew0KICAgICAgICAgICAgRm9yY2VVc2VDdXN0b21Db21tID0gdHJ1ZQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQotLS8vIE1vZHVsZXMNCmxvY2FsIEhvb2sNCmxvY2FsIENvbW11bmljYXRpb24NCmxvY2FsIFJldHVyblNwb29mcw0KbG9jYWwgVWkNCmxvY2FsIENvbmZpZw0KDQotLS8vIFNlcnZpY2VzDQpsb2NhbCBIdHRwU2VydmljZTogSHR0cFNlcnZpY2UNCg0KLS0vLyBDb21tdW5pY2F0aW9uIGNoYW5uZWwNCmxvY2FsIENoYW5uZWwNCmxvY2FsIFdyYXBwZWRDaGFubmVsID0gZmFsc2UNCg0KbG9jYWwgU2lnbWFFTlYgPSBnZXRmZW52KDEpDQoNCmZ1bmN0aW9uIFByb2Nlc3M6TWVyZ2UoQmFzZTogdGFibGUsIE5ldzogdGFibGUpDQogICAgaWYgbm90IE5ldyB0aGVuIHJldHVybiBlbmQNCglmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBOZXcgZG8NCgkJQmFzZVtLZXldID0gVmFsdWUNCgllbmQNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkluaXQoRGF0YSkNCiAgICBsb2NhbCBNb2R1bGVzID0gRGF0YS5Nb2R1bGVzDQogICAgbG9jYWwgU2VydmljZXMgPSBEYXRhLlNlcnZpY2VzDQoNCiAgICAtLS8vIFNlcnZpY2VzDQogICAgSHR0cFNlcnZpY2UgPSBTZXJ2aWNlcy5IdHRwU2VydmljZQ0KDQogICAgLS0vLyBNb2R1bGVzDQogICAgQ29uZmlnID0gTW9kdWxlcy5Db25maWcNCiAgICBVaSA9IE1vZHVsZXMuVWkNCiAgICBIb29rID0gTW9kdWxlcy5Ib29rDQogICAgQ29tbXVuaWNhdGlvbiA9IE1vZHVsZXMuQ29tbXVuaWNhdGlvbg0KICAgIFJldHVyblNwb29mcyA9IE1vZHVsZXMuUmV0dXJuU3Bvb2ZzDQplbmQNCg0KLS0vLyBDb21tdW5pY2F0aW9uDQpmdW5jdGlvbiBQcm9jZXNzOlNldENoYW5uZWwoTmV3Q2hhbm5lbDogQmluZGFibGVFdmVudCwgSXNXcmFwcGVkOiBib29sZWFuKQ0KICAgIENoYW5uZWwgPSBOZXdDaGFubmVsDQogICAgV3JhcHBlZENoYW5uZWwgPSBJc1dyYXBwZWQNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkdldENvbmZpZ092ZXJ3cml0ZXMoTmFtZTogc3RyaW5nKQ0KICAgIGxvY2FsIENvbmZpZ092ZXJ3cml0ZXMgPSBzZWxmLkNvbmZpZ092ZXJ3cml0ZXMNCg0KICAgIGZvciBMaXN0LCBPdmVyd3JpdGVzIGluIG5leHQsIENvbmZpZ092ZXJ3cml0ZXMgZG8NCiAgICAgICAgaWYgbm90IHRhYmxlLmZpbmQoTGlzdCwgTmFtZSkgdGhlbiBjb250aW51ZSBlbmQNCiAgICAgICAgcmV0dXJuIE92ZXJ3cml0ZXMNCiAgICBlbmQNCiAgICByZXR1cm4NCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNoZWNrQ29uZmlnKENvbmZpZzogdGFibGUpDQogICAgbG9jYWwgTmFtZSA9IGlkZW50aWZ5ZXhlY3V0b3IoKTpsb3dlcigpDQoNCiAgICAtLS8vIEZvcmNlIGNvbmZpZ3VyYXRpb24gb3ZlcndyaXRlcyBmb3Igc3BlY2lmaWMgZXhlY3V0b3JzDQogICAgbG9jYWwgT3ZlcndyaXRlcyA9IHNlbGY6R2V0Q29uZmlnT3ZlcndyaXRlcyhOYW1lKQ0KICAgIGlmIG5vdCBPdmVyd3JpdGVzIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgc2VsZjpNZXJnZShDb25maWcsIE92ZXJ3cml0ZXMpDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpDbGVhbkNFcnJvcihFcnJvcjogc3RyaW5nKTogc3RyaW5nDQogICAgRXJyb3IgPSBFcnJvcjpnc3ViKCI6JWQrOiAiLCAiIikNCiAgICBFcnJvciA9IEVycm9yOmdzdWIoIiwgZ290ICVhKyIsICIiKQ0KICAgIEVycm9yID0gRXJyb3I6Z3N1YigiaW52YWxpZCBhcmd1bWVudCIsICJtaXNzaW5nIGFyZ3VtZW50IikNCiAgICByZXR1cm4gRXJyb3INCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNvdW50TWF0Y2hlcyhTdHJpbmc6IHN0cmluZywgTWF0Y2g6IHN0cmluZyk6IG51bWJlcg0KCWxvY2FsIENvdW50ID0gMA0KCWZvciBfIGluIFN0cmluZzpnbWF0Y2goTWF0Y2gpIGRvDQoJCUNvdW50ICs9MSANCgllbmQNCg0KCXJldHVybiBDb3VudA0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6Q2hlY2tWYWx1ZShWYWx1ZSwgSWdub3JlOiB0YWJsZT8sIENhY2hlOiB0YWJsZT8pDQogICAgbG9jYWwgVHlwZSA9IHR5cGVvZihWYWx1ZSkNCiAgICBDb21tdW5pY2F0aW9uOldhaXRDaGVjaygpDQogICAgDQogICAgaWYgVHlwZSA9PSAidGFibGUiIHRoZW4NCiAgICAgICAgVmFsdWUgPSBzZWxmOkRlZXBDbG9uZVRhYmxlKFZhbHVlLCBJZ25vcmUsIENhY2hlKQ0KICAgIGVsc2VpZiBUeXBlID09ICJJbnN0YW5jZSIgdGhlbg0KICAgICAgICBWYWx1ZSA9IGNsb25lcmVmKFZhbHVlKQ0KICAgIGVuZA0KICAgIA0KICAgIHJldHVybiBWYWx1ZQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6RGVlcENsb25lVGFibGUoVGFibGUsIElnbm9yZTogdGFibGU/LCBWaXNpdGVkOiB0YWJsZT8pOiB0YWJsZQ0KICAgIGlmIHR5cGVvZihUYWJsZSkgfj0gInRhYmxlIiB0aGVuIHJldHVybiBUYWJsZSBlbmQNCiAgICBsb2NhbCBDYWNoZSA9IFZpc2l0ZWQgb3Ige30NCg0KICAgIC0tLy8gQ2hlY2sgZm9yIGNhY2hlZA0KICAgIGlmIENhY2hlW1RhYmxlXSB0aGVuDQogICAgICAgIHJldHVybiBDYWNoZVtUYWJsZV0NCiAgICBlbmQNCg0KICAgIGxvY2FsIE5ldyA9IHt9DQogICAgQ2FjaGVbVGFibGVdID0gTmV3DQoNCiAgICBmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBUYWJsZSBkbw0KICAgICAgICAtLS8vIENoZWNrIGlmIHRoZSB2YWx1ZSBpcyBpZ25vcmVkDQogICAgICAgIGlmIElnbm9yZSBhbmQgdGFibGUuZmluZChJZ25vcmUsIFZhbHVlKSB0aGVuIGNvbnRpbnVlIGVuZA0KICAgICAgICANCiAgICAgICAgS2V5ID0gc2VsZjpDaGVja1ZhbHVlKEtleSwgSWdub3JlLCBDYWNoZSkNCiAgICAgICAgTmV3W0tleV0gPSBzZWxmOkNoZWNrVmFsdWUoVmFsdWUsIElnbm9yZSwgQ2FjaGUpDQogICAgZW5kDQoNCiAgICAtLS8vIE1hc3RlciBjbGVhcg0KICAgIGlmIG5vdCBWaXNpdGVkIHRoZW4NCiAgICAgICAgdGFibGUuY2xlYXIoQ2FjaGUpDQogICAgZW5kDQogICAgDQogICAgcmV0dXJuIE5ldw0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6VW5wYWNrKFRhYmxlOiB0YWJsZSkNCiAgICBpZiBub3QgVGFibGUgdGhlbiByZXR1cm4gVGFibGUgZW5kDQoJbG9jYWwgTGVuZ3RoID0gdGFibGUubWF4bihUYWJsZSkNCglyZXR1cm4gdW5wYWNrKFRhYmxlLCAxLCBMZW5ndGgpDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpQdXNoQ29uZmlnKE92ZXJ3cml0ZXMpDQogICAgc2VsZjpNZXJnZShzZWxmLCBPdmVyd3JpdGVzKQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6RnVuY0V4aXN0cyhOYW1lOiBzdHJpbmcpDQoJcmV0dXJuIFNpZ21hRU5WW05hbWVdDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpDaGVja0V4ZWN1dG9yKCk6IGJvb2xlYW4NCiAgICBsb2NhbCBCbGFja2xpc3RlZCA9IHsNCiAgICAgICAgInhlbm8iLA0KICAgICAgICAic29sYXJhIiwNCiAgICAgICAgImpqc3Bsb2l0Ig0KICAgIH0NCg0KICAgIGxvY2FsIE5hbWUgPSBpZGVudGlmeWV4ZWN1dG9yKCk6bG93ZXIoKQ0KICAgIGxvY2FsIElzQmxhY2tsaXN0ZWQgPSB0YWJsZS5maW5kKEJsYWNrbGlzdGVkLCBOYW1lKQ0KDQogICAgLS0vLyBTb21lIGV4ZWN1dG9ycyBoYXZlIGJyb2tlbiBmdW5jdGlvbmFsaXR5DQogICAgaWYgSXNCbGFja2xpc3RlZCB0aGVuDQogICAgICAgIFVpOlNob3dVbnN1cHBvcnRlZEV4ZWN1dG9yKE5hbWUpDQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgIGVuZA0KDQogICAgcmV0dXJuIHRydWUNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNoZWNrRnVuY3Rpb25zKCk6IGJvb2xlYW4NCiAgICBsb2NhbCBDb3JlRnVuY3Rpb25zID0gew0KICAgICAgICAiaG9va21ldGFtZXRob2QiLA0KICAgICAgICAiaG9va2Z1bmN0aW9uIiwNCiAgICAgICAgImdldHJhd21ldGF0YWJsZSIsDQogICAgICAgICJzZXRyZWFkb25seSINCiAgICB9DQoNCiAgICAtLS8vIENoZWNrIGlmIHRoZSBmdW5jdGlvbnMgZXhpc3QgaW4gdGhlIEVOVg0KICAgIGZvciBfLCBOYW1lIGluIENvcmVGdW5jdGlvbnMgZG8NCiAgICAgICAgbG9jYWwgRnVuYyA9IHNlbGY6RnVuY0V4aXN0cyhOYW1lKQ0KICAgICAgICBpZiBGdW5jIHRoZW4gY29udGludWUgZW5kDQoNCiAgICAgICAgLS0vLyBGdW5jdGlvbiBtaXNzaW5nIQ0KICAgICAgICBVaTpTaG93VW5zdXBwb3J0ZWQoTmFtZSkNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgZW5kDQoNCiAgICByZXR1cm4gdHJ1ZQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6Q2hlY2tJc1N1cHBvcnRlZCgpOiBib29sZWFuDQogICAgLS0vLyBDaGVjayBpZiB0aGUgZXhlY3V0b3IgaXMgYmxhY2tsaXN0ZWQNCiAgICBsb2NhbCBFeGVjdXRvclN1cHBvcnRlZCA9IHNlbGY6Q2hlY2tFeGVjdXRvcigpDQogICAgaWYgbm90IEV4ZWN1dG9yU3VwcG9ydGVkIHRoZW4NCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgZW5kDQoNCiAgICAtLS8vIENoZWNrIGlmIHRoZSBjb3JlIGZ1bmN0aW9ucyBleGlzdA0KICAgIGxvY2FsIEZ1bmN0aW9uc1N1cHBvcnRlZCA9IHNlbGY6Q2hlY2tGdW5jdGlvbnMoKQ0KICAgIGlmIG5vdCBGdW5jdGlvbnNTdXBwb3J0ZWQgdGhlbg0KICAgICAgICByZXR1cm4gZmFsc2UNCiAgICBlbmQNCg0KICAgIHJldHVybiB0cnVlDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpHZXRDbGFzc0RhdGEoUmVtb3RlOiBJbnN0YW5jZSk6IHRhYmxlPw0KICAgIGxvY2FsIFJlbW90ZUNsYXNzRGF0YSA9IHNlbGYuUmVtb3RlQ2xhc3NEYXRhDQogICAgbG9jYWwgQ2xhc3NOYW1lID0gSG9vazpJbmRleChSZW1vdGUsICJDbGFzc05hbWUiKQ0KDQogICAgcmV0dXJuIFJlbW90ZUNsYXNzRGF0YVtDbGFzc05hbWVdDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpJc1Byb3RlY3RlZFJlbW90ZShSZW1vdGU6IEluc3RhbmNlKTogYm9vbGVhbg0KICAgIGxvY2FsIElzRGVidWcgPSBSZW1vdGUgPT0gQ29tbXVuaWNhdGlvbi5EZWJ1Z0lkUmVtb3RlDQogICAgbG9jYWwgSXNDaGFubmVsID0gUmVtb3RlID09IChXcmFwcGVkQ2hhbm5lbCBhbmQgQ2hhbm5lbC5DaGFubmVsIG9yIENoYW5uZWwpDQoNCiAgICByZXR1cm4gSXNEZWJ1ZyBvciBJc0NoYW5uZWwNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOlJlbW90ZUFsbG93ZWQoUmVtb3RlOiBJbnN0YW5jZSwgVHJhbnNmZXJUeXBlOiBzdHJpbmcsIE1ldGhvZDogc3RyaW5nPyk6IGJvb2xlYW4/DQogICAgaWYgdHlwZW9mKFJlbW90ZSkgfj0gJ0luc3RhbmNlJyB0aGVuIHJldHVybiBlbmQNCiAgICANCiAgICAtLS8vIENoZWNrIGlmIHRoZSBSZW1vdGUgaXMgcHJvdGVjdGVkDQogICAgaWYgc2VsZjpJc1Byb3RlY3RlZFJlbW90ZShSZW1vdGUpIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgLS0vLyBGZXRjaCBjbGFzcyB0YWJsZQ0KCWxvY2FsIENsYXNzRGF0YSA9IHNlbGY6R2V0Q2xhc3NEYXRhKFJlbW90ZSkNCglpZiBub3QgQ2xhc3NEYXRhIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgLS0vLyBDaGVjayBpZiB0aGUgdHJhbnNmZXIgdHlwZSBoYXMgZGF0YQ0KCWxvY2FsIEFsbG93ZWQgPSBDbGFzc0RhdGFbVHJhbnNmZXJUeXBlXQ0KCWlmIG5vdCBBbGxvd2VkIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgLS0vLyBDaGVjayBpZiB0aGUgbWV0aG9kIGlzIGFsbG93ZWQNCglpZiBNZXRob2QgdGhlbg0KCQlyZXR1cm4gdGFibGUuZmluZChBbGxvd2VkLCBNZXRob2QpIH49IG5pbA0KCWVuZA0KDQoJcmV0dXJuIHRydWUNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOlNldEV4dHJhRGF0YShEYXRhOiB0YWJsZSkNCiAgICBpZiBub3QgRGF0YSB0aGVuIHJldHVybiBlbmQNCiAgICBzZWxmLkV4dHJhRGF0YSA9IERhdGENCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkdldFJlbW90ZVNwb29mKFJlbW90ZTogSW5zdGFuY2UsIE1ldGhvZDogc3RyaW5nLCAuLi4pOiB0YWJsZT8NCiAgICBsb2NhbCBTcG9vZiA9IFJldHVyblNwb29mc1tSZW1vdGVdDQoNCiAgICBpZiBub3QgU3Bvb2YgdGhlbiByZXR1cm4gZW5kDQogICAgaWYgU3Bvb2YuTWV0aG9kIH49IE1ldGhvZCB0aGVuIHJldHVybiBlbmQNCg0KICAgIGxvY2FsIFJldHVyblZhbHVlcyA9IFNwb29mLlJldHVybg0KDQogICAgLS0vLyBDYWxsIHRoZSBSZXR1cm5WYWx1ZXMgZnVuY3Rpb24gdHlwZQ0KICAgIGlmIHR5cGVvZihSZXR1cm5WYWx1ZXMpID09ICJmdW5jdGlvbiIgdGhlbg0KICAgICAgICBSZXR1cm5WYWx1ZXMgPSBSZXR1cm5WYWx1ZXMoLi4uKQ0KICAgIGVuZA0KDQoJcmV0dXJuIFJldHVyblZhbHVlcw0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6U2V0TmV3UmV0dXJuU3Bvb2ZzKE5ld1JldHVyblNwb29mczogdGFibGUpDQogICAgUmV0dXJuU3Bvb2ZzID0gTmV3UmV0dXJuU3Bvb2ZzDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpGaW5kQ2FsbGluZ0xDbG9zdXJlKE9mZnNldDogbnVtYmVyKQ0KICAgIGxvY2FsIEdldGZlbnYgPSBIb29rOkdldE9yaWdpbmFsRnVuYyhnZXRmZW52KQ0KICAgIE9mZnNldCArPSAxDQoNCiAgICB3aGlsZSB0cnVlIGRvDQogICAgICAgIE9mZnNldCArPSAxDQoNCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGUgc3RhY2sgbGV2ZWwgaXMgdmFsaWQNCiAgICAgICAgbG9jYWwgSXNWYWxpZCA9IGRlYnVnLmluZm8oT2Zmc2V0LCAibCIpIH49IC0xDQogICAgICAgIGlmIG5vdCBJc1ZhbGlkIHRoZW4gY29udGludWUgZW5kDQoNCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGUgZnVuY3Rpb24gaXMgdmFsaWQNCiAgICAgICAgbG9jYWwgRnVuY3Rpb24gPSBkZWJ1Zy5pbmZvKE9mZnNldCwgImYiKQ0KICAgICAgICBpZiBub3QgRnVuY3Rpb24gdGhlbiByZXR1cm4gZW5kDQogICAgICAgIGlmIEdldGZlbnYoRnVuY3Rpb24pID09IFNpZ21hRU5WIHRoZW4gY29udGludWUgZW5kDQoNCiAgICAgICAgcmV0dXJuIEZ1bmN0aW9uDQogICAgZW5kDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpEZWNvbXBpbGUoU2NyaXB0OiBMb2NhbFNjcmlwdCB8IE1vZHVsZVNjcmlwdCk6IHN0cmluZw0KICAgIGxvY2FsIEtvbnN0YW50QVBJID0gImh0dHA6Ly9hcGkucGx1c2dpYW50NS5jb20va29uc3RhbnQvZGVjb21waWxlIg0KICAgIGxvY2FsIEZvcmNlS29uc3RhbnQgPSBDb25maWcgYW5kIENvbmZpZy5Gb3JjZUtvbnN0YW50RGVjb21waWxlciBvciBmYWxzZQ0KDQogICAgLS0vLyBVc2UgYnVpbHQtaW4gZGVjb21waWxlciBpZiB0aGUgZXhlY3V0b3Igc3VwcG9ydHMgaXQNCiAgICBpZiBkZWNvbXBpbGUgYW5kIG5vdCBGb3JjZUtvbnN0YW50IHRoZW4gDQogICAgICAgIHJldHVybiBkZWNvbXBpbGUoU2NyaXB0KQ0KICAgIGVuZA0KDQogICAgLS0vLyBnZXRzY3JpcHRieXRlY29kZQ0KICAgIGxvY2FsIFN1Y2Nlc3MsIEJ5dGVjb2RlID0gcGNhbGwoZ2V0c2NyaXB0Ynl0ZWNvZGUsIFNjcmlwdCkNCiAgICBpZiBub3QgU3VjY2VzcyB0aGVuDQogICAgICAgIGxvY2FsIEVycm9yID0gYC0tRmFpbGVkIHRvIGdldCBzY3JpcHQgYnl0ZWNvZGUsIGVycm9yOlxuYA0KICAgICAgICBFcnJvciAuLj0gYFxuLS1bW1xue0J5dGVjb2RlfVxuXV1gDQogICAgICAgIHJldHVybiBFcnJvciwgdHJ1ZQ0KICAgIGVuZA0KICAgIA0KICAgIC0tLy8gU2VuZCBQT1NUIHJlcXVlc3QgdG8gdGhlIEFQSQ0KICAgIGxvY2FsIFJlc3BvbmNlID0gcmVxdWVzdCh7DQogICAgICAgIFVybCA9IEtvbnN0YW50QVBJLA0KICAgICAgICBCb2R5ID0gQnl0ZWNvZGUsDQogICAgICAgIE1ldGhvZCA9ICJQT1NUIiwNCiAgICAgICAgSGVhZGVycyA9IHsNCiAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAidGV4dC9wbGFpbiINCiAgICAgICAgfSwNCiAgICB9KQ0KDQogICAgLS0vLyBFcnJvciBjaGVjaw0KICAgIGlmIFJlc3BvbmNlLlN0YXR1c0NvZGUgfj0gMjAwIHRoZW4NCiAgICAgICAgbG9jYWwgRXJyb3IgPSBgLS1bS09OU1RBTlRdIEVycm9yIG9jY3VyZWQgd2hpbGUgcmVxdWVzdGluZyB0aGUgQVBJLCBlcnJvcjpcbmANCiAgICAgICAgRXJyb3IgLi49IGBcbi0tW1tcbntSZXNwb25jZS5Cb2R5fVxuXV1gDQogICAgICAgIHJldHVybiBFcnJvciwgdHJ1ZQ0KICAgIGVuZA0KDQogICAgcmV0dXJuIFJlc3BvbmNlLkJvZHkNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkdldFNjcmlwdEZyb21GdW5jKEZ1bmM6ICguLi5hbnkpIC0+IC4uLmFueSkNCiAgICBpZiBub3QgRnVuYyB0aGVuIHJldHVybiBlbmQNCg0KICAgIGxvY2FsIFN1Y2Nlc3MsIEVOViA9IHBjYWxsKGdldGZlbnYsIEZ1bmMpDQogICAgaWYgbm90IFN1Y2Nlc3MgdGhlbiByZXR1cm4gZW5kDQogICAgDQogICAgLS0vLyBCbGFja2xpc3Qgc2lnbWEgc3B5DQogICAgaWYgc2VsZjpJc1NpZ21hU3B5RU5WKEVOVikgdGhlbiByZXR1cm4gZW5kDQoNCiAgICByZXR1cm4gcmF3Z2V0KEVOViwgInNjcmlwdCIpDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpDb25uZWN0aW9uSXNWYWxpZChDb25uZWN0aW9uOiB0YWJsZSk6IGJvb2xlYW4NCiAgICBsb2NhbCBWYWx1ZVJlcGxhY2VtZW50cyA9IHsNCgkJWyJTY3JpcHQiXSA9IGZ1bmN0aW9uKENvbm5lY3Rpb246IHRhYmxlKTogU2NyaXB0Pw0KCQkJbG9jYWwgRnVuY3Rpb24gPSBDb25uZWN0aW9uLkZ1bmN0aW9uDQoJCQlpZiBub3QgRnVuY3Rpb24gdGhlbiByZXR1cm4gZW5kDQoNCgkJCXJldHVybiBzZWxmOkdldFNjcmlwdEZyb21GdW5jKEZ1bmN0aW9uKQ0KCQllbmQNCgl9DQoNCiAgICAtLS8vIENoZWNrIGlmIHRoZXNlIHByb3BlcnRpZXMgYXJlIHZhbGlkDQogICAgbG9jYWwgVG9DaGVjayA9IHsNCiAgICAgICAgIlNjcmlwdCINCiAgICB9DQogICAgZm9yIF8sIFByb3BlcnR5IGluIFRvQ2hlY2sgZG8NCiAgICAgICAgbG9jYWwgUmVwbGFjZW1lbnQgPSBWYWx1ZVJlcGxhY2VtZW50c1tQcm9wZXJ0eV0NCiAgICAgICAgbG9jYWwgVmFsdWUNCg0KICAgICAgICAtLS8vIENoZWNrIGlmIHRoZXJlJ3MgYSBmdW5jdGlvbiBmb3IgYSBwcm9wZXJ0eQ0KICAgICAgICBpZiBSZXBsYWNlbWVudCB0aGVuDQogICAgICAgICAgICBWYWx1ZSA9IFJlcGxhY2VtZW50KENvbm5lY3Rpb24pDQogICAgICAgIGVuZA0KDQogICAgICAgIC0tLy8gQ2hlY2sgaWYgdGhlIHByb3BlcnR5IGhhcyBhIHZhbHVlDQogICAgICAgIGlmIFZhbHVlID09IG5pbCB0aGVuIA0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlIA0KICAgICAgICBlbmQNCiAgICBlbmQNCg0KICAgIHJldHVybiB0cnVlDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpGaWx0ZXJDb25uZWN0aW9ucyhTaWduYWw6IFJCWFNjcmlwdFNpZ25hbCk6IHRhYmxlDQogICAgbG9jYWwgUHJvY2Vzc2VkID0ge30NCg0KICAgIC0tLy8gRmlsdGVyIGVhY2ggY29ubmVjdGlvbg0KICAgIGZvciBfLCBDb25uZWN0aW9uIGluIGdldGNvbm5lY3Rpb25zKFNpZ25hbCkgZG8NCiAgICAgICAgaWYgbm90IHNlbGY6Q29ubmVjdGlvbklzVmFsaWQoQ29ubmVjdGlvbikgdGhlbiBjb250aW51ZSBlbmQNCiAgICAgICAgdGFibGUuaW5zZXJ0KFByb2Nlc3NlZCwgQ29ubmVjdGlvbikNCiAgICBlbmQNCg0KICAgIHJldHVybiBQcm9jZXNzZWQNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOklzU2lnbWFTcHlFTlYoRW52OiB0YWJsZSk6IGJvb2xlYW4NCiAgICByZXR1cm4gRW52ID09IFNpZ21hRU5WDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpHZXRSZW1vdGVEYXRhKElkOiBzdHJpbmcpDQogICAgbG9jYWwgUmVtb3RlT3B0aW9ucyA9IHNlbGYuUmVtb3RlT3B0aW9ucw0KDQogICAgLS0vLyBDaGVjayBmb3IgZXhpc3RpbmcgcmVtb3RlIGRhdGENCglsb2NhbCBFeGlzdGluZyA9IFJlbW90ZU9wdGlvbnNbSWRdDQoJaWYgRXhpc3RpbmcgdGhlbiByZXR1cm4gRXhpc3RpbmcgZW5kDQoJDQogICAgLS0vLyBCYXNlIHJlbW90ZSBkYXRhDQoJbG9jYWwgRGF0YSA9IHsNCgkJRXhjbHVkZWQgPSBmYWxzZSwNCgkJQmxvY2tlZCA9IGZhbHNlDQoJfQ0KDQoJUmVtb3RlT3B0aW9uc1tJZF0gPSBEYXRhDQoJcmV0dXJuIERhdGENCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNhbGxEaXNjb3JkUlBDKEJvZHk6IHRhYmxlKQ0KICAgIHJlcXVlc3Qoew0KICAgICAgICBVcmwgPSAiaHR0cDovLzEyNy4wLjAuMTo2NDYzL3JwYz92PTEiLA0KICAgICAgICBNZXRob2QgPSAiUE9TVCIsDQogICAgICAgIEhlYWRlcnMgPSB7DQogICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iLA0KICAgICAgICAgICAgWyJPcmlnaW4iXSA9ICJodHRwczovL2Rpc2NvcmQuY29tLyINCiAgICAgICAgfSwNCiAgICAgICAgQm9keSA9IEh0dHBTZXJ2aWNlOkpTT05FbmNvZGUoQm9keSkNCiAgICB9KQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6UHJvbXB0RGlzY29yZEludml0ZShJbnZpdGVDb2RlOiBzdHJpbmcpDQogICAgc2VsZjpDYWxsRGlzY29yZFJQQyh7DQogICAgICAgIGNtZCA9ICJJTlZJVEVfQlJPV1NFUiIsDQogICAgICAgIG5vbmNlID0gSHR0cFNlcnZpY2U6R2VuZXJhdGVHVUlEKGZhbHNlKSwNCiAgICAgICAgYXJncyA9IHsNCiAgICAgICAgICAgIGNvZGUgPSBJbnZpdGVDb2RlDQogICAgICAgIH0NCiAgICB9KQ0KZW5kDQoNCmxvY2FsIFByb2Nlc3NDYWxsYmFjayA9IG5ld2NjbG9zdXJlKGZ1bmN0aW9uKERhdGE6IFJlbW90ZURhdGEsIFJlbW90ZSwgLi4uKTogdGFibGU/DQogICAgLS0vLyBVbnBhY2sgRGF0YQ0KICAgIGxvY2FsIE9yaWdpbmFsRnVuYyA9IERhdGEuT3JpZ2luYWxGdW5jDQogICAgbG9jYWwgSWQgPSBEYXRhLklkDQogICAgbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QNCg0KICAgIC0tLy8gQ2hlY2sgaWYgdGhlIFJlbW90ZSBpcyBCbG9ja2VkDQogICAgbG9jYWwgUmVtb3RlRGF0YSA9IFByb2Nlc3M6R2V0UmVtb3RlRGF0YShJZCkNCiAgICBpZiBSZW1vdGVEYXRhLkJsb2NrZWQgdGhlbiByZXR1cm4ge30gZW5kDQoNCiAgICAtLS8vIENoZWNrIGZvciBhIHNwb29mDQogICAgbG9jYWwgU3Bvb2YgPSBQcm9jZXNzOkdldFJlbW90ZVNwb29mKFJlbW90ZSwgTWV0aG9kLCBPcmlnaW5hbEZ1bmMsIC4uLikNCiAgICBpZiBTcG9vZiB0aGVuIHJldHVybiBTcG9vZiBlbmQNCg0KICAgIC0tLy8gQ2hlY2sgaWYgdGhlIG9yaWduYWwgZnVuY3Rpb24gd2FzIHBhc3NlZA0KICAgIGlmIG5vdCBPcmlnaW5hbEZ1bmMgdGhlbiByZXR1cm4gZW5kDQoNCiAgICAtLS8vIEludm9rZSBvcmlnbmFsIGZ1bmN0aW9uDQogICAgcmV0dXJuIHsNCiAgICAgICAgT3JpZ2luYWxGdW5jKFJlbW90ZSwgLi4uKQ0KICAgIH0NCmVuZCkNCg0KZnVuY3Rpb24gUHJvY2VzczpQcm9jZXNzUmVtb3RlKERhdGE6IFJlbW90ZURhdGEsIFJlbW90ZSwgLi4uKTogdGFibGU/DQogICAgLS0vLyBVbnBhY2sgRGF0YQ0KCWxvY2FsIE1ldGhvZCA9IERhdGEuTWV0aG9kDQogICAgbG9jYWwgVHJhbnNmZXJUeXBlID0gRGF0YS5UcmFuc2ZlclR5cGUNCiAgICBsb2NhbCBJc1JlY2VpdmUgPSBEYXRhLklzUmVjZWl2ZQ0KDQoJLS0vLyBDaGVjayBpZiB0aGUgdHJhbnNmZXJ0eXBlIG1ldGhvZCBpcyBhbGxvd2VkDQoJaWYgVHJhbnNmZXJUeXBlIGFuZCBub3Qgc2VsZjpSZW1vdGVBbGxvd2VkKFJlbW90ZSwgVHJhbnNmZXJUeXBlLCBNZXRob2QpIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgLS0vLyBGZXRjaCBkZXRhaWxzDQogICAgbG9jYWwgSWQgPSBDb21tdW5pY2F0aW9uOkdldERlYnVnSWQoUmVtb3RlKQ0KICAgIGxvY2FsIENsYXNzRGF0YSA9IHNlbGY6R2V0Q2xhc3NEYXRhKFJlbW90ZSkNCiAgICBsb2NhbCBUaW1lc3RhbXAgPSB0aWNrKCkNCg0KICAgIGxvY2FsIENhbGxpbmdGdW5jdGlvbg0KICAgIGxvY2FsIFNvdXJjZVNjcmlwdA0KDQogICAgLS0vLyBBZGQgZXh0cmEgZGF0YSBpbnRvIHRoZSBsb2cgaWYgbmVlZGVkDQogICAgbG9jYWwgRXh0cmFEYXRhID0gc2VsZi5FeHRyYURhdGENCiAgICBpZiBFeHRyYURhdGEgdGhlbg0KICAgICAgICBzZWxmOk1lcmdlKERhdGEsIEV4dHJhRGF0YSkNCiAgICBlbmQNCg0KICAgIC0tLy8gR2V0IGNhbGxlciBpbmZvcm1hdGlvbg0KICAgIGlmIG5vdCBJc1JlY2VpdmUgdGhlbg0KICAgICAgICBDYWxsaW5nRnVuY3Rpb24gPSBzZWxmOkZpbmRDYWxsaW5nTENsb3N1cmUoNikNCiAgICAgICAgU291cmNlU2NyaXB0ID0gQ2FsbGluZ0Z1bmN0aW9uIGFuZCBzZWxmOkdldFNjcmlwdEZyb21GdW5jKENhbGxpbmdGdW5jdGlvbikgb3IgbmlsDQogICAgZW5kDQoNCiAgICAtLS8vIEFkZCB0byBxdWV1ZQ0KICAgIHNlbGY6TWVyZ2UoRGF0YSwgew0KICAgICAgICBSZW1vdGUgPSBjbG9uZXJlZihSZW1vdGUpLA0KCQlDYWxsaW5nU2NyaXB0ID0gZ2V0Y2FsbGluZ3NjcmlwdCgpLA0KICAgICAgICBDYWxsaW5nRnVuY3Rpb24gPSBDYWxsaW5nRnVuY3Rpb24sDQogICAgICAgIFNvdXJjZVNjcmlwdCA9IFNvdXJjZVNjcmlwdCwNCiAgICAgICAgSWQgPSBJZCwNCgkJQ2xhc3NEYXRhID0gQ2xhc3NEYXRhLA0KICAgICAgICBUaW1lc3RhbXAgPSBUaW1lc3RhbXAsDQogICAgICAgIEFyZ3MgPSB7Li4ufQ0KICAgIH0pDQoNCiAgICAtLS8vIEludm9rZSB0aGUgUmVtb3RlIGFuZCBsb2cgcmV0dXJuIHZhbHVlcw0KICAgIGxvY2FsIFJldHVyblZhbHVlcyA9IFByb2Nlc3NDYWxsYmFjayhEYXRhLCBSZW1vdGUsIC4uLikNCiAgICBEYXRhLlJldHVyblZhbHVlcyA9IFJldHVyblZhbHVlcw0KDQogICAgLS0vLyBRdWV1ZSBsb2cNCiAgICBDb21tdW5pY2F0aW9uOlF1ZXVlTG9nKERhdGEpDQoNCiAgICByZXR1cm4gUmV0dXJuVmFsdWVzDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpTZXRBbGxSZW1vdGVEYXRhKEtleTogc3RyaW5nLCBWYWx1ZSkNCiAgICBsb2NhbCBSZW1vdGVPcHRpb25zID0gc2VsZi5SZW1vdGVPcHRpb25zDQoJZm9yIFJlbW90ZUlELCBEYXRhIGluIG5leHQsIFJlbW90ZU9wdGlvbnMgZG8NCgkJRGF0YVtLZXldID0gVmFsdWUNCgllbmQNCmVuZA0KDQotLS8vIFRoZSBjb21tdW5pY2F0aW9uIGNyZWF0ZXMgYSBkaWZmZXJlbnQgdGFibGUgYWRkcmVzcw0KLS0vLyBSZWNpdmVkIHRhYmxlcyB3aWxsIG5vdCBiZSB0aGUgc2FtZQ0KZnVuY3Rpb24gUHJvY2VzczpTZXRSZW1vdGVEYXRhKElkOiBzdHJpbmcsIFJlbW90ZURhdGE6IHRhYmxlKQ0KICAgIGxvY2FsIFJlbW90ZU9wdGlvbnMgPSBzZWxmLlJlbW90ZU9wdGlvbnMNCiAgICBSZW1vdGVPcHRpb25zW0lkXSA9IFJlbW90ZURhdGENCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOlVwZGF0ZVJlbW90ZURhdGEoSWQ6IHN0cmluZywgUmVtb3RlRGF0YTogdGFibGUpDQogICAgQ29tbXVuaWNhdGlvbjpDb21tdW5pY2F0ZSgiUmVtb3RlRGF0YSIsIElkLCBSZW1vdGVEYXRhKQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6VXBkYXRlQWxsUmVtb3RlRGF0YShLZXk6IHN0cmluZywgVmFsdWUpDQogICAgQ29tbXVuaWNhdGlvbjpDb21tdW5pY2F0ZSgiQWxsUmVtb3RlRGF0YSIsIEtleSwgVmFsdWUpDQplbmQNCg0KcmV0dXJuIFByb2Nlc3M=]]
},Hook={'base64',
[[LS1bWwoJRW5oYW5jZWQgSG9vayBNb2R1bGUKCUZpeGVkOiBDIHN0YWNrIG92ZXJmbG93LCBJbmZpbml0ZSBSZWN1cnNpb24sIGFuZCBkZXRlY3Rpb24gcGF0Y2hlcy4KXV0KCmxvY2FsIEhvb2sgPSB7CglPcmlnaW5hbE5hbWVjYWxsID0gbmlsLAoJT3JpZ2luYWxJbmRleCA9IG5pbCwKCVByZXZpb3VzRnVuY3Rpb25zID0ge30sCglEZWZhdWx0Q29uZmlnID0gewoJCUZ1bmN0aW9uUGF0Y2hlcyA9IHRydWUKCX0KfQoKbG9jYWwgSG9va0xvY2sgPSB7fQoKdHlwZSB0YWJsZSA9IHsgW2FueV06IGFueSB9CnR5cGUgTWV0YUZ1bmMgPSAoSW5zdGFuY2UsIC4uLmFueSkgLT4gLi4uYW55CnR5cGUgVW5rRnVuYyA9ICguLi5hbnkpIC0+IC4uLmFueQoKLS0vLyBNb2R1bGVzCmxvY2FsIE1vZHVsZXMKbG9jYWwgUHJvY2Vzcwpsb2NhbCBDb25maWd1cmF0aW9uCmxvY2FsIENvbmZpZwpsb2NhbCBDb21tdW5pY2F0aW9uCgpsb2NhbCBFeGVFTlYgPSBnZXRmZW52KDEpCgpmdW5jdGlvbiBIb29rOkluaXQoRGF0YSkKICAgIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKCVByb2Nlc3MgPSBNb2R1bGVzLlByb2Nlc3MKCUNvbW11bmljYXRpb24gPSBNb2R1bGVzLkNvbW11bmljYXRpb24gb3IgQ29tbXVuaWNhdGlvbgoJQ29uZmlnID0gTW9kdWxlcy5Db25maWcgb3IgQ29uZmlnCglDb25maWd1cmF0aW9uID0gTW9kdWxlcy5Db25maWd1cmF0aW9uIG9yIENvbmZpZ3VyYXRpb24KZW5kCgpsb2NhbCBIb29rTWlkZGxlID0gbmV3Y2Nsb3N1cmUoZnVuY3Rpb24oT3JpZ2luYWxGdW5jLCBDYWxsYmFjaywgQWx3YXlzVGFibGU6IGJvb2xlYW4/LCAuLi4pCglpZiBIb29rTG9ja1tPcmlnaW5hbEZ1bmNdIHRoZW4KCQlyZXR1cm4gT3JpZ2luYWxGdW5jKC4uLikKCWVuZAoKCUhvb2tMb2NrW09yaWdpbmFsRnVuY10gPSB0cnVlCgkKCWxvY2FsIFN1Y2Nlc3MsIFJldHVyblZhbHVlcyA9IHBjYWxsKENhbGxiYWNrLCAuLi4pCgkKCUhvb2tMb2NrW09yaWdpbmFsRnVuY10gPSBuaWwKCglpZiBub3QgU3VjY2VzcyB0aGVuCgkJcmV0dXJuIE9yaWdpbmFsRnVuYyguLi4pCgllbmQKCglpZiBSZXR1cm5WYWx1ZXMgdGhlbgoJCWlmIG5vdCBBbHdheXNUYWJsZSB0aGVuCgkJCXJldHVybiBQcm9jZXNzOlVucGFjayhSZXR1cm5WYWx1ZXMpCgkJZW5kCgkJcmV0dXJuIFJldHVyblZhbHVlcwoJZW5kCgoJaWYgQWx3YXlzVGFibGUgdGhlbgoJCXJldHVybiB7T3JpZ2luYWxGdW5jKC4uLil9CgllbmQKCglyZXR1cm4gT3JpZ2luYWxGdW5jKC4uLikKZW5kKQoKbG9jYWwgZnVuY3Rpb24gTWVyZ2UoQmFzZTogdGFibGUsIE5ldzogdGFibGUpCglmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBOZXcgZG8KCQlCYXNlW0tleV0gPSBWYWx1ZQoJZW5kCmVuZAoKZnVuY3Rpb24gSG9vazpJbmRleChPYmplY3Q6IEluc3RhbmNlLCBLZXk6IHN0cmluZykKCXJldHVybiBPYmplY3RbS2V5XQplbmQKCmZ1bmN0aW9uIEhvb2s6UHVzaENvbmZpZyhPdmVyd3JpdGVzKQogICAgTWVyZ2Uoc2VsZiwgT3ZlcndyaXRlcykKZW5kCgpmdW5jdGlvbiBIb29rOlJlcGxhY2VNZXRhTWV0aG9kKE9iamVjdDogSW5zdGFuY2UsIENhbGw6IHN0cmluZywgQ2FsbGJhY2s6IE1ldGFGdW5jKTogTWV0YUZ1bmMKCWxvY2FsIE1ldGF0YWJsZSA9IGdldHJhd21ldGF0YWJsZShPYmplY3QpCglsb2NhbCBPcmlnaW5hbEZ1bmMgPSBjbG9uZWZ1bmN0aW9uKE1ldGF0YWJsZVtDYWxsXSkKCQoJc2V0cmVhZG9ubHkoTWV0YXRhYmxlLCBmYWxzZSkKCU1ldGF0YWJsZVtDYWxsXSA9IG5ld2NjbG9zdXJlKGZ1bmN0aW9uKC4uLikKCQlyZXR1cm4gSG9va01pZGRsZShPcmlnaW5hbEZ1bmMsIENhbGxiYWNrLCBmYWxzZSwgLi4uKQoJZW5kKQoJc2V0cmVhZG9ubHkoTWV0YXRhYmxlLCB0cnVlKQoKCXJldHVybiBPcmlnaW5hbEZ1bmMKZW5kCgpmdW5jdGlvbiBIb29rOkhvb2tGdW5jdGlvbihGdW5jOiBVbmtGdW5jLCBDYWxsYmFjazogVW5rRnVuYykKCWxvY2FsIE9yaWdpbmFsRnVuYwoJbG9jYWwgV3JhcHBlZENhbGxiYWNrID0gbmV3Y2Nsb3N1cmUoQ2FsbGJhY2spCglPcmlnaW5hbEZ1bmMgPSBjbG9uZWZ1bmN0aW9uKGhvb2tmdW5jdGlvbihGdW5jLCBmdW5jdGlvbiguLi4pCgkJcmV0dXJuIEhvb2tNaWRkbGUoT3JpZ2luYWxGdW5jLCBXcmFwcGVkQ2FsbGJhY2ssIGZhbHNlLCAuLi4pCgllbmQpKQoJcmV0dXJuIE9yaWdpbmFsRnVuYwplbmQKCmZ1bmN0aW9uIEhvb2s6SG9va01ldGFDYWxsKE9iamVjdDogSW5zdGFuY2UsIENhbGw6IHN0cmluZywgQ2FsbGJhY2s6IE1ldGFGdW5jKTogTWV0YUZ1bmMKCWxvY2FsIE1ldGF0YWJsZSA9IGdldHJhd21ldGF0YWJsZShPYmplY3QpCglsb2NhbCBVbmhvb2tlZAoJCglVbmhvb2tlZCA9IHNlbGY6SG9va0Z1bmN0aW9uKE1ldGF0YWJsZVtDYWxsXSwgZnVuY3Rpb24oLi4uKQoJCXJldHVybiBIb29rTWlkZGxlKFVuaG9va2VkLCBDYWxsYmFjaywgdHJ1ZSwgLi4uKQoJZW5kKQoJcmV0dXJuIFVuaG9va2VkCmVuZAoKZnVuY3Rpb24gSG9vazpIb29rTWV0YU1ldGhvZChPYmplY3Q6IEluc3RhbmNlLCBDYWxsOiBzdHJpbmcsIENhbGxiYWNrOiBNZXRhRnVuYyk6IE1ldGFGdW5jCglsb2NhbCBGdW5jID0gbmV3Y2Nsb3N1cmUoQ2FsbGJhY2spCgkKCWlmIENvbmZpZyBhbmQgQ29uZmlnLlJlcGxhY2VNZXRhQ2FsbEZ1bmMgdGhlbgoJCXJldHVybiBzZWxmOlJlcGxhY2VNZXRhTWV0aG9kKE9iamVjdCwgQ2FsbCwgRnVuYykKCWVuZAoJCglyZXR1cm4gc2VsZjpIb29rTWV0YUNhbGwoT2JqZWN0LCBDYWxsLCBGdW5jKQplbmQKCmZ1bmN0aW9uIEhvb2s6UGF0Y2hGdW5jdGlvbnMoKQoJaWYgQ29uZmlnIGFuZCBDb25maWcuTm9GdW5jdGlvblBhdGNoaW5nIHRoZW4gcmV0dXJuIGVuZAoKCWxvY2FsIFBhdGNoZXMgPSB7CgkJW3BjYWxsXSA9IGZ1bmN0aW9uKE9sZEZ1bmMsIEZ1bmMsIC4uLikKCQkJbG9jYWwgUmVzcG9uY2UgPSB7T2xkRnVuYyhGdW5jLCAuLi4pfQoJCQlsb2NhbCBTdWNjZXNzLCBFcnJvciA9IFJlc3BvbmNlWzFdLCBSZXNwb25jZVsyXQoJCQkKCQkJaWYgU3VjY2VzcyA9PSBmYWxzZSBhbmQgdHlwZShFcnJvcikgPT0gInN0cmluZyIgdGhlbgoJCQkJaWYgRXJyb3I6ZmluZCgiQyBzdGFjayBvdmVyZmxvdyIpIHRoZW4KCQkJCQlSZXNwb25jZVsyXSA9ICJDcml0aWNhbCBzdGFjayBkZXB0aCByZWFjaGVkIChQYXRjaGVkKSIgCgkJCQkJcmV0dXJuIHVucGFjayhSZXNwb25jZSkKCQkJCWVuZAoKCQkJCWlmIGlzY2Nsb3N1cmUoRnVuYykgdGhlbgoJCQkJCVJlc3BvbmNlWzJdID0gUHJvY2VzczpDbGVhbkNFcnJvcihFcnJvcikKCQkJCWVuZAoJCQllbmQKCgkJCXJldHVybiB1bnBhY2soUmVzcG9uY2UpCgkJZW5kLAoKCQlbZ2V0ZmVudl0gPSBmdW5jdGlvbihPbGRGdW5jLCBMZXZlbDogbnVtYmVyLCAuLi4pCgkJCUxldmVsID0gKHR5cGUoTGV2ZWwpID09ICJudW1iZXIiKSBhbmQgKExldmVsICsgMikgb3IgMQoJCQlsb2NhbCBSZXNwb25jZSA9IHtPbGRGdW5jKExldmVsLCAuLi4pfQoJCQlsb2NhbCBFTlYgPSBSZXNwb25jZVsxXQoKCQkJaWYgbm90IGNoZWNrY2FsbGVyKCkgYW5kIEVOViA9PSBFeGVFTlYgdGhlbgoJCQkJcmV0dXJuIE9sZEZ1bmMoOTk5OTk5LCAuLi4pCgkJCWVuZAoJCQlyZXR1cm4gdW5wYWNrKFJlc3BvbmNlKQoJCWVuZAoJfQoKCWZvciBGdW5jLCBDYWxsQmFjayBpbiBQYXRjaGVzIGRvCgkJbG9jYWwgV3JhcHBlZCA9IG5ld2NjbG9zdXJlKENhbGxCYWNrKQoJCWxvY2FsIE9sZEZ1bmM7IE9sZEZ1bmMgPSBzZWxmOkhvb2tGdW5jdGlvbihGdW5jLCBmdW5jdGlvbiguLi4pCgkJCXJldHVybiBXcmFwcGVkKE9sZEZ1bmMsIC4uLikKCQllbmQpCgkJc2VsZi5QcmV2aW91c0Z1bmN0aW9uc1tGdW5jXSA9IE9sZEZ1bmMKCWVuZAplbmQKCmZ1bmN0aW9uIEhvb2s6R2V0T3JpZ2luYWxGdW5jKEZ1bmMpCglyZXR1cm4gc2VsZi5QcmV2aW91c0Z1bmN0aW9uc1tGdW5jXSBvciBGdW5jCmVuZAoKZnVuY3Rpb24gSG9vazpSdW5PbkFjdG9ycyhDb2RlOiBzdHJpbmcsIENoYW5uZWxJZDogbnVtYmVyKQoJaWYgbm90IGdldGFjdG9ycyBvciBub3QgcnVuX29uX2FjdG9yIHRoZW4gcmV0dXJuIGVuZAoJbG9jYWwgQWN0b3JzID0gZ2V0YWN0b3JzKCkKCWZvciBfLCBBY3RvciBpbiBBY3RvcnMgZG8gCgkJcGNhbGwocnVuX29uX2FjdG9yLCBBY3RvciwgQ29kZSwgQ2hhbm5lbElkKQoJZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gUHJvY2Vzc1JlbW90ZShPcmlnaW5hbEZ1bmMsIE1ldGFNZXRob2Q6IHN0cmluZywgc2VsZiwgTWV0aG9kOiBzdHJpbmcsIC4uLikKCXJldHVybiBQcm9jZXNzOlByb2Nlc3NSZW1vdGUoewoJCU1ldGhvZCA9IE1ldGhvZCwKCQlPcmlnaW5hbEZ1bmMgPSBPcmlnaW5hbEZ1bmMsCgkJTWV0YU1ldGhvZCA9IE1ldGFNZXRob2QsCgkJVHJhbnNmZXJUeXBlID0gIlNlbmQiLAoJCUlzRXhwbG9pdCA9IGNoZWNrY2FsbGVyKCkKCX0sIHNlbGYsIC4uLikKZW5kCgpmdW5jdGlvbiBIb29rOkhvb2tSZW1vdGVUeXBlSW5kZXgoQ2xhc3NOYW1lOiBzdHJpbmcsIEZ1bmNOYW1lOiBzdHJpbmcpCglsb2NhbCBSZW1vdGUgPSBJbnN0YW5jZS5uZXcoQ2xhc3NOYW1lKQoJbG9jYWwgRnVuYyA9IFJlbW90ZVtGdW5jTmFtZV0KCWxvY2FsIE9yaWdpbmFsRnVuYwoKCU9yaWdpbmFsRnVuYyA9IHNlbGY6SG9va0Z1bmN0aW9uKEZ1bmMsIGZ1bmN0aW9uKHNlbGYsIC4uLikKCQlpZiBub3QgUHJvY2VzczpSZW1vdGVBbGxvd2VkKHNlbGYsICJTZW5kIiwgRnVuY05hbWUpIHRoZW4gCgkJCXJldHVybiBPcmlnaW5hbEZ1bmMoc2VsZiwgLi4uKSAKCQllbmQKCgkJcmV0dXJuIFByb2Nlc3NSZW1vdGUoT3JpZ2luYWxGdW5jLCAiX19pbmRleCIsIHNlbGYsIEZ1bmNOYW1lLCAuLi4pCgllbmQpCmVuZAoKZnVuY3Rpb24gSG9vazpIb29rUmVtb3RlSW5kZXhlcygpCglsb2NhbCBSZW1vdGVDbGFzc0RhdGEgPSBQcm9jZXNzLlJlbW90ZUNsYXNzRGF0YQoJZm9yIENsYXNzTmFtZSwgRGF0YSBpbiBSZW1vdGVDbGFzc0RhdGEgZG8KCQlsb2NhbCBGdW5jTmFtZSA9IERhdGEuU2VuZFsxXQoJCXNlbGY6SG9va1JlbW90ZVR5cGVJbmRleChDbGFzc05hbWUsIEZ1bmNOYW1lKQoJZW5kCmVuZAoKZnVuY3Rpb24gSG9vazpCZWdpbkhvb2tzKCkKCXNlbGY6SG9va1JlbW90ZUluZGV4ZXMoKQoKCWxvY2FsIE9yaWdpbmFsTmFtZUNhbGwKCU9yaWdpbmFsTmFtZUNhbGwgPSBzZWxmOkhvb2tNZXRhTWV0aG9kKGdhbWUsICJfX25hbWVjYWxsIiwgZnVuY3Rpb24oc2VsZiwgLi4uKQoJCWxvY2FsIE1ldGhvZCA9IGdldG5hbWVjYWxsbWV0aG9kKCkKCQlyZXR1cm4gUHJvY2Vzc1JlbW90ZShPcmlnaW5hbE5hbWVDYWxsLCAiX19uYW1lY2FsbCIsIHNlbGYsIE1ldGhvZCwgLi4uKQoJZW5kKQoKCU1lcmdlKHNlbGYsIHsgT3JpZ2luYWxOYW1lY2FsbCA9IE9yaWdpbmFsTmFtZUNhbGwgfSkKZW5kCgpmdW5jdGlvbiBIb29rOkhvb2tDbGllbnRJbnZva2UoUmVtb3RlLCBNZXRob2QsIENhbGxiYWNrKQoJbG9jYWwgU3VjY2VzcywgRnVuY3Rpb24gPSBwY2FsbChmdW5jdGlvbigpIHJldHVybiBnZXRjYWxsYmFja3ZhbHVlKFJlbW90ZSwgTWV0aG9kKSBlbmQpCglpZiBub3QgU3VjY2VzcyBvciBub3QgRnVuY3Rpb24gdGhlbiByZXR1cm4gZW5kCgkKCWxvY2FsIEhvb2tTdWNjZXNzID0gcGNhbGwoZnVuY3Rpb24oKQoJCXNlbGY6SG9va0Z1bmN0aW9uKEZ1bmN0aW9uLCBDYWxsYmFjaykKCWVuZCkKCQoJaWYgbm90IEhvb2tTdWNjZXNzIHRoZW4KCQlSZW1vdGVbTWV0aG9kXSA9IGZ1bmN0aW9uKC4uLikKCQkJcmV0dXJuIEhvb2tNaWRkbGUoRnVuY3Rpb24sIENhbGxiYWNrLCBmYWxzZSwgLi4uKQoJCWVuZAoJZW5kCmVuZAoKZnVuY3Rpb24gSG9vazpDb25uZWN0Q2xpZW50UmVjaXZlKFJlbW90ZSkKCWxvY2FsIEFsbG93ZWQgPSBQcm9jZXNzOlJlbW90ZUFsbG93ZWQoUmVtb3RlLCAiUmVjZWl2ZSIpCglpZiBub3QgQWxsb3dlZCB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBDbGFzc0RhdGEgPSBQcm9jZXNzOkdldENsYXNzRGF0YShSZW1vdGUpCiAgICBsb2NhbCBJc1JlbW90ZUZ1bmN0aW9uID0gQ2xhc3NEYXRhLklzUmVtb3RlRnVuY3Rpb24KCWxvY2FsIE5vUmVjaXZlSG9vayA9IENsYXNzRGF0YS5Ob1JlY2l2ZUhvb2sKICAgIGxvY2FsIE1ldGhvZCA9IENsYXNzRGF0YS5SZWNlaXZlWzFdCgoJaWYgTm9SZWNpdmVIb29rIHRoZW4gcmV0dXJuIGVuZAoKCWxvY2FsIGZ1bmN0aW9uIENhbGxiYWNrKC4uLikKICAgICAgICByZXR1cm4gUHJvY2VzczpQcm9jZXNzUmVtb3RlKHsKICAgICAgICAgICAgTWV0aG9kID0gTWV0aG9kLAogICAgICAgICAgICBJc1JlY2VpdmUgPSB0cnVlLAogICAgICAgICAgICBNZXRhTWV0aG9kID0gIkNvbm5lY3QiLAoJCQlJc0V4cGxvaXQgPSBjaGVja2NhbGxlcigpCiAgICAgICAgfSwgUmVtb3RlLCAuLi4pCgllbmQKCglpZiBub3QgSXNSZW1vdGVGdW5jdGlvbiB0aGVuCgkJUmVtb3RlW01ldGhvZF06Q29ubmVjdChDYWxsYmFjaykKCWVsc2UgCgkJc2VsZjpIb29rQ2xpZW50SW52b2tlKFJlbW90ZSwgTWV0aG9kLCBDYWxsYmFjaykKCWVuZAplbmQKCmZ1bmN0aW9uIEhvb2s6TXVsdGlDb25uZWN0KFJlbW90ZXMpCglmb3IgXywgUmVtb3RlIGluIG5leHQsIFJlbW90ZXMgZG8KCQlzZWxmOkNvbm5lY3RDbGllbnRSZWNpdmUoUmVtb3RlKQoJZW5kCmVuZAoKZnVuY3Rpb24gSG9vazpCZWdpblNlcnZpY2UoTGlicmFyaWVzLCBFeHRyYURhdGEsIENoYW5uZWxJZCwgLi4uKQoJbG9jYWwgUmV0dXJuU3Bvb2ZzID0gTGlicmFyaWVzLlJldHVyblNwb29mcwoJbG9jYWwgUHJvY2Vzc0xpYiA9IExpYnJhcmllcy5Qcm9jZXNzCglsb2NhbCBDb21tTGliID0gTGlicmFyaWVzLkNvbW11bmljYXRpb24KCWxvY2FsIEdlbmVyYXRpb24gPSBMaWJyYXJpZXMuR2VuZXJhdGlvbgoJbG9jYWwgQ29uZmlnTGliID0gTGlicmFyaWVzLkNvbmZpZwoKCVByb2Nlc3NMaWI6Q2hlY2tDb25maWcoQ29uZmlnTGliKQoKCWxvY2FsIEluaXREYXRhID0gewoJCU1vZHVsZXMgPSB7CgkJCVJldHVyblNwb29mcyA9IFJldHVyblNwb29mcywKCQkJR2VuZXJhdGlvbiA9IEdlbmVyYXRpb24sCgkJCUNvbW11bmljYXRpb24gPSBDb21tTGliLAoJCQlQcm9jZXNzID0gUHJvY2Vzc0xpYiwKCQkJQ29uZmlnID0gQ29uZmlnTGliLAoJCQlIb29rID0gc2VsZgoJCX0KCX0KCglDb21tTGliOkluaXQoSW5pdERhdGEpCglQcm9jZXNzTGliOkluaXQoSW5pdERhdGEpCgoJbG9jYWwgQ2hhbm5lbCwgSXNXcmFwcGVkID0gQ29tbUxpYjpHZXRDb21tQ2hhbm5lbChDaGFubmVsSWQpCglDb21tTGliOlNldENoYW5uZWwoQ2hhbm5lbCkKCQoJQ29tbUxpYjpBZGRUeXBlQ2FsbGJhY2tzKHsKCQlbIkJlZ2luSG9va3MiXSA9IGZ1bmN0aW9uKENvbmZpZykKCQkJaWYgQ29uZmlnLlBhdGNoRnVuY3Rpb25zIHRoZW4gc2VsZjpQYXRjaEZ1bmN0aW9ucygpIGVuZAoJCQlzZWxmOkJlZ2luSG9va3MoKQoJCQlDb21tTGliOkNvbnNvbGVQcmludCgiSG9va3MgbG9hZGVkIHN1Y2Nlc3NmdWxseSAoQW50aS1DcmFzaCBBY3RpdmUpIikKCQllbmQKCX0pCgkKCVByb2Nlc3NMaWI6U2V0Q2hhbm5lbChDaGFubmVsLCBJc1dyYXBwZWQpCglzZWxmOkluaXQoSW5pdERhdGEpCmVuZAoKZnVuY3Rpb24gSG9vazpMb2FkSG9va3MoQWN0b3JDb2RlOiBzdHJpbmcsIENoYW5uZWxJZDogbnVtYmVyKQoJaWYgbm90IENvbmZpZ3VyYXRpb24uTm9BY3RvcnMgdGhlbiBzZWxmOlJ1bk9uQWN0b3JzKEFjdG9yQ29kZSwgQ2hhbm5lbElkKSBlbmQKCXNlbGY6QmVnaW5TZXJ2aWNlKE1vZHVsZXMsIG5pbCwgQ2hhbm5lbElkKSAKCQoJdGFzay5zcGF3bihmdW5jdGlvbigpCgkJc2VsZjpNdWx0aUNvbm5lY3QoZ2V0bmlsaW5zdGFuY2VzKCkpCgkJZm9yIF8sIFNlcnZpY2UgaW4gbmV4dCwgZ2FtZTpHZXRDaGlsZHJlbigpIGRvCgkJCXBjYWxsKGZ1bmN0aW9uKCkgc2VsZjpNdWx0aUNvbm5lY3QoU2VydmljZTpHZXREZXNjZW5kYW50cygpKSBlbmQpCgkJZW5kCgkJZ2FtZS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChmdW5jdGlvbihSZW1vdGUpIHNlbGY6Q29ubmVjdENsaWVudFJlY2l2ZShSZW1vdGUpIGVuZCkKCWVuZCkKZW5kCgpyZXR1cm4gSG9vaw==]],
},Flags={'base64',
[[dHlwZSBGbGFnVmFsdWUgPSBib29sZWFufG51bWJlcnxhbnkNCnR5cGUgRmxhZyA9IHsNCiAgICBWYWx1ZTogRmxhZ1ZhbHVlLA0KICAgIExhYmVsOiBzdHJpbmcsDQogICAgQ2F0ZWdvcnk6IHN0cmluZw0KfQ0KdHlwZSBGbGFncyA9IHsNCiAgICBbc3RyaW5nXTogRmxhZw0KfQ0KdHlwZSB0YWJsZSA9IHsNCiAgICBbYW55XTogYW55DQp9DQoNCmxvY2FsIE1vZHVsZSA9IHsNCiAgICBGbGFncyA9IHsNCiAgICAgICAgLS0gUHJldmVudFJlbmFtaW5nID0gew0KICAgICAgICAtLSAgICAgVmFsdWUgPSBmYWxzZSwNCiAgICAgICAgLS0gICAgIExhYmVsID0gIk5vIHJlbmFtaW5nIiwNCiAgICAgICAgLS0gfSwNCiAgICAgICAgLS0gUHJldmVudFBhcmVudGluZyA9IHsNCiAgICAgICAgLS0gICAgIFZhbHVlID0gZmFsc2UsDQogICAgICAgIC0tICAgICBMYWJlbCA9ICJObyBwYXJlbnRpbmciLA0KICAgICAgICAtLSB9LA0KICAgICAgICBOb0NvbW1lbnRzID0gew0KICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwNCiAgICAgICAgICAgIExhYmVsID0gIk5vIGNvbW1lbnRzIiwNCiAgICAgICAgfSwNCiAgICAgICAgU2VsZWN0TmV3ZXN0ID0gew0KICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwNCiAgICAgICAgICAgIExhYmVsID0gIkF1dG8gc2VsZWN0IG5ld2VzdCIsDQogICAgICAgIH0sDQogICAgICAgIERlY29tcGlsZVBvcG91dCA9IHsgLS0gTG92cmUgU0hVU0gNCiAgICAgICAgICAgIFZhbHVlID0gZmFsc2UsDQogICAgICAgICAgICBMYWJlbCA9ICJQb3Atb3V0IGRlY29tcGlsZXMiLA0KICAgICAgICB9LA0KICAgICAgICBJZ25vcmVOaWwgPSB7DQogICAgICAgICAgICBWYWx1ZSA9IHRydWUsDQogICAgICAgICAgICBMYWJlbCA9ICJJZ25vcmUgbmlsIHBhcmVudHMiLA0KICAgICAgICB9LA0KICAgICAgICBMb2dFeHBsb2l0ID0gew0KICAgICAgICAgICAgVmFsdWUgPSB0cnVlLA0KICAgICAgICAgICAgTGFiZWwgPSAiTG9nIGV4cGxvaXQgY2FsbHMiLA0KICAgICAgICB9LA0KICAgICAgICBMb2dSZWNpdmVzID0gew0KICAgICAgICAgICAgVmFsdWUgPSB0cnVlLA0KICAgICAgICAgICAgTGFiZWwgPSAiTG9nIHJlY2VpdmVzIiwNCiAgICAgICAgfSwNCiAgICAgICAgUGF1c2VkID0gew0KICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwNCiAgICAgICAgICAgIExhYmVsID0gIlBhdXNlZCIsDQogICAgICAgICAgICBLZXliaW5kID0gRW51bS5LZXlDb2RlLlENCiAgICAgICAgfSwNCiAgICAgICAgS2V5YmluZHNFbmFibGVkID0gew0KICAgICAgICAgICAgVmFsdWUgPSB0cnVlLA0KICAgICAgICAgICAgTGFiZWwgPSAiS2V5YmluZHMgRW5hYmxlZCINCiAgICAgICAgfSwNCiAgICAgICAgRmluZFN0cmluZ0Zvck5hbWUgPSB7DQogICAgICAgICAgICBWYWx1ZSA9IHRydWUsDQogICAgICAgICAgICBMYWJlbCA9ICJGaW5kIGFyZyBmb3IgbmFtZSINCiAgICAgICAgfSwNCiAgICAgICAgVWlWaXNpYmxlID0gew0KICAgICAgICAgICAgVmFsdWUgPSB0cnVlLA0KICAgICAgICAgICAgTGFiZWwgPSAiVUkgVmlzaWJsZSIsDQogICAgICAgICAgICBLZXliaW5kID0gRW51bS5LZXlDb2RlLlANCiAgICAgICAgfSwNCiAgICAgICAgTm9UcmVlTm9kZXMgPSB7DQogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLA0KICAgICAgICAgICAgTGFiZWwgPSAiTm8gZ3JvdXBpbmciDQogICAgICAgIH0sDQogICAgICAgIFRhYmxlQXJncyA9IHsNCiAgICAgICAgICAgIFZhbHVlID0gZmFsc2UsDQogICAgICAgICAgICBMYWJlbCA9ICJUYWJsZSBhcmdzIg0KICAgICAgICB9LA0KICAgICAgICBOb1ZhcmlhYmxlcyA9IHsNCiAgICAgICAgICAgIFZhbHVlID0gZmFsc2UsDQogICAgICAgICAgICBMYWJlbCA9ICJObyBjb21wcmVzc2lvbiINCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gTW9kdWxlOkdldEZsYWdWYWx1ZShOYW1lOiBzdHJpbmcpOiBGbGFnVmFsdWUNCiAgICBsb2NhbCBGbGFnID0gc2VsZjpHZXRGbGFnKE5hbWUpDQogICAgcmV0dXJuIEZsYWcuVmFsdWUNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6U2V0RmxhZ1ZhbHVlKE5hbWU6IHN0cmluZywgVmFsdWU6IEZsYWdWYWx1ZSkNCiAgICBsb2NhbCBGbGFnID0gc2VsZjpHZXRGbGFnKE5hbWUpDQogICAgRmxhZy5WYWx1ZSA9IFZhbHVlDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOlNldEZsYWdDYWxsYmFjayhOYW1lOiBzdHJpbmcsIENhbGxiYWNrOiAoLi4uYW55KSAtPiAuLi5hbnkpDQogICAgbG9jYWwgRmxhZyA9IHNlbGY6R2V0RmxhZyhOYW1lKQ0KICAgIEZsYWcuQ2FsbGJhY2sgPSBDYWxsYmFjaw0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpTZXRGbGFnQ2FsbGJhY2tzKERpY3Q6IHt9KQ0KICAgIGZvciBOYW1lLCBDYWxsYmFjazogKC4uLmFueSkgLT4gLi4uYW55IGluIG5leHQsIERpY3QgZG8gDQogICAgICAgIHNlbGY6U2V0RmxhZ0NhbGxiYWNrKE5hbWUsIENhbGxiYWNrKQ0KICAgIGVuZA0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpHZXRGbGFnKE5hbWU6IHN0cmluZyk6IEZsYWcNCiAgICBsb2NhbCBBbGxGbGFncyA9IHNlbGY6R2V0RmxhZ3MoKQ0KICAgIGxvY2FsIEZsYWcgPSBBbGxGbGFnc1tOYW1lXQ0KICAgIGFzc2VydChGbGFnLCAiRmxhZyBkb2VzIG5vdCBleGlzdCEiKQ0KICAgIHJldHVybiBGbGFnDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkFkZEZsYWcoTmFtZTogc3RyaW5nLCBGbGFnOiBGbGFnKQ0KICAgIGxvY2FsIEFsbEZsYWdzID0gc2VsZjpHZXRGbGFncygpDQogICAgQWxsRmxhZ3NbTmFtZV0gPSBGbGFnDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkdldEZsYWdzKCk6IEZsYWdzDQogICAgcmV0dXJuIHNlbGYuRmxhZ3MNCmVuZA0KDQpyZXR1cm4gTW9kdWxl]]
},Ui={'base64',
[[bG9jYWwgVWkgPSB7CglEZWZhdWx0RWRpdG9yQ29udGVudCA9IFs9Wy0tW1sKCVNpZ21hIFNweSwgd3JpdHRlbiBieSBkZXBzbwoJSG9va3MgcmV3cml0dGVuIGFuZCBtYW55IG1vcmUgZml4ZXMhCgoJRGlzY29yZDogaHR0cHM6Ly9kaXNjb3JkLmdnL2JrVWttMnZTYnYKXV1dPV0sCglMb2dMaW1pdCA9IDEwMCwKICAgIFNlYXNvbkxhYmVscyA9IHsgCiAgICAgICAgSmFudWFyeSA9ICLim4QgJXMg4puEIiwgCiAgICAgICAgRmVicnVhcnkgPSAi77iPICVzICIsIAogICAgICAgIE1hcmNoID0gIiAlcyAiLCAKICAgICAgICBBcHJpbCA9ICIgJXMg4pyd77iPIiwgCiAgICAgICAgTWF5ID0gIiAlcyAiLCAKICAgICAgICBKdW5lID0gIiAlcyAiLCAKICAgICAgICBKdWx5ID0gIiAlcyAiLCAKICAgICAgICBBdWd1c3QgPSAi4piA77iPICVzICIsIAogICAgICAgIFNlcHRlbWJlciA9ICIgJXMgIiwgCiAgICAgICAgT2N0b2JlciA9ICIgJXMgIiwgCiAgICAgICAgTm92ZW1iZXIgPSAiICVzICIsIAogICAgICAgIERlY2VtYmVyID0gIiAlcyAiCiAgICB9LAoJU2NhbGVzID0gewoJCVsiTW9iaWxlIl0gPSBVRGltMi5mcm9tT2Zmc2V0KDQ4MCwgMjgwKSwKCQlbIkRlc2t0b3AiXSA9IFVEaW0yLmZyb21PZmZzZXQoNjAwLCA0MDApLAoJfSwKICAgIEJhc2VDb25maWcgPSB7CiAgICAgICAgVGhlbWUgPSAiU2lnbWFTcHkiLAogICAgICAgIE5vU2Nyb2xsID0gdHJ1ZSwKICAgIH0sCglPcHRpb25UeXBlcyA9IHsKCQlib29sZWFuID0gIkNoZWNrYm94IiwKCX0sCglEaXNwbGF5UmVtb3RlSW5mbyA9IHsKCQkiTWV0YU1ldGhvZCIsCgkJIk1ldGhvZCIsCgkJIlJlbW90ZSIsCgkJIkNhbGxpbmdTY3JpcHQiLAoJCSJJc0FjdG9yIiwKCQkiSWQiCgl9LAoKICAgIFdpbmRvdyA9IG5pbCwKICAgIFJhbmRvbVNlZWQgPSBSYW5kb20ubmV3KHRpY2soKSksCglMb2dzID0gc2V0bWV0YXRhYmxlKHt9LCB7X19tb2RlID0gImsifSksCglMb2dRdWV1ZSA9IHNldG1ldGF0YWJsZSh7fSwge19fbW9kZSA9ICJ2In0pLAp9IAoKdHlwZSB0YWJsZSA9IHsKCVthbnldOiBhbnkKfQoKdHlwZSBMb2cgPSB7CglSZW1vdGU6IEluc3RhbmNlLAoJTWV0aG9kOiBzdHJpbmcsCglBcmdzOiB0YWJsZSwKCUlzUmVjZWl2ZTogYm9vbGVhbj8sCglNZXRhTWV0aG9kOiBzdHJpbmc/LAoJT3JpZ25hbEZ1bmM6ICgoLi4uYW55KSAtPiAuLi5hbnkpPywKCUNhbGxpbmdTY3JpcHQ6IEluc3RhbmNlPywKCUNhbGxpbmdGdW5jdGlvbjogKCguLi5hbnkpIC0+IC4uLmFueSk/LAoJQ2xhc3NEYXRhOiB0YWJsZT8sCglSZXR1cm5WYWx1ZXM6IHRhYmxlPywKCVJlbW90ZURhdGE6IHRhYmxlPywKCUlkOiBzdHJpbmcsCglTZWxlY3RhYmxlOiB0YWJsZSwKCUhlYWRlckRhdGE6IHRhYmxlLAoJVmFsdWVTd2FwczogdGFibGUsCglUaW1lc3RhbXA6IG51bWJlciwKCUlzRXhwbG9pdDogYm9vbGVhbgp9CgotLS8vIENvbXBhdGliaWxpdHkKbG9jYWwgU2V0Q2xpcGJvYXJkID0gc2V0Y2xpcGJvYXJkIG9yIHRvY2xpcGJvYXJkIG9yIHNldF9jbGlwYm9hcmQKCi0tLy8gTGlicmFyaWVzCmxvY2FsIFJlR3VpID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoJ2h0dHBzOi8vZ2l0aHViLmNvbS9JSUlJbGxsbDExMTFJSUlJbGxsbDExMTEvRGVhci1SZUd1aS9yYXcvcmVmcy9oZWFkcy9tYWluL1JlR3VpLmx1YScpLCAiUmVHdWkiKSgpCgotLS8vIE1vZHVsZXMKbG9jYWwgRmxhZ3MKbG9jYWwgR2VuZXJhdGlvbgpsb2NhbCBQcm9jZXNzCmxvY2FsIEhvb2sgCmxvY2FsIENvbmZpZwpsb2NhbCBDb21tdW5pY2F0aW9uCmxvY2FsIEZpbGVzCgpsb2NhbCBBY3RpdmVEYXRhID0gbmlsCmxvY2FsIFJlbW90ZXNDb3VudCA9IDAKCmxvY2FsIFRleHRGb250ID0gRm9udC5mcm9tRW51bShFbnVtLkZvbnQuQ29kZSkKbG9jYWwgRm9udFN1Y2Nlc3MgPSBmYWxzZQpsb2NhbCBDb21tQ2hhbm5lbAoKZnVuY3Rpb24gVWk6SW5pdChEYXRhKQogICAgbG9jYWwgTW9kdWxlcyA9IERhdGEuTW9kdWxlcwoKCS0tLy8gTW9kdWxlcwoJRmxhZ3MgPSBNb2R1bGVzLkZsYWdzCglHZW5lcmF0aW9uID0gTW9kdWxlcy5HZW5lcmF0aW9uCglQcm9jZXNzID0gTW9kdWxlcy5Qcm9jZXNzCglIb29rID0gTW9kdWxlcy5Ib29rCglDb25maWcgPSBNb2R1bGVzLkNvbmZpZwoJQ29tbXVuaWNhdGlvbiA9IE1vZHVsZXMuQ29tbXVuaWNhdGlvbgoJRmlsZXMgPSBNb2R1bGVzLkZpbGVzCgoJLS0vLyBSZUd1aQoJc2VsZjpMb2FkRm9udCgpCglzZWxmOkxvYWRSZUd1aSgpCglzZWxmOkNoZWNrU2NhbGUoKQplbmQKCmZ1bmN0aW9uIFVpOlNldENvbW1DaGFubmVsKE5ld0NvbW1DaGFubmVsOiBCaW5kYWJsZUV2ZW50KQoJQ29tbUNoYW5uZWwgPSBOZXdDb21tQ2hhbm5lbAplbmQKCmZ1bmN0aW9uIFVpOkNoZWNrU2NhbGUoKQoJbG9jYWwgQmFzZUNvbmZpZyA9IHNlbGYuQmFzZUNvbmZpZwoJbG9jYWwgU2NhbGVzID0gc2VsZi5TY2FsZXMKCglsb2NhbCBJc01vYmlsZSA9IFJlR3VpOklzTW9iaWxlRGV2aWNlKCkKCWxvY2FsIERldmljZSA9IElzTW9iaWxlIGFuZCAiTW9iaWxlIiBvciAiRGVza3RvcCIKCglCYXNlQ29uZmlnLlNpemUgPSBTY2FsZXNbRGV2aWNlXQplbmQKCmZ1bmN0aW9uIFVpOlNldENsaXBib2FyZChDb250ZW50OiBzdHJpbmcpCglTZXRDbGlwYm9hcmQoQ29udGVudCkKZW5kCgpmdW5jdGlvbiBVaTpUdXJuU2Vhc29uYWwoVGV4dDogc3RyaW5nKTogc3RyaW5nCiAgICBsb2NhbCBTZWFzb25MYWJlbHMgPSBzZWxmLlNlYXNvbkxhYmVscwogICAgbG9jYWwgTW9udGggPSBvcy5kYXRlKCIlQiIpCiAgICBsb2NhbCBCYXNlID0gU2Vhc29uTGFiZWxzW01vbnRoXQoKICAgIHJldHVybiBCYXNlOmZvcm1hdChUZXh0KQplbmQKCmZ1bmN0aW9uIFVpOkxvYWRGb250KCkKCWxvY2FsIEZvbnRGaWxlID0gc2VsZi5Gb250SnNvbkZpbGUKCgktLS8vIEdldCBGb250RmFjZSBBc3NldElkCglsb2NhbCBBc3NldElkID0gRmlsZXM6TG9hZEN1c3RvbWFzc2V0KEZvbnRGaWxlKQoJaWYgbm90IEFzc2V0SWQgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBDcmVhdGUgY3VzdG9tIEZvbnRGYWNlCglsb2NhbCBOZXdGb250ID0gRm9udC5uZXcoQXNzZXRJZCkKCVRleHRGb250ID0gTmV3Rm9udAoJRm9udFN1Y2Nlc3MgPSB0cnVlCmVuZAoKZnVuY3Rpb24gVWk6U2V0Rm9udEZpbGUoRm9udEZpbGU6IHN0cmluZykKCXNlbGYuRm9udEpzb25GaWxlID0gRm9udEZpbGUKZW5kCgpmdW5jdGlvbiBVaTpGb250V2FzU3VjY2Vzc2Z1bCgpCglpZiBGb250U3VjY2VzcyB0aGVuIHJldHVybiBlbmQKCgktLS8vIEVycm9yIG1lc3NhZ2UKCXNlbGY6U2hvd01vZGFsKHsKCQkiVW5mb3J0dW5hdGVseSB5b3VyIGV4ZWN1dG9yIHdhcyB1bmFibGUgdG8gZG93bmxvYWQgdGhlIGZvbnQgYW5kIHRoZXJlZm9yZSBzd2l0Y2hlZCB0byB0aGUgRGFyayB0aGVtZSIsCgkJIlxuSWYgeW91IHdvdWxkIGxpa2UgdG8gdXNlIHRoZSBJbUd1aSB0aGVtZSwgXG5wbGVhc2UgZG93bmxvYWQgdGhlIGZvbnQgKGFzc2V0cy9Qcm9nZ3lDbGVhbi50dGYpIiwKCQkiYW5kIHB1dCBwdXQgaXQgaW4geW91ciB3b3Jrc3BhY2UgZm9sZGVyXG4oU2lnbWEgU3B5L2Fzc2V0cykiCgl9KQplbmQKCmZ1bmN0aW9uIFVpOkxvYWRSZUd1aSgpCglsb2NhbCBUaGVtZUNvbmZpZyA9IENvbmZpZyBhbmQgQ29uZmlnLlRoZW1lQ29uZmlnIG9yIHtCYXNlVGhlbWUgPSAiSW1HdWkiLCBUZXh0U2l6ZSA9IDEyfQoJVGhlbWVDb25maWcuVGV4dEZvbnQgPSBUZXh0Rm9udAoKCS0tLy8gUmVHdWkKCVJlR3VpOkRlZmluZVRoZW1lKCJTaWdtYVNweSIsIFRoZW1lQ29uZmlnKQplbmQKCnR5cGUgQ3JlYXRlQnV0dG9ucyA9IHsKCUJhc2U6IHRhYmxlPywKCUJ1dHRvbnM6IHRhYmxlLAoJTm9UYWJsZTogYm9vbGVhbj8KfQpmdW5jdGlvbiBVaTpDcmVhdGVCdXR0b25zKFBhcmVudCwgRGF0YTogQ3JlYXRlQnV0dG9ucykKCWxvY2FsIEJhc2UgPSBEYXRhLkJhc2Ugb3Ige30KCWxvY2FsIEJ1dHRvbnMgPSBEYXRhLkJ1dHRvbnMKCWxvY2FsIE5vVGFibGUgPSBEYXRhLk5vVGFibGUKCgktLS8vIENyZWF0ZSB0YWJsZSBsYXlvdXQKCWlmIG5vdCBOb1RhYmxlIHRoZW4KCQlQYXJlbnQgPSBQYXJlbnQ6VGFibGUoewoJCQlNYXhDb2x1bW5zID0gMwoJCX0pOk5leHRSb3coKQoJZW5kCgoJLS0vLyBDcmVhdGUgYnV0dG9ucwoJZm9yIF8sIEJ1dHRvbiBpbiBuZXh0LCBCdXR0b25zIGRvCgkJbG9jYWwgQ29udGFpbmVyID0gUGFyZW50CgkJaWYgbm90IE5vVGFibGUgdGhlbgoJCQlDb250YWluZXIgPSBQYXJlbnQ6TmV4dENvbHVtbigpCgkJZW5kCgoJCVJlR3VpOkNoZWNrQ29uZmlnKEJ1dHRvbiwgQmFzZSkKCQlDb250YWluZXI6QnV0dG9uKEJ1dHRvbikKCWVuZAplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZVdpbmRvdyhXaW5kb3dDb25maWcpCiAgICBsb2NhbCBCYXNlQ29uZmlnID0gc2VsZi5CYXNlQ29uZmlnCglsb2NhbCBDb25maWcgPSBQcm9jZXNzOkRlZXBDbG9uZVRhYmxlKEJhc2VDb25maWcpCglQcm9jZXNzOk1lcmdlKENvbmZpZywgV2luZG93Q29uZmlnKQoKCS0tLy8gQ3JlYXRlIFdpbmRvdwoJbG9jYWwgV2luZG93ID0gUmVHdWk6V2luZG93KENvbmZpZykKCgktLS8vIFN3aXRjaCB0byBEYXJrVGhlbWUgaW5zdGVhZCBvZiB0aGUgSW1HdWkgdGhlbWUgaWYgdGhlIGZvbnQgY2Fubm90IGJlIGxvYWRlZAoJaWYgbm90IEZvbnRTdWNjZXNzIHRoZW4gCgkJV2luZG93OlNldFRoZW1lKCJEYXJrVGhlbWUiKQoJZW5kCgkKCS0tLy8gQ3JlYXRlIFdpbmRvdwoJcmV0dXJuIFdpbmRvdwplbmQKCnR5cGUgQXNrQ29uZmlnID0gewoJVGl0bGU6IHN0cmluZywKCUNvbnRlbnQ6IHRhYmxlLAoJT3B0aW9uczogdGFibGUKfQpmdW5jdGlvbiBVaTpBc2tVc2VyKENvbmZpZzogQXNrQ29uZmlnKTogc3RyaW5nCglsb2NhbCBXaW5kb3cgPSBzZWxmLldpbmRvdwoJbG9jYWwgQW5zd2VyZWQgPSBmYWxzZQoKCS0tLy8gQ3JlYXRlIG1vZGFsCglsb2NhbCBNb2RhbFdpbmRvdyA9IFdpbmRvdzpQb3B1cE1vZGFsKHsKCQlUaXRsZSA9IENvbmZpZy5UaXRsZQoJfSkKCU1vZGFsV2luZG93OkxhYmVsKHsKCQlUZXh0ID0gdGFibGUuY29uY2F0KENvbmZpZy5Db250ZW50LCAiXG4iKSwKCQlUZXh0V3JhcHBlZCA9IHRydWUKCX0pCglNb2RhbFdpbmRvdzpTZXBhcmF0b3IoKQoKCS0tLy8gQW5zd2VycwoJbG9jYWwgUm93ID0gTW9kYWxXaW5kb3c6Um93KHsKCQlFeHBhbmRlZCA9IHRydWUKCX0pCglmb3IgXywgQW5zd2VyIGluIG5leHQsIENvbmZpZy5PcHRpb25zIGRvCgkJUm93OkJ1dHRvbih7CgkJCVRleHQgPSBBbnN3ZXIsCgkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJQW5zd2VyZWQgPSBBbnN3ZXIKCQkJCU1vZGFsV2luZG93OkNsb3NlUG9wdXAoKQoJCQllbmQsCgkJfSkKCWVuZAoKCXJlcGVhdCB3YWl0KCkgdW50aWwgQW5zd2VyZWQKCXJldHVybiBBbnN3ZXJlZAplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZU1haW5XaW5kb3coKQoJbG9jYWwgV2luZG93ID0gc2VsZjpDcmVhdGVXaW5kb3coKQoJc2VsZi5XaW5kb3cgPSBXaW5kb3cKCgktLS8vIENoZWNrIGlmIHRoZSBmb250IHdhcyBzdWNjZXNzZnVsbHkgZG93bmxvYWRlZAoJc2VsZjpGb250V2FzU3VjY2Vzc2Z1bCgpCglzZWxmOkF1cmFDb3VudGVyU2VydmljZSgpCgoJLS0vLyBVaVZpc2libGUgZmxhZyBjYWxsYmFjawoJRmxhZ3M6U2V0RmxhZ0NhbGxiYWNrKCJVaVZpc2libGUiLCBmdW5jdGlvbihzZWxmLCBWaXNpYmxlKQoJCVdpbmRvdzpTZXRWaXNpYmxlKFZpc2libGUpCgllbmQpCgoJcmV0dXJuIFdpbmRvdwplbmQKCmZ1bmN0aW9uIFVpOlNob3dNb2RhbChMaW5lczogdGFibGUpCglsb2NhbCBXaW5kb3cgPSBzZWxmLldpbmRvdwoJbG9jYWwgTWVzc2FnZSA9IHRhYmxlLmNvbmNhdChMaW5lcywgIlxuIikKCgktLS8vIE1vZGFsIFdpbmRvdwoJbG9jYWwgTW9kYWxXaW5kb3cgPSBXaW5kb3c6UG9wdXBNb2RhbCh7CgkJVGl0bGUgPSAiU2lnbWEgU3B5IgoJfSkKCU1vZGFsV2luZG93OkxhYmVsKHsKCQlUZXh0ID0gTWVzc2FnZSwKCQlSaWNoVGV4dCA9IHRydWUsCgkJVGV4dFdyYXBwZWQgPSB0cnVlCgl9KQoJTW9kYWxXaW5kb3c6QnV0dG9uKHsKCQlUZXh0ID0gIk9rYXkiLAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQlNb2RhbFdpbmRvdzpDbG9zZVBvcHVwKCkKCQllbmQsCgl9KQplbmQKCmZ1bmN0aW9uIFVpOlNob3dVbnN1cHBvcnRlZEV4ZWN1dG9yKE5hbWU6IHN0cmluZykKCVVpOlNob3dNb2RhbCh7CgkJIlVuZm9ydHVuYXRlbHkgU2lnbWEgU3B5IGlzIG5vdCBzdXBwb3J0ZWQgb24geW91ciBleGVjdXRvciIsCgkJIlRoZSBiZXN0IGZyZWUgb3B0aW9uIGlzIFN3aWZ0IChkaXNjb3JkLmdnL2dldHN3aWZ0Z2cpIiwKCQlgXG5Zb3VyIGV4ZWN1dG9yOiB7TmFtZX1gCgl9KQplbmQKCmZ1bmN0aW9uIFVpOlNob3dVbnN1cHBvcnRlZChGdW5jTmFtZTogc3RyaW5nKQoJVWk6U2hvd01vZGFsKHsKCQkiVW5mb3J0dW5hdGVseSBTaWdtYSBTcHkgaXMgbm90IHN1cHBvcnRlZCBvbiB5b3VyIGV4ZWN1dG9yIiwKCQlgXG5NaXNzaW5nIGZ1bmN0aW9uOiB7RnVuY05hbWV9YAoJfSkKZW5kCgpmdW5jdGlvbiBVaTpDcmVhdGVPcHRpb25zRm9yRGljdChQYXJlbnQsIERpY3Q6IHRhYmxlLCBDYWxsYmFjaykKCWxvY2FsIE9wdGlvbnMgPSB7fQoKCS0tLy8gRGljdG9uYXJ5IHdyYXAKCWZvciBLZXksIFZhbHVlIGluIG5leHQsIERpY3QgZG8KCQlPcHRpb25zW0tleV0gPSB7CgkJCVZhbHVlID0gVmFsdWUsCgkJCUxhYmVsID0gS2V5LAoJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKF8sIFZhbHVlKQoJCQkJRGljdFtLZXldID0gVmFsdWUKCgkJCQktLS8vIEludm9rZSBjYWxsYmFjawoJCQkJaWYgbm90IENhbGxiYWNrIHRoZW4gcmV0dXJuIGVuZAoJCQkJQ2FsbGJhY2soKQoJCQllbmQKCQl9CgllbmQKCgktLS8vIENyZWF0ZSBlbGVtZW50cwoJc2VsZjpDcmVhdGVFbGVtZW50cyhQYXJlbnQsIE9wdGlvbnMpCmVuZAoKZnVuY3Rpb24gVWk6Q2hlY2tLZXliaW5kTGF5b3V0KENvbnRhaW5lciwgS2V5Q29kZTogRW51bS5LZXlDb2RlLCBDYWxsYmFjaykKCWlmIG5vdCBLZXlDb2RlIHRoZW4gcmV0dXJuIENvbnRhaW5lciBlbmQKCgktLS8vIENyZWF0ZSBSb3cgbGF5b3V0CglDb250YWluZXIgPSBDb250YWluZXI6Um93KHsKCQlIb3Jpem9udGFsRmxleCA9IEVudW0uVUlGbGV4QWxpZ25tZW50LlNwYWNlQmV0d2VlbgoJfSkKCgktLS8vIEFkZCBLZXliaW5kIGVsZW1lbnQKCUNvbnRhaW5lcjpLZXliaW5kKHsKCQlMYWJlbCA9ICIiLAoJCVZhbHVlID0gS2V5Q29kZSwKCQlMYXlvdXRPcmRlciA9IDIsCgkJSWdub3JlR2FtZVByb2Nlc3NlZCA9IGZhbHNlLAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQktLS8vIENoZWNrIGlmIGtleWJpbmRzIGFyZSBlbmFibGVkCgkJCWxvY2FsIEVuYWJsZWQgPSBGbGFnczpHZXRGbGFnVmFsdWUoIktleWJpbmRzRW5hYmxlZCIpCgkJCWlmIG5vdCBFbmFibGVkIHRoZW4gcmV0dXJuIGVuZAoKCQkJLS0vLyBJbnZva2UgY2FsbGJhY2sKCQkJQ2FsbGJhY2soKQoJCWVuZCwKCX0pCgoJcmV0dXJuIENvbnRhaW5lcgplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZUVsZW1lbnRzKFBhcmVudCwgT3B0aW9ucykKCWxvY2FsIE9wdGlvblR5cGVzID0gc2VsZi5PcHRpb25UeXBlcwoJCgktLS8vIENyZWF0ZSB0YWJsZSBsYXlvdXQKCWxvY2FsIFRhYmxlID0gUGFyZW50OlRhYmxlKHsKCQlNYXhDb2x1bW5zID0gMwoJfSk6TmV4dFJvdygpCgoJZm9yIE5hbWUsIERhdGEgaW4gT3B0aW9ucyBkbwoJCWxvY2FsIFZhbHVlID0gRGF0YS5WYWx1ZQoJCWxvY2FsIFR5cGUgPSB0eXBlb2YoVmFsdWUpCgoJCS0tLy8gQWRkIG1pc3NpbmcgdmFsdWVzIGludG8gb3B0aW9ucyB0YWJsZQoJCVJlR3VpOkNoZWNrQ29uZmlnKERhdGEsIHsKCQkJQ2xhc3MgPSBPcHRpb25UeXBlc1tUeXBlXSwKCQkJTGFiZWwgPSBOYW1lLAoJCX0pCgkJCgkJLS0vLyBDaGVjayBpZiBhIGVsZW1lbnQgdHlwZSBleGlzdHMgZm9yIHZhbHVlIHR5cGUKCQlsb2NhbCBDbGFzcyA9IERhdGEuQ2xhc3MKCQlhc3NlcnQoQ2xhc3MsIGBObyB7VHlwZX0gdHlwZSBleGlzdHMgZm9yIG9wdGlvbmApCgoJCWxvY2FsIENvbnRhaW5lciA9IFRhYmxlOk5leHRDb2x1bW4oKQoJCWxvY2FsIENoZWNrYm94ID0gbmlsCgoJCS0tLy8gQ2hlY2sgZm9yIGEga2V5YmluZCBsYXlvdXQKCQlsb2NhbCBLZXliaW5kID0gRGF0YS5LZXliaW5kCgkJQ29udGFpbmVyID0gc2VsZjpDaGVja0tleWJpbmRMYXlvdXQoQ29udGFpbmVyLCBLZXliaW5kLCBmdW5jdGlvbigpCgkJCUNoZWNrYm94OlRvZ2dsZSgpCgkJZW5kKQoJCQoJCS0tLy8gQ3JlYXRlIGNvbHVtbiBhbmQgZWxlbWVudAoJCUNoZWNrYm94ID0gQ29udGFpbmVyW0NsYXNzXShDb250YWluZXIsIERhdGEpCgllbmQKZW5kCgotLS8vIEJvaWlpaSB3aGF0IGRpZCB5b3Ugc2F5IGFib3V0IFNpZ21hIFNweSAKZnVuY3Rpb24gVWk6RGlzcGxheUF1cmEoKQogICAgbG9jYWwgV2luZG93ID0gc2VsZi5XaW5kb3cKICAgIGxvY2FsIFJhbmQgPSBzZWxmLlJhbmRvbVNlZWQKCgktLS8vIEF1cmEgKGJvaWlpaWkpCiAgICBsb2NhbCBBVVJBID0gUmFuZDpOZXh0SW50ZWdlcigxLCA5OTk5OTk5KQogICAgbG9jYWwgQVVSQURFTEFZID0gUmFuZDpOZXh0SW50ZWdlcigxLCA1KQoKCS0tLy8gVGl0bGUKCWxvY2FsIFRpdGxlID0gYFNpZ21hIFNweSB8IEFVUkE6IHtBVVJBfWAKCWxvY2FsIFNlYXNvbmFsID0gc2VsZjpUdXJuU2Vhc29uYWwoVGl0bGUpCiAgICBXaW5kb3c6U2V0VGl0bGUoU2Vhc29uYWwpCgogICAgd2FpdChBVVJBREVMQVkpCmVuZAoKZnVuY3Rpb24gVWk6QXVyYUNvdW50ZXJTZXJ2aWNlKCkKICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIHdoaWxlIHRydWUgZG8KICAgICAgICAgICAgc2VsZjpEaXNwbGF5QXVyYSgpCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKZnVuY3Rpb24gVWk6Q3JlYXRlV2luZG93Q29udGVudChXaW5kb3cpCiAgICAtLS8vIFdpbmRvdyBncm91cAogICAgbG9jYWwgTGF5b3V0ID0gV2luZG93Okxpc3QoewogICAgICAgIFVpUGFkZGluZyA9IDIsCiAgICAgICAgSG9yaXpvbnRhbEZsZXggPSBFbnVtLlVJRmxleEFsaWdubWVudC5GaWxsLAogICAgICAgIFZlcnRpY2FsRmxleCA9IEVudW0uVUlGbGV4QWxpZ25tZW50LkZpbGwsCiAgICAgICAgRmlsbERpcmVjdGlvbiA9IEVudW0uRmlsbERpcmVjdGlvbi5WZXJ0aWNhbCwKICAgICAgICBGaWxsID0gdHJ1ZQogICAgfSkKCgktLS8vIFJlbW90ZXMgbGlzdAogICAgc2VsZi5SZW1vdGVzTGlzdCA9IExheW91dDpDYW52YXMoewogICAgICAgIFNjcm9sbCA9IHRydWUsCiAgICAgICAgVWlQYWRkaW5nID0gNSwKICAgICAgICBBdXRvbWF0aWNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLk5vbmUsCiAgICAgICAgRmxleE1vZGUgPSBFbnVtLlVJRmxleE1vZGUuTm9uZSwKICAgICAgICBTaXplID0gVURpbTIubmV3KDAsIDEzMCwgMSwgMCkKICAgIH0pCgoJLS0vLyBUYWIgYm94Cglsb2NhbCBJbmZvU2VsZWN0b3IgPSBMYXlvdXQ6VGFiU2VsZWN0b3IoewogICAgICAgIE5vQW5pbWF0aW9uID0gdHJ1ZSwKICAgICAgICBTaXplID0gVURpbTIubmV3KDEsIC0xMzAsIDAuNCwgMCksCiAgICB9KQoKCXNlbGYuSW5mb1NlbGVjdG9yID0gSW5mb1NlbGVjdG9yCglzZWxmLkNhbnZhc0xheW91dCA9IExheW91dAoKCS0tLy8gTWFrZSB0YWJzCglzZWxmOk1ha2VFZGl0b3JUYWIoSW5mb1NlbGVjdG9yKQoJc2VsZjpNYWtlT3B0aW9uc1RhYihJbmZvU2VsZWN0b3IpCgkKCWlmIENvbmZpZyBhbmQgQ29uZmlnLkRlYnVnIHRoZW4KCQlzZWxmOkNvbnNvbGVUYWIoSW5mb1NlbGVjdG9yKQoJZW5kCmVuZAoKZnVuY3Rpb24gVWk6Q29uc29sZVRhYihJbmZvU2VsZWN0b3IpCglsb2NhbCBUYWIgPSBJbmZvU2VsZWN0b3I6Q3JlYXRlVGFiKHsKCQlOYW1lID0gIkNvbnNvbGUiCgl9KQoKCWxvY2FsIENvbnNvbGUKCWxvY2FsIEJ1dHRvbnNSb3cgPSBUYWI6Um93KCkKCglCdXR0b25zUm93OkJ1dHRvbih7CgkJVGV4dCA9ICJDbGVhciIsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCUNvbnNvbGU6Q2xlYXIoKQoJCWVuZAoJfSkKCUJ1dHRvbnNSb3c6QnV0dG9uKHsKCQlUZXh0ID0gIkNvcHkiLAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQl0b2NsaXBib2FyZChDb25zb2xlOkdldFZhbHVlKCkpCgkJZW5kCgl9KQoJQnV0dG9uc1JvdzpCdXR0b24oewoJCVRleHQgPSAiUGF1c2UiLAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oc2VsZikKCQkJbG9jYWwgRW5hYmxlZCA9IG5vdCBDb25zb2xlLkVuYWJsZWQKCQkJbG9jYWwgVGV4dCA9IEVuYWJsZWQgYW5kICJQYXVzZSIgb3IgIlBhdXNlZCIKCQkJc2VsZi5UZXh0ID0gVGV4dAoKCQkJLS0vLyBVcGRhdGUgY29uc29sZQoJCQlDb25zb2xlLkVuYWJsZWQgPSBFbmFibGVkCgkJZW5kLAoJfSkKCUJ1dHRvbnNSb3c6RXhwYW5kKCkKCgktLS8vIENyZWF0ZSBjb25zb2xlCglDb25zb2xlID0gVGFiOkNvbnNvbGUoewoJCVRleHQgPSAiLS0gQ3JlYXRlZCBieSBkZXBzbyIsCgkJUmVhZE9ubHkgPSB0cnVlLAoJCUJvcmRlciA9IGZhbHNlLAoJCUZpbGwgPSB0cnVlLAoJCUVuYWJsZWQgPSB0cnVlLAoJCUF1dG9TY3JvbGwgPSB0cnVlLAoJCVJpY2hUZXh0ID0gdHJ1ZSwKCQlNYXhMaW5lcyA9IDUwCgl9KQoKCXNlbGYuQ29uc29sZSA9IENvbnNvbGUKZW5kCgpmdW5jdGlvbiBVaTpDb25zb2xlTG9nKC4uLjogc3RyaW5nPykKCWxvY2FsIENvbnNvbGUgPSBzZWxmLkNvbnNvbGUKCWlmIG5vdCBDb25zb2xlIHRoZW4gcmV0dXJuIGVuZAoKCUNvbnNvbGU6QXBwZW5kVGV4dCguLi4pCmVuZAoKZnVuY3Rpb24gVWk6TWFrZU9wdGlvbnNUYWIoSW5mb1NlbGVjdG9yKQoJbG9jYWwgVGFiID0gSW5mb1NlbGVjdG9yOkNyZWF0ZVRhYih7CgkJTmFtZSA9ICJPcHRpb25zIgoJfSkKCgktLS8vIEFkZCBnbG9iYWwgb3B0aW9ucwoJVGFiOlNlcGFyYXRvcih7VGV4dD0iTG9ncyJ9KQoJc2VsZjpDcmVhdGVCdXR0b25zKFRhYiwgewoJCUJhc2UgPSB7CgkJCVNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjApLAoJCQlBdXRvbWF0aWNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLlksCgkJfSwKCQlCdXR0b25zID0gewoJCQl7CgkJCQlUZXh0ID0gIkNsZWFyIGxvZ3MiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgVGFiID0gQWN0aXZlRGF0YSBhbmQgQWN0aXZlRGF0YS5UYWIgb3IgbmlsCgoJCQkJCS0tLy8gUmVtb3ZlIHRoZSBSZW1vdGUgdGFiCgkJCQkJaWYgVGFiIHRoZW4KCQkJCQkJSW5mb1NlbGVjdG9yOlJlbW92ZVRhYihUYWIpCgkJCQkJZW5kCgoJCQkJCS0tLy8gQ2xlYXIgYWxsIGxvZyBlbGVtZW50cwoJCQkJCUFjdGl2ZURhdGEgPSBuaWwKCQkJCQlzZWxmOkNsZWFyTG9ncygpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQ2xlYXIgYmxvY2tzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCVByb2Nlc3M6VXBkYXRlQWxsUmVtb3RlRGF0YSgiQmxvY2tlZCIsIGZhbHNlKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkNsZWFyIGV4Y2x1ZGVzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCVByb2Nlc3M6VXBkYXRlQWxsUmVtb3RlRGF0YSgiRXhjbHVkZWQiLCBmYWxzZSkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJKb2luIERpc2NvcmQiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJUHJvY2VzczpQcm9tcHREaXNjb3JkSW52aXRlKCJzOW5nbVVEV2diIikKCQkJCQlzZWxmOlNldENsaXBib2FyZCgiaHR0cHM6Ly9kaXNjb3JkLmdnL3M5bmdtVURXZ2IiKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkNvcHkgR2l0aHViIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCXNlbGY6U2V0Q2xpcGJvYXJkKCJodHRwczovL2dpdGh1Yi5jb20vZGVwdGhzby9TaWdtYS1TcHkiKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkVkaXQgU3Bvb2ZzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCXNlbGY6RWRpdEZpbGUoIlJldHVybiBzcG9vZnMubHVhIiwgdHJ1ZSwgZnVuY3Rpb24oV2luZG93LCBDb250ZW50OiBzdHJpbmcpCgkJCQkJCVdpbmRvdzpDbG9zZSgpCgkJCQkJCUNvbW1DaGFubmVsOkZpcmUoIlVwZGF0ZVNwb29mcyIsIENvbnRlbnQpCgkJCQkJZW5kKQoJCQkJZW5kLAoJCQl9CgkJfQoJfSkKCgktLS8vIEZsYWcgb3B0aW9ucwoJVGFiOlNlcGFyYXRvcih7VGV4dD0iU2V0dGluZ3MifSkKCXNlbGY6Q3JlYXRlRWxlbWVudHMoVGFiLCBGbGFnczpHZXRGbGFncygpKQoKCXNlbGY6QWRkRGV0YWlsc1NlY3Rpb24oVGFiKQplbmQKCmZ1bmN0aW9uIFVpOkFkZERldGFpbHNTZWN0aW9uKE9wdGlvbnNUYWIpCglPcHRpb25zVGFiOlNlcGFyYXRvcih7VGV4dD0iSW5mb3JtYXRpb24ifSkKCU9wdGlvbnNUYWI6QnVsbGV0VGV4dCh7CgkJUm93cyA9IHsKCQkJIlNpZ21hIHNweSAtIFdyaXR0ZW4gYnkgZGVwc28hIiwKCQkJIkxpYnJhcmllczogUm9ibG94LVBhcnNlciwgRGVhci1SZUd1aSIsCgkJCSJUaGFuayB5b3Ugc3luLmx1YSBmb3Igc3VnZ2VzdGluZyBJIG1ha2UgdGhpcyIKCQl9Cgl9KQplbmQKCmxvY2FsIGZ1bmN0aW9uIE1ha2VBY3RpdmVEYXRhQ2FsbGJhY2soTmFtZTogc3RyaW5nKQoJcmV0dXJuIGZ1bmN0aW9uKC4uLikKCQlpZiBub3QgQWN0aXZlRGF0YSB0aGVuIHJldHVybiBlbmQKCQlyZXR1cm4gQWN0aXZlRGF0YVtOYW1lXShBY3RpdmVEYXRhLCAuLi4pCgllbmQKZW5kCgpmdW5jdGlvbiBVaTpNYWtlRWRpdG9yVGFiKEluZm9TZWxlY3RvcikKCWxvY2FsIERlZmF1bHQgPSBzZWxmLkRlZmF1bHRFZGl0b3JDb250ZW50Cglsb2NhbCBTeW50YXhDb2xvcnMgPSBDb25maWcgYW5kIENvbmZpZy5TeW50YXhDb2xvcnMgb3Ige30KCgktLS8vIENyZWF0ZSB0YWIKCWxvY2FsIEVkaXRvclRhYiA9IEluZm9TZWxlY3RvcjpDcmVhdGVUYWIoewoJCU5hbWUgPSAiRWRpdG9yIgoJfSkKCgktLS8vIElERQoJbG9jYWwgQ29kZUVkaXRvciA9IEVkaXRvclRhYjpDb2RlRWRpdG9yKHsKCQlGaWxsID0gdHJ1ZSwKCQlFZGl0YWJsZSA9IHRydWUsCgkJRm9udFNpemUgPSAxMywKCQlDb2xvcnMgPSBTeW50YXhDb2xvcnMsCgkJRm9udEZhY2UgPSBUZXh0Rm9udCwKCQlUZXh0ID0gRGVmYXVsdAoJfSkKCgktLS8vIEJ1dHRvbnMKCWxvY2FsIEJ1dHRvbnNSb3cgPSBFZGl0b3JUYWI6Um93KCkKCXNlbGY6Q3JlYXRlQnV0dG9ucyhCdXR0b25zUm93LCB7CgkJTm9UYWJsZSA9IHRydWUsCgkJQnV0dG9ucyA9IHsKCQkJewoJCQkJVGV4dCA9ICJDb3B5IiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIFNjcmlwdCA9IENvZGVFZGl0b3I6R2V0VGV4dCgpCgkJCQkJc2VsZjpTZXRDbGlwYm9hcmQoU2NyaXB0KQoJCQkJZW5kCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiUnVuIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIFNjcmlwdCA9IENvZGVFZGl0b3I6R2V0VGV4dCgpCgkJCQkJbG9jYWwgRnVuYywgRXJyb3IgPSBsb2Fkc3RyaW5nKFNjcmlwdCwgIlNpZ21hU3B5LVVTRVJTQ1JJUFQiKQoKCQkJCQktLS8vIFN5bnRheCBjaGVjawoJCQkJCWlmIG5vdCBGdW5jIHRoZW4KCQkJCQkJc2VsZjpTaG93TW9kYWwoeyJFcnJvciBydW5uaW5nIHNjcmlwdCFcbiIsIEVycm9yfSkKCQkJCQkJcmV0dXJuCgkJCQkJZW5kCgoJCQkJCUZ1bmMoKQoJCQkJZW5kCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiR2V0IHJldHVybiIsCgkJCQlDYWxsYmFjayA9IE1ha2VBY3RpdmVEYXRhQ2FsbGJhY2soIkdldFJldHVybiIpCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiU2NyaXB0IiwKCQkJCUNhbGxiYWNrID0gTWFrZUFjdGl2ZURhdGFDYWxsYmFjaygiU2NyaXB0T3B0aW9ucyIpCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQnVpbGQiLAoJCQkJQ2FsbGJhY2sgPSBNYWtlQWN0aXZlRGF0YUNhbGxiYWNrKCJCdWlsZFNjcmlwdCIpCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiUG9wLW91dCIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBTY3JpcHQgPSBDb2RlRWRpdG9yOkdldFRleHQoKQoJCQkJCWxvY2FsIFRpbGUgPSBBY3RpdmVEYXRhIGFuZCBBY3RpdmVEYXRhLlRhc2sgb3IgIlNpZ21hIFNweSIKCQkJCQlzZWxmOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3coU2NyaXB0LCB7CgkJCQkJCVRpdGxlID0gVGlsZQoJCQkJCX0pCgkJCQllbmQKCQkJfSwKCQl9Cgl9KQoJCglzZWxmLkNvZGVFZGl0b3IgPSBDb2RlRWRpdG9yCmVuZAoKZnVuY3Rpb24gVWk6U2hvdWxkRm9jdXMoVGFiKTogYm9vbGVhbgoJbG9jYWwgSW5mb1NlbGVjdG9yID0gc2VsZi5JbmZvU2VsZWN0b3IKCWxvY2FsIEFjdGl2ZVRhYiA9IEluZm9TZWxlY3Rvci5BY3RpdmVUYWIKCgktLS8vIElmIHRoZXJlIGlzIGFuIGVtcHR5IHRhYgoJaWYgbm90IEFjdGl2ZVRhYiB0aGVuCgkJcmV0dXJuIHRydWUKCWVuZAoKCXJldHVybiBJbmZvU2VsZWN0b3I6Q29tcGFyZVRhYnMoQWN0aXZlVGFiLCBUYWIpCmVuZAoKZnVuY3Rpb24gVWk6TWFrZUVkaXRvclBvcG91dFdpbmRvdyhDb250ZW50OiBzdHJpbmcsIFdpbmRvd0NvbmZpZzogdGFibGUpCglsb2NhbCBXaW5kb3cgPSBzZWxmOkNyZWF0ZVdpbmRvdyhXaW5kb3dDb25maWcpCglsb2NhbCBCdXR0b25zID0gV2luZG93Q29uZmlnLkJ1dHRvbnMgb3Ige30KCWxvY2FsIENvbG9ycyA9IENvbmZpZyBhbmQgQ29uZmlnLlN5bnRheENvbG9ycyBvciB7fQoKCWxvY2FsIENvZGVFZGl0b3IgPSBXaW5kb3c6Q29kZUVkaXRvcih7CgkJVGV4dCA9IENvbnRlbnQsCgkJRWRpdGFibGUgPSB0cnVlLAoJCUZpbGwgPSB0cnVlLAoJCUZvbnRTaXplID0gMTMsCgkJQ29sb3JzID0gQ29sb3JzLAoJCUZvbnRGYWNlID0gVGV4dEZvbnQKCX0pCgoJLS0vLyBEZWZhdWx0IGJ1dHRvbnMKCXRhYmxlLmluc2VydChCdXR0b25zLCB7CgkJVGV4dCA9ICJDb3B5IiwKCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJbG9jYWwgU2NyaXB0ID0gQ29kZUVkaXRvcjpHZXRUZXh0KCkKCQkJc2VsZjpTZXRDbGlwYm9hcmQoU2NyaXB0KQoJCWVuZAoJfSkKCgktLS8vIEJ1dHRvbnMKCWxvY2FsIEJ1dHRvbnNSb3cgPSBXaW5kb3c6Um93KCkKCXNlbGY6Q3JlYXRlQnV0dG9ucyhCdXR0b25zUm93LCB7CgkJTm9UYWJsZSA9IHRydWUsCgkJQnV0dG9ucyA9IEJ1dHRvbnMKCX0pCgoJV2luZG93OkNlbnRlcigpCglyZXR1cm4gQ29kZUVkaXRvciwgV2luZG93CmVuZAoKZnVuY3Rpb24gVWk6RWRpdEZpbGUoRmlsZVBhdGg6IHN0cmluZywgSW5Gb2xkZXI6IGJvb2xlYW4sIE9uU2F2ZUZ1bmM6ICgodGFibGUsIHN0cmluZykgLT4gbmlsKT8pCglsb2NhbCBGb2xkZXIgPSBGaWxlcy5Gb2xkZXJOYW1lCglsb2NhbCBDb2RlRWRpdG9yLCBXaW5kb3cKCgktLS8vIFJlbGF0aXZlIHRvIFNpZ21hIFNweSBmb2xkZXIKCWlmIEluRm9sZGVyIHRoZW4KCQlGaWxlUGF0aCA9IGB7Rm9sZGVyfS97RmlsZVBhdGh9YAoJZW5kCgoJLS0vLyBHZXQgZmlsZSBjb250ZW50Cglsb2NhbCBDb250ZW50ID0gcmVhZGZpbGUoRmlsZVBhdGgpCglDb250ZW50ID0gQ29udGVudDpnc3ViKCJcclxuIiwgIlxuIikKCQoJbG9jYWwgQnV0dG9ucyA9IHsKCQl7CgkJCVRleHQgPSAiU2F2ZSIsCgkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJbG9jYWwgU2NyaXB0ID0gQ29kZUVkaXRvcjpHZXRUZXh0KCkKCQkJCWxvY2FsIFN1Y2Nlc3MsIEVycm9yID0gbG9hZHN0cmluZyhTY3JpcHQsICJTaWdtYVNweS1FZGl0b3IiKQoKCQkJCS0tLy8gU3ludGF4IGNoZWNrCgkJCQlpZiBub3QgU3VjY2VzcyB0aGVuCgkJCQkJc2VsZjpTaG93TW9kYWwoeyJFcnJvciBzYXZpbmcgZmlsZSFcbiIsIEVycm9yfSkKCQkJCQlyZXR1cm4KCQkJCWVuZAoJCQkJCgkJCQktLS8vIFNhdmUgY29udGVudHMKCQkJCXdyaXRlZmlsZShGaWxlUGF0aCwgU2NyaXB0KQoKCQkJCS0tLy8gSW52b2tlIG9uIHNhdmUgZnVuY3Rpb24KCQkJCWlmIE9uU2F2ZUZ1bmMgdGhlbgoJCQkJCU9uU2F2ZUZ1bmMoV2luZG93LCBTY3JpcHQpCgkJCQllbmQKCQkJZW5kCgkJfQoJfQoKCS0tLy8gQ3JlYXRlIEVkaXRvciBXaW5kb3cKCUNvZGVFZGl0b3IsIFdpbmRvdyA9IHNlbGY6TWFrZUVkaXRvclBvcG91dFdpbmRvdyhDb250ZW50LCB7CgkJVGl0bGUgPSBgRWRpdGluZzoge0ZpbGVQYXRofWAsCgkJQnV0dG9ucyA9IEJ1dHRvbnMKCX0pCmVuZAoKdHlwZSBNZW51T3B0aW9ucyA9IHsKCVtzdHJpbmddOiAoR3VpQnV0dG9uLCAuLi5hbnkpIC0+IG5pbAp9CmZ1bmN0aW9uIFVpOk1ha2VCdXR0b25NZW51KEJ1dHRvbjogSW5zdGFuY2UsIFVucGFjazogdGFibGUsIE9wdGlvbnM6IE1lbnVPcHRpb25zKQoJbG9jYWwgV2luZG93ID0gc2VsZi5XaW5kb3cKCWxvY2FsIFBvcHVwID0gV2luZG93OlBvcHVwQ2FudmFzKHsKCQlSZWxhdGl2ZVRvID0gQnV0dG9uLAoJCU1heFNpemVYID0gNTAwLAoJfSkKCgktLS8vIENyZWF0ZSBTZWxlY3RhYmxlcyBmb3Igc3RyaW5nLCBmdW5jdGlvbgoJZm9yIE5hbWUsIEZ1bmMgaW4gT3B0aW9ucyBkbwoJCSBQb3B1cDpTZWxlY3RhYmxlKHsKCQkJVGV4dCA9IE5hbWUsCgkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJRnVuYyhQcm9jZXNzOlVucGFjayhVbnBhY2spKQoJCQllbmQsCgkJfSkKCWVuZAplbmQKCmZ1bmN0aW9uIFVpOlJlbW92ZVByZXZpb3VzVGFiKFRpdGxlOiBzdHJpbmcpOiBib29sZWFuCgktLS8vIE5vIHByZXZpb3VzIHRhYnMKCWlmIG5vdCBBY3RpdmVEYXRhIHRoZW4gCgkJcmV0dXJuIGZhbHNlIAoJZW5kCgoJLS0vLyBUYWJTZWxlY3RvcgoJbG9jYWwgSW5mb1NlbGVjdG9yID0gc2VsZi5JbmZvU2VsZWN0b3IKCgktLS8vIFByZXZpb3VzIGVsZW1lbnRzCglsb2NhbCBQcmV2aW91c1RhYiA9IEFjdGl2ZURhdGEuVGFiCglsb2NhbCBQcmV2aW91c1NlbGVjdGFibGUgPSBBY3RpdmVEYXRhLlNlbGVjdGFibGUKCgktLS8vIFJlbW92ZSBwcmV2aW91cyB0YWIgYW5kIHNldCBzZWxlY3RhYmxlIGZvY3VzCglsb2NhbCBUYWJGb2N1c2VkID0gc2VsZjpTaG91bGRGb2N1cyhQcmV2aW91c1RhYikKCUluZm9TZWxlY3RvcjpSZW1vdmVUYWIoUHJldmlvdXNUYWIpCglQcmV2aW91c1NlbGVjdGFibGU6U2V0U2VsZWN0ZWQoZmFsc2UpCgoJLS0vLyBDcmVhdGUgbmV3IHRhYgoJcmV0dXJuIFRhYkZvY3VzZWQKZW5kCgpmdW5jdGlvbiBVaTpNYWtlVGFibGVIZWFkZXJzKFRhYmxlLCBSb3dzOiB0YWJsZSkKCWxvY2FsIEhlYWRlclJvdyA9IFRhYmxlOkhlYWRlclJvdygpCglmb3IgXywgQ2F0YWdvcnkgaW4gUm93cyBkbwoJCWxvY2FsIENvbHVtbiA9IEhlYWRlclJvdzpOZXh0Q29sdW1uKCkKCQlDb2x1bW46TGFiZWwoe1RleHQ9Q2F0YWdvcnl9KQoJZW5kCmVuZAoKZnVuY3Rpb24gVWk6RGVjb21waWxlKEVkaXRvcjogdGFibGUsIFNjcmlwdDogU2NyaXB0KQoJbG9jYWwgSGVhZGVyID0gIi0tQk9PSUlJSSBUSElTIElTIFNPIFRVRkYgRkxJUFBZIFNLSUJJREkgQVVSQSAoU0lHTUEgU1BZKSIKCUVkaXRvcjpTZXRUZXh0KCItLURlY29tcGlsaW5nLi4uICs5OTk5OTk5IEFVUkEgKG1hbmdvIHBob25rKSIpCgoJLS0vLyBEZWNvbXBpbGUgc2NyaXB0Cglsb2NhbCBEZWNvbXBpbGVkLCBJc0Vycm9yID0gUHJvY2VzczpEZWNvbXBpbGUoU2NyaXB0KQoKCS0tLy8gQWRkIGhlYWRlciBmb3Igc3VjY2Vzc2Z1bCBkZWNvbXBpbGF0aW9ucwoJaWYgbm90IElzRXJyb3IgdGhlbgoJCURlY29tcGlsZWQgPSBge0hlYWRlcn1cbntEZWNvbXBpbGVkfWAKCWVuZAoKCUVkaXRvcjpTZXRUZXh0KERlY29tcGlsZWQpCmVuZAoKdHlwZSBEaXNwbGF5VGFibGVDb25maWcgPSB7CglSb3dzOiB0YWJsZSwKCUZsYWdzOiB0YWJsZT8sCglUb0Rpc3BsYXk6IHRhYmxlLAoJVGFibGU6IHRhYmxlCn0KZnVuY3Rpb24gVWk6RGlzcGxheVRhYmxlKFBhcmVudCwgQ29uZmlnOiBEaXNwbGF5VGFibGVDb25maWcpOiB0YWJsZQoJLS0vLyBDb25maWd1cmF0aW9uCglsb2NhbCBSb3dzID0gQ29uZmlnLlJvd3MKCWxvY2FsIEZsYWdzID0gQ29uZmlnLkZsYWdzCglsb2NhbCBEYXRhVGFibGUgPSBDb25maWcuVGFibGUKCWxvY2FsIFRvRGlzcGxheSA9IENvbmZpZy5Ub0Rpc3BsYXkKCglGbGFncy5NYXhDb2x1bW5zID0gI1Jvd3MKCgktLS8vIENyZWF0ZSB0YWJsZQoJbG9jYWwgVGFibGUgPSBQYXJlbnQ6VGFibGUoRmxhZ3MpCgoJLS0vLyBUYWJsZSBoZWFkZXJzCglzZWxmOk1ha2VUYWJsZUhlYWRlcnMoVGFibGUsIFJvd3MpCgoJLS0vLyBUYWJsZSBsYXlvdXQKCWZvciBSb3dJbmRleCwgTmFtZSBpbiBUb0Rpc3BsYXkgZG8KCQlsb2NhbCBSb3cgPSBUYWJsZTpSb3coKQoJCQoJCS0tLy8gQ3JlYXRlIENvbHVtbnMKCQlmb3IgQ291bnQsIENhdGFnb3J5IGluIFJvd3MgZG8KCQkJbG9jYWwgQ29sdW1uID0gUm93Ok5leHRDb2x1bW4oKQoJCQkKCQkJLS0vLyBWYWx1ZSB0ZXh0CgkJCWxvY2FsIFZhbHVlID0gQ2F0YWdvcnkgPT0gIk5hbWUiIGFuZCBOYW1lIG9yIERhdGFUYWJsZVtOYW1lXQoJCQlpZiBub3QgVmFsdWUgdGhlbiBjb250aW51ZSBlbmQKCgkJCS0tLy8gQ3JlYXRlIGZpbHRlcmVkIGxhYmVsCgkJCWxvY2FsIFN0cmluZyA9IHNlbGY6RmlsdGVyTmFtZShge1ZhbHVlfWAsIDE1MCkKCQkJQ29sdW1uOkxhYmVsKHtUZXh0PVN0cmluZ30pCgkJZW5kCgllbmQKCglyZXR1cm4gVGFibGUKZW5kCgpmdW5jdGlvbiBVaTpTZXRGb2N1c2VkUmVtb3RlKERhdGEpCgktLS8vIFVucGFjayByZW1vdGUgZGF0YQoJbG9jYWwgUmVtb3RlID0gRGF0YS5SZW1vdGUKCWxvY2FsIE1ldGhvZCA9IERhdGEuTWV0aG9kCglsb2NhbCBJc1JlY2VpdmUgPSBEYXRhLklzUmVjZWl2ZQoJbG9jYWwgU2NyaXB0ID0gRGF0YS5DYWxsaW5nU2NyaXB0Cglsb2NhbCBDbGFzc0RhdGEgPSBEYXRhLkNsYXNzRGF0YQoJbG9jYWwgSGVhZGVyRGF0YSA9IERhdGEuSGVhZGVyRGF0YQoJbG9jYWwgVmFsdWVTd2FwcyA9IERhdGEuVmFsdWVTd2FwcwoJbG9jYWwgQXJncyA9IERhdGEuQXJncwoJbG9jYWwgSWQgPSBEYXRhLklkCgoJLS0vLyBGbGFncwoJbG9jYWwgVGFibGVBcmdzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJUYWJsZUFyZ3MiKQoJbG9jYWwgTm9WYXJpYWJsZXMgPSBGbGFnczpHZXRGbGFnVmFsdWUoIk5vVmFyaWFibGVzIikKCgktLS8vIFVucGFjayBpbmZvCglsb2NhbCBSZW1vdGVEYXRhID0gUHJvY2VzczpHZXRSZW1vdGVEYXRhKElkKQoJbG9jYWwgSXNSZW1vdGVGdW5jdGlvbiA9IENsYXNzRGF0YS5Jc1JlbW90ZUZ1bmN0aW9uCglsb2NhbCBSZW1vdGVOYW1lID0gc2VsZjpGaWx0ZXJOYW1lKGB7UmVtb3RlfWAsIDUwKQoKCS0tLy8gVUkgZGF0YQoJbG9jYWwgQ29kZUVkaXRvciA9IHNlbGYuQ29kZUVkaXRvcgoJbG9jYWwgVG9EaXNwbGF5ID0gc2VsZi5EaXNwbGF5UmVtb3RlSW5mbwoJbG9jYWwgSW5mb1NlbGVjdG9yID0gc2VsZi5JbmZvU2VsZWN0b3IKCglsb2NhbCBUYWJGb2N1c2VkID0gc2VsZjpSZW1vdmVQcmV2aW91c1RhYigpCglsb2NhbCBUYWIgPSBJbmZvU2VsZWN0b3I6Q3JlYXRlVGFiKHsKCQlOYW1lID0gc2VsZjpGaWx0ZXJOYW1lKGBSZW1vdGU6IHtSZW1vdGVOYW1lfWAsIDUwKSwKCQlGb2N1c2VkID0gVGFiRm9jdXNlZAoJfSkKCgktLS8vIENyZWF0ZSBuZXcgcGFyc2VyCglsb2NhbCBNb2R1bGUgPSBHZW5lcmF0aW9uOk5ld1BhcnNlcih7CgkJTm9WYXJpYWJsZXMgPSBOb1ZhcmlhYmxlcwoJfSkKCWxvY2FsIFBhcnNlciA9IE1vZHVsZS5QYXJzZXIKCWxvY2FsIEZvcm1hdHRlciA9IE1vZHVsZS5Gb3JtYXR0ZXIKCUZvcm1hdHRlcjpTZXRWYWx1ZVN3YXBzKFZhbHVlU3dhcHMpCgoJLS0vLyBTZXQgdGhpcyBsb2cgdG8gYmUgc2VsZWN0ZWQKCUFjdGl2ZURhdGEgPSBEYXRhCglEYXRhLlRhYiA9IFRhYgoJRGF0YS5TZWxlY3RhYmxlOlNldFNlbGVjdGVkKHRydWUpCgoJbG9jYWwgZnVuY3Rpb24gU2V0SURFVGV4dChDb250ZW50OiBzdHJpbmcsIFRhc2s6IHN0cmluZz8pCgkJRGF0YS5UYXNrID0gVGFzayBvciAiU2lnbWEgU3B5IgoJCUNvZGVFZGl0b3I6U2V0VGV4dChDb250ZW50KQoJZW5kCglsb2NhbCBmdW5jdGlvbiBEYXRhQ29ubmVjdGlvbihOYW1lLCAuLi4pCgkJbG9jYWwgQXJncyA9IHsuLi59CgkJcmV0dXJuIGZ1bmN0aW9uKCkKCQkJcmV0dXJuIERhdGFbTmFtZV0oRGF0YSwgUHJvY2VzczpVbnBhY2soQXJncykpCgkJZW5kCgllbmQKCWxvY2FsIGZ1bmN0aW9uIFNjcmlwdENoZWNrKFNjcmlwdCwgTm9NaXNzaW5nQ2hlY2s6IGJvb2xlYW4pOiBib29sZWFuPwoJCS0tLy8gUmVqZWN0IGNsaWVudCBldmVudHMKCQlpZiBJc1JlY2VpdmUgdGhlbiAKCQkJVWk6U2hvd01vZGFsKHsKCQkJCSJSZWNpZXZlcyBkbyBub3QgaGF2ZSBhIHNjcmlwdCBiZWNhdXNlIGl0J3MgYSBDb25uZWN0aW9uIgoJCQl9KQoJCQlyZXR1cm4gCgkJZW5kCgoJCS0tLy8gQ2hlY2sgaWYgc2NyaXB0IGV4aXN0cwoJCWlmIG5vdCBTY3JpcHQgYW5kIG5vdCBOb01pc3NpbmdDaGVjayB0aGVuIAoJCQlVaTpTaG93TW9kYWwoeyJUaGUgU2NyaXB0IGhhcyBiZWVuIGRlc3Ryb3llZCBieSB0aGUgZ2FtZSAoLTk5OTk5OTkgQVVSQSkifSkKCQkJcmV0dXJuCgkJZW5kCgoJCXJldHVybiB0cnVlCgllbmQKCgktLS8vIEZ1bmN0aW9ucwoJZnVuY3Rpb24gRGF0YTpTY3JpcHRPcHRpb25zKEJ1dHRvbjogR3VpQnV0dG9uKQoJCVVpOk1ha2VCdXR0b25NZW51KEJ1dHRvbiwge3NlbGZ9LCB7CgkJCVsiQ2FsbGVyIEluZm8iXSA9IERhdGFDb25uZWN0aW9uKCJHZW5lcmF0ZUluZm8iKSwKCQkJWyJEZWNvbXBpbGUiXSA9IERhdGFDb25uZWN0aW9uKCJEZWNvbXBpbGUiLCAiU291cmNlU2NyaXB0IiksCgkJCVsiRGVjb21waWxlIENhbGxpbmciXSA9IERhdGFDb25uZWN0aW9uKCJEZWNvbXBpbGUiLCAiQ2FsbGluZ1NjcmlwdCIpLAoJCQlbIlJlcGVhdCBDYWxsIl0gPSBEYXRhQ29ubmVjdGlvbigiUmVwZWF0Q2FsbCIpLAoJCQlbIlNhdmUgQnl0ZWNvZGUiXSA9IERhdGFDb25uZWN0aW9uKCJTYXZlQnl0ZWNvZGUiKSwKCQl9KQoJZW5kCglmdW5jdGlvbiBEYXRhOkJ1aWxkU2NyaXB0KEJ1dHRvbjogR3VpQnV0dG9uKQoJCVVpOk1ha2VCdXR0b25NZW51KEJ1dHRvbiwge3NlbGZ9LCB7CgkJCVsiU2F2ZSJdID0gRGF0YUNvbm5lY3Rpb24oIlNhdmVTY3JpcHQiKSwKCQkJWyJDYWxsIFJlbW90ZSJdID0gRGF0YUNvbm5lY3Rpb24oIk1ha2VTY3JpcHQiLCAiUmVtb3RlIiksCgkJCVsiQmxvY2sgUmVtb3RlIl0gPSBEYXRhQ29ubmVjdGlvbigiTWFrZVNjcmlwdCIsICJCbG9jayIpLAoJCQlbIlJlcGVhdCBGb3IiXSA9IERhdGFDb25uZWN0aW9uKCJNYWtlU2NyaXB0IiwgIlJlcGVhdCIpLAoJCQlbIlNwYW0gUmVtb3RlIl0gPSBEYXRhQ29ubmVjdGlvbigiTWFrZVNjcmlwdCIsICJTcGFtIikKCQl9KQoJZW5kCglmdW5jdGlvbiBEYXRhOlNhdmVTY3JpcHQoKQoJCWxvY2FsIEZpbGVQYXRoID0gR2VuZXJhdGlvbjpUaW1lU3RhbXBGaWxlKHNlbGYuVGFzaykKCQl3cml0ZWZpbGUoRmlsZVBhdGgsIENvZGVFZGl0b3I6R2V0VGV4dCgpKQoKCQlVaTpTaG93TW9kYWwoeyJTYXZlZCBzY3JpcHQgdG8iLCBGaWxlUGF0aH0pCgllbmQKCWZ1bmN0aW9uIERhdGE6U2F2ZUJ5dGVjb2RlKCkKCQktLS8vIFByb2JsZW0gY2hlY2sKCQlpZiBub3QgU2NyaXB0Q2hlY2soU2NyaXB0LCB0cnVlKSB0aGVuIHJldHVybiBlbmQKCgkJLS0vLyBnZXRzY3JpcHRieXRlY29kZQogICAgCWxvY2FsIFN1Y2Nlc3MsIEJ5dGVjb2RlID0gcGNhbGwoZ2V0c2NyaXB0Ynl0ZWNvZGUsIFNjcmlwdCkKCQlpZiBub3QgU3VjY2VzcyB0aGVuCgkJCVVpOlNob3dNb2RhbCh7IkZhaWxlZCB0byBnZXQgU2NyaXB0ZSBieXRlY29kZSAoLTk5OTk5OTkgQVVSQSkifSkKCQkJcmV0dXJuCgkJZW5kCgoJCS0tLy8gU2F2ZSBmaWxlCgkJbG9jYWwgUGF0aEJhc2UgPSBge1NjcmlwdH0gJXMudHh0YAoJCWxvY2FsIEZpbGVQYXRoID0gR2VuZXJhdGlvbjpUaW1lU3RhbXBGaWxlKFBhdGhCYXNlKQoJCXdyaXRlZmlsZShGaWxlUGF0aCwgQnl0ZWNvZGUpCgoJCVVpOlNob3dNb2RhbCh7IlNhdmVkIGJ5dGVjb2RlIHRvIiwgRmlsZVBhdGh9KQoJZW5kCglmdW5jdGlvbiBEYXRhOk1ha2VTY3JpcHQoU2NyaXB0VHlwZTogc3RyaW5nKQoJCWxvY2FsIFNjcmlwdCA9IEdlbmVyYXRpb246UmVtb3RlU2NyaXB0KE1vZHVsZSwgc2VsZiwgU2NyaXB0VHlwZSkKCQlTZXRJREVUZXh0KFNjcmlwdCwgYEVkaXRpbmc6IHtSZW1vdGVOYW1lfS5sdWFgKQoJZW5kCglmdW5jdGlvbiBEYXRhOlJlcGVhdENhbGwoKQoJCWxvY2FsIFNpZ25hbCA9IEhvb2s6SW5kZXgoUmVtb3RlLCBNZXRob2QpCgoJCWlmIElzUmVjZWl2ZSB0aGVuCgkJCWZpcmVzaWduYWwoU2lnbmFsLCBQcm9jZXNzOlVucGFjayhBcmdzKSkKCQllbHNlCgkJCVNpZ25hbChSZW1vdGUsIFByb2Nlc3M6VW5wYWNrKEFyZ3MpKQoJCWVuZAoJZW5kCglmdW5jdGlvbiBEYXRhOkdldFJldHVybigpCgkJbG9jYWwgUmV0dXJuVmFsdWVzID0gc2VsZi5SZXR1cm5WYWx1ZXMKCgkJLS0vLyBFcnJvciBtZXNzYWdlcwoJCWlmIG5vdCBJc1JlbW90ZUZ1bmN0aW9uIHRoZW4KCQkJVWk6U2hvd01vZGFsKHsiVGhlIFJlbW90ZSBpcyBub3QgYSBSZW1vdGUgRnVuY3Rpb24gKC05OTk5OTk5IEFVUkEpIn0pCgkJCXJldHVybgoJCWVuZAoJCWlmIG5vdCBSZXR1cm5WYWx1ZXMgdGhlbgoJCQlVaTpTaG93TW9kYWwoeyJObyByZXR1cm4gdmFsdWVzICgtOTk5OTk5OSBBVVJBKSJ9KQoJCQlyZXR1cm4KCQllbmQKCgkJLS0vLyBHZW5lcmF0ZSBzY3JpcHQKCQlsb2NhbCBTY3JpcHQgPSBHZW5lcmF0aW9uOlRhYmxlU2NyaXB0KE1vZHVsZSwgUmV0dXJuVmFsdWVzKQoJCVNldElERVRleHQoU2NyaXB0LCBgUmV0dXJuIFZhbHVlcyBmb3I6IHtSZW1vdGVOYW1lfWApCgllbmQKCWZ1bmN0aW9uIERhdGE6R2VuZXJhdGVJbmZvKCkKCQktLS8vIFByb2JsZW0gY2hlY2sKCQlpZiBub3QgU2NyaXB0Q2hlY2sobmlsLCB0cnVlKSB0aGVuIHJldHVybiBlbmQKCgkJLS0vLyBHZW5lcmF0ZSBzY3JpcHQKCQlsb2NhbCBTY3JpcHQgPSBHZW5lcmF0aW9uOkFkdmFuY2VkSW5mbyhNb2R1bGUsIHNlbGYpCgkJU2V0SURFVGV4dChTY3JpcHQsIGBBZHZhbmNlZCBJbmZvIGZvcjoge1JlbW90ZU5hbWV9YCkKCWVuZAoJZnVuY3Rpb24gRGF0YTpEZWNvbXBpbGUoV2hpY2hTY3JpcHQ6IHN0cmluZykKCQlsb2NhbCBEZWNvbXBpbGVQb3BvdXQgPSBGbGFnczpHZXRGbGFnVmFsdWUoIkRlY29tcGlsZVBvcG91dCIpCgkJbG9jYWwgVG9EZWNvbXBpbGUgPSBEYXRhW1doaWNoU2NyaXB0XQoJCWxvY2FsIEVkaXRvciA9IENvZGVFZGl0b3IKCgkJLS0vLyBQcm9ibGVtIGNoZWNrCgkJaWYgbm90IFNjcmlwdENoZWNrKFRvRGVjb21waWxlLCB0cnVlKSB0aGVuIHJldHVybiBlbmQKCQlsb2NhbCBUYXNrID0gVWk6RmlsdGVyTmFtZShgVmlld2luZzoge1RvRGVjb21waWxlfS5sdWFgLCAyMDApCgkJCgkJLS0vLyBBdXRvbWF0aWNhbGx5IFBvcC1vdXQgdGhlIGVkaXRvciBmb3IgZGVjb21waWxpbmcgaWYgZW5hYmxlZAoJCWlmIERlY29tcGlsZVBvcG91dCB0aGVuCgkJCUVkaXRvciA9IFVpOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3coIiIsIHsKCQkJCVRpdGxlID0gVGFzawoJCQl9KQoJCWVuZAoKCQlVaTpEZWNvbXBpbGUoRWRpdG9yLCBUb0RlY29tcGlsZSkKCWVuZAoJCgktLS8vIFJlbW90ZU9wdGlvbnMKCXNlbGY6Q3JlYXRlT3B0aW9uc0ZvckRpY3QoVGFiLCBSZW1vdGVEYXRhLCBmdW5jdGlvbigpCgkJUHJvY2VzczpVcGRhdGVSZW1vdGVEYXRhKElkLCBSZW1vdGVEYXRhKQoJZW5kKQoKCS0tLy8gSW5zdGFuY2Ugb3B0aW9ucwoJc2VsZjpDcmVhdGVCdXR0b25zKFRhYiwgewoJCUJhc2UgPSB7CgkJCVNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjApLAoJCQlBdXRvbWF0aWNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLlksCgkJfSwKCQlCdXR0b25zID0gewoJCQl7CgkJCQlUZXh0ID0gIkNvcHkgc2NyaXB0IHBhdGgiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJU2V0Q2xpcGJvYXJkKFBhcnNlcjpNYWtlUGF0aFN0cmluZyh7CgkJCQkJCU9iamVjdCA9IFNjcmlwdCwKCQkJCQkJTm9WYXJpYWJsZXMgPSB0cnVlCgkJCQkJfSkpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQ29weSByZW1vdGUgcGF0aCIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlTZXRDbGlwYm9hcmQoUGFyc2VyOk1ha2VQYXRoU3RyaW5nKHsKCQkJCQkJT2JqZWN0ID0gUmVtb3RlLAoJCQkJCQlOb1ZhcmlhYmxlcyA9IHRydWUKCQkJCQl9KSkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJSZW1vdmUgbG9nIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCUluZm9TZWxlY3RvcjpSZW1vdmVUYWIoVGFiKQoJCQkJCURhdGEuU2VsZWN0YWJsZTpSZW1vdmUoKQoJCQkJCUhlYWRlckRhdGE6UmVtb3ZlKCkKCQkJCQlBY3RpdmVEYXRhID0gbmlsCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiRHVtcCBsb2dzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIExvZ3MgPSBIZWFkZXJEYXRhLkVudHJpZXMKCQkJCQlsb2NhbCBGaWxlUGF0aCA9IEdlbmVyYXRpb246RHVtcExvZ3MoTG9ncykKCQkJCQlzZWxmOlNob3dNb2RhbCh7IlNhdmVkIGR1bXAgdG8iLCBGaWxlUGF0aH0pCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiVmlldyBDb25uZWN0aW9ucyIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBNZXRob2QgPSBDbGFzc0RhdGEuUmVjZWl2ZVsxXQoJCQkJCWxvY2FsIFNpZ25hbCA9IFJlbW90ZVtNZXRob2RdCgkJCQkJc2VsZjpWaWV3Q29ubmVjdGlvbnMoUmVtb3RlTmFtZSwgU2lnbmFsKQoJCQkJZW5kLAoJCQl9CgkJfQoJfSkKCgktLS8vIFJlbW90ZSBpbmZvcm1hdGlvbiB0YWJsZQoJc2VsZjpEaXNwbGF5VGFibGUoVGFiLCB7CgkJUm93cyA9IHsiTmFtZSIsICJWYWx1ZSJ9LAoJCVRhYmxlID0gRGF0YSwKCQlUb0Rpc3BsYXkgPSBUb0Rpc3BsYXksCgkJRmxhZ3MgPSB7CgkJCUJvcmRlciA9IHRydWUsCgkJCVJvd0JhY2tncm91bmQgPSB0cnVlLAoJCQlNYXhDb2x1bW5zID0gMgoJCX0KCX0pCgkKCS0tLy8gQXJndW1lbnRzIHRhYmxlIHNjcmlwdAoJaWYgVGFibGVBcmdzIHRoZW4KCQlsb2NhbCBQYXJzZWQgPSBHZW5lcmF0aW9uOlRhYmxlU2NyaXB0KE1vZHVsZSwgQXJncykKCQlTZXRJREVUZXh0KFBhcnNlZCwgYEFyZ3VtZW50cyBmb3Ige1JlbW90ZU5hbWV9YCkKCQlyZXR1cm4KCWVuZAoKCS0tLy8gUmVtb3RlIGNhbGwgc2NyaXB0CglEYXRhOk1ha2VTY3JpcHQoIlJlbW90ZSIpCmVuZAoKZnVuY3Rpb24gVWk6Vmlld0Nvbm5lY3Rpb25zKFJlbW90ZU5hbWU6IHN0cmluZywgU2lnbmFsOiBSQlhTY3JpcHRDb25uZWN0aW9uKQoJbG9jYWwgV2luZG93ID0gc2VsZjpDcmVhdGVXaW5kb3coewoJCVRpdGxlID0gYENvbm5lY3Rpb25zIGZvcjoge1JlbW90ZU5hbWV9YCwKCQlTaXplID0gVURpbTIuZnJvbU9mZnNldCg0NTAsIDI1MCkKCX0pCgoJbG9jYWwgVG9EaXNwbGF5ID0gewoJCSJFbmFibGVkIiwKCQkiTHVhQ29ubmVjdGlvbiIsCgkJIlNjcmlwdCIKCX0KCgktLS8vIEdldCBGaWx0ZXJlZCBjb25uZWN0aW9ucwoJbG9jYWwgQ29ubmVjdGlvbnMgPSBQcm9jZXNzOkZpbHRlckNvbm5lY3Rpb25zKFNpZ25hbCwgVG9EaXNwbGF5KQoKCS0tLy8gVGFibGUKCWxvY2FsIFRhYmxlID0gV2luZG93OlRhYmxlKHsKCQlCb3JkZXIgPSB0cnVlLAoJCVJvd0JhY2tncm91bmQgPSB0cnVlLAoJCU1heENvbHVtbnMgPSAzCgl9KQoKCWxvY2FsIEJ1dHRvbnNGb3JWYWx1ZXMgPSB7CgkJWyJTY3JpcHQiXSA9IGZ1bmN0aW9uKFJvdywgVmFsdWUpCgkJCVJvdzpCdXR0b24oewoJCQkJVGV4dCA9ICJEZWNvbXBpbGUiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgVGFzayA9IHNlbGY6RmlsdGVyTmFtZShgVmlld2luZzoge1ZhbHVlfS5sdWFgLCAyMDApCgkJCQkJbG9jYWwgRWRpdG9yID0gc2VsZjpNYWtlRWRpdG9yUG9wb3V0V2luZG93KG5pbCwgewoJCQkJCQlUaXRsZSA9IFRhc2sKCQkJCQl9KQoJCQkJCXNlbGY6RGVjb21waWxlKEVkaXRvciwgVmFsdWUpCgkJCQllbmQKCQkJfSkKCQllbmQsCgkJWyJFbmFibGVkIl0gPSBmdW5jdGlvbihSb3csIEVuYWJsZWQsIENvbm5lY3Rpb24pCgkJCVJvdzpCdXR0b24oewoJCQkJVGV4dCA9IEVuYWJsZWQgYW5kICJEaXNhYmxlIiBvciAiRW5hYmxlIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oc2VsZikKCQkJCQlFbmFibGVkID0gbm90IEVuYWJsZWQKCQkJCQlzZWxmLlRleHQgPSBFbmFibGVkIGFuZCAiRGlzYWJsZSIgb3IgIkVuYWJsZSIKCgkJCQkJLS0vLyBFbmFibGUgb3IgZGlzYWJsZSB0aGUgY29ubmVjdGlvbgoJCQkJCWlmIEVuYWJsZWQgdGhlbgoJCQkJCQlDb25uZWN0aW9uOkVuYWJsZSgpCgkJCQkJZWxzZQoJCQkJCQlDb25uZWN0aW9uOkRpc2FibGUoKQoJCQkJCWVuZAoJCQkJZW5kCgkJCX0pCgkJZW5kCgl9CgoJLS0vLyBNYWtlIGhlYWRlcnMgb24gdGhlIHRhYmxlCglzZWxmOk1ha2VUYWJsZUhlYWRlcnMoVGFibGUsIFRvRGlzcGxheSkKCglmb3IgXywgQ29ubmVjdGlvbiBpbiBDb25uZWN0aW9ucyBkbwoJCWxvY2FsIFJvdyA9IFRhYmxlOlJvdygpCgoJCWZvciBfLCBQcm9wZXJ0eSBpbiBUb0Rpc3BsYXkgZG8KCQkJbG9jYWwgQ29sdW1uID0gUm93Ok5leHRDb2x1bW4oKQoJCQlsb2NhbCBDb2x1bW5Sb3cgPSBDb2x1bW46Um93KCkKCgkJCWxvY2FsIFZhbHVlID0gQ29ubmVjdGlvbltQcm9wZXJ0eV0KCQkJbG9jYWwgQ2FsbGJhY2sgPSBCdXR0b25zRm9yVmFsdWVzW1Byb3BlcnR5XQoKCQkJLS0vLyBWYWx1ZSBsYWJlbAoJCQlDb2x1bW5Sb3c6TGFiZWwoe1RleHQ9YHtWYWx1ZX1gfSkKCgkJCS0tLy8gQWRkIGJ1dHRvbnMKCQkJaWYgQ2FsbGJhY2sgdGhlbgoJCQkJQ2FsbGJhY2soQ29sdW1uUm93LCBWYWx1ZSwgQ29ubmVjdGlvbikKCQkJZW5kCgkJZW5kCgllbmQKCgktLS8vIENlbnRlciBXaW5kb3cKCVdpbmRvdzpDZW50ZXIoKQplbmQKCmZ1bmN0aW9uIFVpOkdldFJlbW90ZUhlYWRlcihEYXRhOiBMb2cpCglsb2NhbCBMb2dMaW1pdCA9IHNlbGYuTG9nTGltaXQKCWxvY2FsIExvZ3MgPSBzZWxmLkxvZ3MKCWxvY2FsIFJlbW90ZXNMaXN0ID0gc2VsZi5SZW1vdGVzTGlzdAoKCS0tLy8gUmVtb3RlIGluZm8KCWxvY2FsIElkID0gRGF0YS5JZAoJbG9jYWwgUmVtb3RlID0gRGF0YS5SZW1vdGUKCWxvY2FsIFJlbW90ZU5hbWUgPSBzZWxmOkZpbHRlck5hbWUoYHtSZW1vdGV9YCwgMzApCgoJLS0vLyBOb1RyZWVOb2RlcwoJbG9jYWwgTm9UcmVlTm9kZXMgPSBGbGFnczpHZXRGbGFnVmFsdWUoIk5vVHJlZU5vZGVzIikKCgktLS8vIENoZWNrIGZvciBleGlzdGluZyBUcmVlTm9kZQoJbG9jYWwgRXhpc3RpbmcgPSBMb2dzW0lkXQoJaWYgRXhpc3RpbmcgdGhlbiByZXR1cm4gRXhpc3RpbmcgZW5kCgoJLS0vLyBIZWFkZXIgZGF0YQoJbG9jYWwgSGVhZGVyRGF0YSA9IHsJCgkJTG9nQ291bnQgPSAwLAoJCURhdGEgPSBEYXRhLAoJCUVudHJpZXMgPSB7fQoJfQoKCS0tLy8gSW5jcmVtZW50IHRyZWVub2RlIGNvdW50CglSZW1vdGVzQ291bnQgKz0gMQoKCS0tLy8gQ3JlYXRlIG5ldyB0cmVlbm9kZSBlbGVtZW50CglpZiBub3QgTm9UcmVlTm9kZXMgdGhlbgoJCUhlYWRlckRhdGEuVHJlZU5vZGUgPSBSZW1vdGVzTGlzdDpUcmVlTm9kZSh7CgkJCUxheW91dE9yZGVyID0gLTEgKiBSZW1vdGVzQ291bnQsCgkJCVRpdGxlID0gUmVtb3RlTmFtZQoJCX0pCgllbmQKCglmdW5jdGlvbiBIZWFkZXJEYXRhOkNoZWNrTGltaXQoKQoJCWxvY2FsIEVudHJpZXMgPSBzZWxmLkVudHJpZXMKCQlpZiAjRW50cmllcyA8IExvZ0xpbWl0IHRoZW4gcmV0dXJuIGVuZAoJCQkKCQktLS8vIEdldCBhbmQgcmVtb3ZlIGxhc3QgZWxlbWVudAoJCWxvY2FsIExvZyA9IHRhYmxlLnJlbW92ZShFbnRyaWVzLCAxKQoJCUxvZy5TZWxlY3RhYmxlOlJlbW92ZSgpCgllbmQKCglmdW5jdGlvbiBIZWFkZXJEYXRhOkxvZ0FkZGVkKERhdGEpCgkJLS0vLyBJbmNyZW1lbnQgbG9nIGNvdW50CgkJc2VsZi5Mb2dDb3VudCArPSAxCgkJc2VsZjpDaGVja0xpbWl0KCkKCgkJLS0vLyBBZGQgZW50cnkKCQlsb2NhbCBFbnRyaWVzID0gc2VsZi5FbnRyaWVzCgkJdGFibGUuaW5zZXJ0KEVudHJpZXMsIERhdGEpCgkJCgkJcmV0dXJuIHNlbGYKCWVuZAoKCWZ1bmN0aW9uIEhlYWRlckRhdGE6UmVtb3ZlKCkKCQktLS8vIFJlbW92ZSBUcmVlTm9kZQoJCWxvY2FsIFRyZWVOb2RlID0gc2VsZi5UcmVlTm9kZQoJCWlmIFRyZWVOb2RlIHRoZW4KCQkJVHJlZU5vZGU6UmVtb3ZlKCkKCQllbmQKCgkJLS0vLyBDbGVhciB0YWJsZXMgZnJvbSBtZW1vcnkKCQlMb2dzW0lkXSA9IG5pbAoJCXRhYmxlLmNsZWFyKEhlYWRlckRhdGEpCgllbmQKCglMb2dzW0lkXSA9IEhlYWRlckRhdGEKCXJldHVybiBIZWFkZXJEYXRhCmVuZAoKZnVuY3Rpb24gVWk6Q2xlYXJMb2dzKCkKCWxvY2FsIExvZ3MgPSBzZWxmLkxvZ3MKCWxvY2FsIFJlbW90ZXNMaXN0ID0gc2VsZi5SZW1vdGVzTGlzdAoKCS0tLy8gQ2xlYXIgYWxsIGVsZW1lbnRzCglSZW1vdGVzQ291bnQgPSAwCglSZW1vdGVzTGlzdDpDbGVhckNoaWxkRWxlbWVudHMoKQoKCS0tLy8gQ2xlYXIgbG9ncyBmcm9tIG1lbW9yeQoJdGFibGUuY2xlYXIoTG9ncykKZW5kCgpmdW5jdGlvbiBVaTpRdWV1ZUxvZyhEYXRhKQoJbG9jYWwgTG9nUXVldWUgPSBzZWxmLkxvZ1F1ZXVlCglQcm9jZXNzOk1lcmdlKERhdGEsIHsKCQlBcmdzID0gUHJvY2VzczpEZWVwQ2xvbmVUYWJsZShEYXRhLkFyZ3MpLAoJfSkKCglpZiBEYXRhLlJldHVyblZhbHVlcyB0aGVuCiAgICAgICAgRGF0YS5SZXR1cm5WYWx1ZXMgPSBQcm9jZXNzOkRlZXBDbG9uZVRhYmxlKERhdGEuUmV0dXJuVmFsdWVzKQogICAgZW5kCgkKICAgIHRhYmxlLmluc2VydChMb2dRdWV1ZSwgRGF0YSkKZW5kCgpmdW5jdGlvbiBVaTpQcm9jZXNzTG9nUXVldWUoKQoJbG9jYWwgUXVldWUgPSBzZWxmLkxvZ1F1ZXVlCiAgICBpZiAjUXVldWUgPD0gMCB0aGVuIHJldHVybiBlbmQKCgktLS8vIENyZWF0ZSBhIGxvZyBlbGVtZW50IGZvciBlYWNoIGluIHRoZSBRdWV1ZQogICAgZm9yIEluZGV4LCBEYXRhIGluIG5leHQsIFF1ZXVlIGRvCiAgICAgICAgc2VsZjpDcmVhdGVMb2coRGF0YSkKICAgICAgICB0YWJsZS5yZW1vdmUoUXVldWUsIEluZGV4KQogICAgZW5kCmVuZAoKZnVuY3Rpb24gVWk6QmVnaW5Mb2dTZXJ2aWNlKCkKCWNvcm91dGluZS53cmFwKGZ1bmN0aW9uKCkKCQl3aGlsZSB0cnVlIGRvCgkJCXNlbGY6UHJvY2Vzc0xvZ1F1ZXVlKCkKCQkJdGFzay53YWl0KCkKCQllbmQKCWVuZCkoKQplbmQKCmZ1bmN0aW9uIFVpOkZpbHRlck5hbWUoTmFtZTogc3RyaW5nLCBDaGFyYWN0ZXJMaW1pdDogbnVtYmVyPyk6IHN0cmluZwoJbG9jYWwgVHJpbW1lZCA9IE5hbWU6c3ViKDEsIENoYXJhY3RlckxpbWl0IG9yIDIwKQoJbG9jYWwgRmlsdHJlZCA9IFRyaW1tZWQ6Z3N1YigiW1xuXHJdIiwgIiIpCglGaWx0cmVkID0gR2VuZXJhdGlvbjpNYWtlUHJpbnRhYmxlKEZpbHRyZWQpCgoJcmV0dXJuIEZpbHRyZWQKZW5kCgpmdW5jdGlvbiBVaTpDcmVhdGVMb2coRGF0YTogTG9nKQoJLS0vLyBVbnBhY2sgbG9nIGRhdGEKICAgIGxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCglsb2NhbCBNZXRob2QgPSBEYXRhLk1ldGhvZAogICAgbG9jYWwgQXJncyA9IERhdGEuQXJncwogICAgbG9jYWwgSXNSZWNlaXZlID0gRGF0YS5Jc1JlY2VpdmUKCWxvY2FsIElkID0gRGF0YS5JZAoJbG9jYWwgVGltZXN0YW1wID0gRGF0YS5UaW1lc3RhbXAKCWxvY2FsIElzRXhwbG9pdCA9IERhdGEuSXNFeHBsb2l0CgkKCWxvY2FsIElzTmlsUGFyZW50ID0gSG9vazpJbmRleChSZW1vdGUsICJQYXJlbnQiKSA9PSBuaWwKCWxvY2FsIFJlbW90ZURhdGEgPSBQcm9jZXNzOkdldFJlbW90ZURhdGEoSWQpCgoJLS0vLyBQYXVzZWQKCWxvY2FsIFBhdXNlZCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiUGF1c2VkIikKCWlmIFBhdXNlZCB0aGVuIHJldHVybiBlbmQKCgktLS8vIENoZWNrIGNhbGxlciAoSWdub3JlIGV4cGxvaXQgY2FsbHMpCglsb2NhbCBMb2dFeHBsb2l0ID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJMb2dFeHBsb2l0IikKCWlmIG5vdCBMb2dFeHBsb2l0IGFuZCBJc0V4cGxvaXQgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBJZ25vcmVOaWwKCWxvY2FsIElnbm9yZU5pbCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiSWdub3JlTmlsIikKCWlmIElnbm9yZU5pbCBhbmQgSXNOaWxQYXJlbnQgdGhlbiByZXR1cm4gZW5kCgogICAgLS0vLyBMb2dSZWNpdmVzIGNoZWNrCglsb2NhbCBMb2dSZWNpdmVzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJMb2dSZWNpdmVzIikKCWlmIG5vdCBMb2dSZWNpdmVzIGFuZCBJc1JlY2VpdmUgdGhlbiByZXR1cm4gZW5kCgoJbG9jYWwgU2VsZWN0TmV3ZXN0ID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJTZWxlY3ROZXdlc3QiKQoJbG9jYWwgTm9UcmVlTm9kZXMgPSBGbGFnczpHZXRGbGFnVmFsdWUoIk5vVHJlZU5vZGVzIikKCiAgICAtLS8vIEV4Y2x1ZGVkIGNoZWNrCiAgICBpZiBSZW1vdGVEYXRhLkV4Y2x1ZGVkIHRoZW4gcmV0dXJuIGVuZAoKCS0tLy8gRGVzZXJpYWxpemUgYXJndW1lbnRzCglBcmdzID0gQ29tbXVuaWNhdGlvbjpEZXNlcmlhbGl6ZVRhYmxlKEFyZ3MpCgoJLS0vLyBEZWVwIGNsb25lIGRhdGEKCWxvY2FsIENsb25lZEFyZ3MgPSBQcm9jZXNzOkRlZXBDbG9uZVRhYmxlKEFyZ3MpCglEYXRhLkFyZ3MgPSBDbG9uZWRBcmdzCglEYXRhLlZhbHVlU3dhcHMgPSBHZW5lcmF0aW9uOk1ha2VWYWx1ZVN3YXBzVGFibGUoVGltZXN0YW1wKQoKCS0tLy8gR2VuZXJhdGUgbG9nIHRpdGxlCglsb2NhbCBNZXRob2RDb2xvcnMgPSBDb25maWcgYW5kIENvbmZpZy5NZXRob2RDb2xvcnMgb3Ige30KCWxvY2FsIENvbG9yID0gTWV0aG9kQ29sb3JzW01ldGhvZDpsb3dlcigpXQoJbG9jYWwgVGV4dCA9IE5vVHJlZU5vZGVzIGFuZCBge1JlbW90ZX0gfCB7TWV0aG9kfWAgb3IgTWV0aG9kCgoJLS0vLyBGaW5kU3RyaW5nRm9yTmFtZSBjaGVjawoJbG9jYWwgRmluZFN0cmluZyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiRmluZFN0cmluZ0Zvck5hbWUiKQoJaWYgRmluZFN0cmluZyB0aGVuCgkJZm9yIF8sIEFyZyBpbiBuZXh0LCBDbG9uZWRBcmdzIGRvCgkJCWlmIHR5cGVvZihBcmcpID09ICJzdHJpbmciIHRoZW4KCQkJCWxvY2FsIEZpbHRyZWQgPSBzZWxmOkZpbHRlck5hbWUoQXJnKQoJCQkJVGV4dCA9IGB7RmlsdHJlZH0gfCB7VGV4dH1gCgkJCQlicmVhawoJCQllbmQKCQllbmQKCWVuZAoKCS0tLy8gRmV0Y2ggSGVhZGVyRGF0YSBieSB0aGUgUmVtb3RlSUQgdXNlZCBmb3Igc3RhY2tpbmcKCWxvY2FsIEhlYWRlciA9IHNlbGY6R2V0UmVtb3RlSGVhZGVyKERhdGEpCglsb2NhbCBSZW1vdGVzTGlzdCA9IHNlbGYuUmVtb3Rlc0xpc3QKCglsb2NhbCBMb2dDb3VudCA9IEhlYWRlci5Mb2dDb3VudAoJbG9jYWwgVHJlZU5vZGUgPSBIZWFkZXIuVHJlZU5vZGUgCglsb2NhbCBQYXJlbnQgPSBUcmVlTm9kZSBvciBSZW1vdGVzTGlzdAoKCS0tLy8gSW5jcmVhc2UgbG9nIGNvdW50IC0gVHJlZU5vZGVzIGFyZSBpbiBHZXRSZW1vdGVIZWFkZXIgZnVuY3Rpb24KCWlmIE5vVHJlZU5vZGVzIHRoZW4KCQlSZW1vdGVzQ291bnQgKz0gMQoJCUxvZ0NvdW50ID0gUmVtb3Rlc0NvdW50CgllbmQKCiAgICAtLS8vIENyZWF0ZSBmb2N1cyBidXR0b24KCURhdGEuSGVhZGVyRGF0YSA9IEhlYWRlcgoJRGF0YS5TZWxlY3RhYmxlID0gUGFyZW50OlNlbGVjdGFibGUoewoJCVRleHQgPSBUZXh0LAogICAgICAgIExheW91dE9yZGVyID0gLTEgKiBMb2dDb3VudCwKCQlUZXh0Q29sb3IzID0gQ29sb3IsCgkJVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkxlZnQsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCXNlbGY6U2V0Rm9jdXNlZFJlbW90ZShEYXRhKQoJCWVuZCwKICAgIH0pCgoJSGVhZGVyOkxvZ0FkZGVkKERhdGEpCgoJLS0vLyBBdXRvIHNlbGVjdCBjaGVjawoJbG9jYWwgR3JvdXBTZWxlY3RlZCA9IEFjdGl2ZURhdGEgYW5kIEFjdGl2ZURhdGEuSGVhZGVyRGF0YSA9PSBIZWFkZXIKCWlmIFNlbGVjdE5ld2VzdCBhbmQgR3JvdXBTZWxlY3RlZCB0aGVuCgkJc2VsZjpTZXRGb2N1c2VkUmVtb3RlKERhdGEpCgllbmQKZW5kCgpyZXR1cm4gVWk=]],
},Generation={'base64',
[[dHlwZSB0YWJsZSA9IHsKCVthbnldOiBhbnkKfQoKdHlwZSBSZW1vdGVEYXRhID0gewoJUmVtb3RlOiBJbnN0YW5jZSwKCUlzUmVjZWl2ZTogYm9vbGVhbj8sCglNZXRhTWV0aG9kOiBzdHJpbmcsCglBcmdzOiB0YWJsZSwKCU1ldGhvZDogc3RyaW5nLAogICAgVHJhbnNmZXJUeXBlOiBzdHJpbmcsCglWYWx1ZVJlcGxhY2VtZW50czogdGFibGUsCglOb1ZhcmlhYmxlczogYm9vbGVhbj8KfQoKLS0vLyBNb2R1bGUKbG9jYWwgR2VuZXJhdGlvbiA9IHsKCUR1bXBCYXNlTmFtZSA9ICJTaWdtYVNweS1EdW1wICVzLmx1YSIsIC0tICItLSBHZW5lcmF0ZWQgd2l0aCBzaWdtYSBzcHkgQk9JSUlJSUlJSUkgKCs5OTk5OTk5IEFVUkEpXG4iCglIZWFkZXIgPSAiLS0gR2VuZXJhdGVkIHdpdGggU2lnbWEgU3B5IEdpdGh1YjogaHR0cHM6Ly9naXRodWIuY29tL2RlcHRoc28vU2lnbWEtU3B5XG5GaXggYnkgQWJhYmEgYW5kIERleHowMCBhbmQgbmN3d2NuIiwKCVNjcmlwdFRlbXBsYXRlcyA9IHsKCQlbIlJlbW90ZSJdID0gewoJCQl7IiVSZW1vdGVDYWxsJSJ9CgkJfSwKCQlbIlNwYW0iXSA9IHsKCQkJeyJ3aGlsZSB3YWl0KCkgZG8ifSwKCQkJeyIlUmVtb3RlQ2FsbCUiLCAyfSwKCQkJeyJlbmQifQoJCX0sCgkJWyJSZXBlYXQiXSA9IHsKCQkJeyJmb3IgSW5kZXggPSAxLCAxMCBkbyJ9LAoJCQl7IiVSZW1vdGVDYWxsJSIsIDJ9LAoJCQl7ImVuZCJ9CgkJfSwKCQlbIkJsb2NrIl0gPSB7CgkJCVsiX19pbmRleCJdID0gewoJCQkJeyJsb2NhbCBPbGQ7IE9sZCA9IGhvb2tmdW5jdGlvbiglU2lnbmFsJSwgZnVuY3Rpb24oc2VsZiwgLi4uKSJ9LAoJCQkJeyJpZiBzZWxmID09ICVSZW1vdGUlIHRoZW4iLCAyfSwKCQkJCXsicmV0dXJuIiwgM30sCgkJCQl7ImVuZCIsIDJ9LAoJCQkJeyJyZXR1cm4gT2xkKHNlbGYsIC4uLikiLCAyfSwKCQkJCXsiZW5kKSJ9CgkJCX0sCgkJCVsiX19uYW1lY2FsbCJdID0gewoJCQkJeyJsb2NhbCBPbGQ7IE9sZCA9IGhvb2ttZXRhbWV0aG9kKGdhbWUsIFwiX19uYW1lY2FsbFwiLCBmdW5jdGlvbihzZWxmLCAuLi4pIn0sCgkJCQl7ImxvY2FsIE1ldGhvZCA9IGdldG5hbWVjYWxsbWV0aG9kKCkiLCAyfSwKCQkJCXsiaWYgc2VsZiA9PSAlUmVtb3RlJSBhbmQgTWV0aG9kID09IFwiJU1ldGhvZCVcIiB0aGVuIiwgMn0sCgkJCQl7InJldHVybiIsIDN9LAoJCQkJeyJlbmQiLCAyfSwKCQkJCXsicmV0dXJuIE9sZChzZWxmLCAuLi4pIiwgMn0sCgkJCQl7ImVuZCkifQoJCQl9LAoJCQlbIkNvbm5lY3QiXSA9IHsKCQkJCXsiZm9yIF8sIENvbm5lY3Rpb24gaW4gZ2V0Y29ubmVjdGlvbnMoJVNpZ25hbCUpIGRvIn0sCgkJCQl7IkNvbm5lY3Rpb246RGlzYWJsZSgpIiwgMn0sCgkJCQl7ImVuZCJ9CgkJCX0KCQl9Cgl9Cn0KCi0tLy8gTW9kdWxlcwpsb2NhbCBDb25maWcKbG9jYWwgSG9vawpsb2NhbCBQYXJzZXJNb2R1bGUKbG9jYWwgRmxhZ3MKbG9jYWwgVGhpc1NjcmlwdCA9IHNjcmlwdAoKbG9jYWwgZnVuY3Rpb24gTWVyZ2UoQmFzZTogdGFibGUsIE5ldzogdGFibGU/KQoJaWYgbm90IE5ldyB0aGVuIHJldHVybiBlbmQKCWZvciBLZXksIFZhbHVlIGluIG5leHQsIE5ldyBkbwoJCUJhc2VbS2V5XSA9IFZhbHVlCgllbmQKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkluaXQoRGF0YTogdGFibGUpCiAgICBsb2NhbCBNb2R1bGVzID0gRGF0YS5Nb2R1bGVzCglsb2NhbCBDb25maWd1cmF0aW9uID0gTW9kdWxlcy5Db25maWd1cmF0aW9uCgoJLS0vLyBNb2R1bGVzCglDb25maWcgPSBNb2R1bGVzLkNvbmZpZwoJSG9vayA9IE1vZHVsZXMuSG9vawoJRmxhZ3MgPSBNb2R1bGVzLkZsYWdzCgkKCS0tLy8gSW1wb3J0IHBhcnNlcgoJbG9jYWwgUGFyc2VyVXJsID0gQ29uZmlndXJhdGlvbi5QYXJzZXJVcmwKCXNlbGY6TG9hZFBhcnNlcihQYXJzZXJVcmwpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlUHJpbnRhYmxlKFN0cmluZzogc3RyaW5nKTogc3RyaW5nCglsb2NhbCBGb3JtYXR0ZXIgPSBQYXJzZXJNb2R1bGUuTW9kdWxlcy5Gb3JtYXR0ZXIKCXJldHVybiBGb3JtYXR0ZXI6TWFrZVByaW50YWJsZShTdHJpbmcpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpUaW1lU3RhbXBGaWxlKEZpbGVQYXRoOiBzdHJpbmcpOiBzdHJpbmcKCWxvY2FsIFRpbWVTdGFtcCA9IG9zLmRhdGUoIiVZLSVtLSVkXyVILSVNLSVTIikKCWxvY2FsIEZvcm1hdHRlZCA9IEZpbGVQYXRoOmZvcm1hdChUaW1lU3RhbXApCglyZXR1cm4gRm9ybWF0dGVkCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpXcml0ZUR1bXAoQ29udGVudDogc3RyaW5nKTogc3RyaW5nCglsb2NhbCBEdW1wQmFzZU5hbWUgPSBzZWxmLkR1bXBCYXNlTmFtZQoJbG9jYWwgRmlsZVBhdGggPSBzZWxmOlRpbWVTdGFtcEZpbGUoRHVtcEJhc2VOYW1lKQoKCS0tLy8gV3JpdGUgdG8gZmlsZQoJd3JpdGVmaWxlKEZpbGVQYXRoLCBDb250ZW50KQoKCXJldHVybiBGaWxlUGF0aAplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246TG9hZFBhcnNlcihNb2R1bGVVcmw6IHN0cmluZykKCVBhcnNlck1vZHVsZSA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KE1vZHVsZVVybCksICJQYXJzZXIiKSgpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlVmFsdWVTd2Fwc1RhYmxlKCk6IHRhYmxlCglsb2NhbCBGb3JtYXR0ZXIgPSBQYXJzZXJNb2R1bGUuTW9kdWxlcy5Gb3JtYXR0ZXIKCXJldHVybiBGb3JtYXR0ZXI6TWFrZVJlcGxhY2VtZW50cygpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpTZXRTd2Fwc0NhbGxiYWNrKENhbGxiYWNrOiAoSW50ZXJmYWNlOiB0YWJsZSkgLT4gKCkpCglzZWxmLlN3YXBzQ2FsbGJhY2sgPSBDYWxsYmFjawplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246R2V0QmFzZShNb2R1bGUpOiAoc3RyaW5nLCBib29sZWFuKQoJbG9jYWwgTm9Db21tZW50cyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiTm9Db21tZW50cyIpCglsb2NhbCBIZWFkZXIgPSBzZWxmLkhlYWRlcgoKCWxvY2FsIENvZGUgPSBOb0NvbW1lbnRzIGFuZCAiIiBvciBIZWFkZXIKCgktLS8vIEdlbmVyYXRlIHZhcmlhYmxlcyBjb2RlCglsb2NhbCBWYXJpYWJsZXMgPSBNb2R1bGUuUGFyc2VyOk1ha2VWYXJpYWJsZUNvZGUoewoJCSJTZXJ2aWNlcyIsICJSZW1vdGUiLCAiVmFyaWFibGVzIgoJfSwgTm9Db21tZW50cykKCglsb2NhbCBOb1ZhcmlhYmxlcyA9IFZhcmlhYmxlcyA9PSAiIgoJQ29kZSAuLj0gVmFyaWFibGVzCgoJcmV0dXJuIENvZGUsIE5vVmFyaWFibGVzCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpHZXRTd2FwcygpCglsb2NhbCBGdW5jID0gc2VsZi5Td2Fwc0NhbGxiYWNrCglsb2NhbCBTd2FwcyA9IHt9CgoJbG9jYWwgSW50ZXJmYWNlID0ge30KCWZ1bmN0aW9uIEludGVyZmFjZTpBZGRTd2FwKE9iamVjdDogSW5zdGFuY2UsIERhdGE6IHRhYmxlKQoJCWlmIG5vdCBPYmplY3QgdGhlbiByZXR1cm4gZW5kCgkJU3dhcHNbT2JqZWN0XSA9IERhdGEKCWVuZAoKCS0tLy8gSW52b2tlIEdldFN3YXBzIGZ1bmN0aW9uCglGdW5jKEludGVyZmFjZSkKCglyZXR1cm4gU3dhcHMKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOlBpY2tWYXJpYWJsZU5hbWUoKTogc3RyaW5nCglsb2NhbCBOYW1lcyA9IENvbmZpZyBhbmQgQ29uZmlnLlZhcmlhYmxlTmFtZXMgb3IgeyJBcmd1bWVudCJ9CglyZXR1cm4gTmFtZXNbbWF0aC5yYW5kb20oMSwgI05hbWVzKV0KZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOk5ld1BhcnNlcihFeHRyYTogdGFibGU/KQoJbG9jYWwgVmFyaWFibGVOYW1lID0gc2VsZjpQaWNrVmFyaWFibGVOYW1lKCkKCWxvY2FsIFN3YXBzID0gc2VsZjpHZXRTd2FwcygpCgoJbG9jYWwgQ29uZmlndXJhdGlvbiA9IHsKCQlWYXJpYWJsZUJhc2UgPSBWYXJpYWJsZU5hbWUsCgkJU3dhcHMgPSBTd2FwcywKCQlJbmRleEZ1bmMgPSBmdW5jdGlvbiguLi4pCgkJCXJldHVybiBIb29rOkluZGV4KC4uLikKCQllbmQsCgl9CgoJLS0vLyBNZXJnZSBleHRyYSBjb25maWd1cmF0aW9uCglNZXJnZShDb25maWd1cmF0aW9uLCBFeHRyYSkKCgktLS8vIENyZWF0ZSBuZXcgcGFyc2VyIGluc3RhbmNlCglyZXR1cm4gUGFyc2VyTW9kdWxlOk5ldyhDb25maWd1cmF0aW9uKQplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246SW5kZW50KEluZGVudFN0cmluZzogc3RyaW5nLCBMaW5lOiBzdHJpbmcpCglyZXR1cm4gYHtJbmRlbnRTdHJpbmd9e0xpbmV9YAplbmQKCnR5cGUgQ2FsbEluZm8gPSB7CglBcmd1bWVudHM6IHRhYmxlLAoJSW5kZW50OiBudW1iZXIsCglSZW1vdGVWYXJpYWJsZTogc3RyaW5nLAoJTW9kdWxlOiB0YWJsZQp9CmZ1bmN0aW9uIEdlbmVyYXRpb246Q2FsbFJlbW90ZVNjcmlwdChEYXRhLCBJbmZvOiBDYWxsSW5mbyk6IHN0cmluZwoJbG9jYWwgSXNSZWNlaXZlID0gRGF0YS5Jc1JlY2VpdmUKCWxvY2FsIE1ldGhvZCA9IERhdGEuTWV0aG9kCglsb2NhbCBBcmdzID0gRGF0YS5BcmdzCgoJbG9jYWwgUmVtb3RlVmFyaWFibGUgPSBJbmZvLlJlbW90ZVZhcmlhYmxlCglsb2NhbCBJbmRlbnQgPSBJbmZvLkluZGVudCBvciAwCglsb2NhbCBNb2R1bGUgPSBJbmZvLk1vZHVsZQoKCWxvY2FsIFZhcmlhYmxlcyA9IE1vZHVsZS5WYXJpYWJsZXMKCWxvY2FsIFBhcnNlciA9IE1vZHVsZS5QYXJzZXIKCWxvY2FsIE5vVmFyaWFibGVzID0gRGF0YS5Ob1ZhcmlhYmxlcwoKCWxvY2FsIEluZGVudFN0cmluZyA9IHNlbGY6TWFrZUluZGVudChJbmRlbnQpCgoJLS0vLyBQYXJzZSBhcmd1bWVudHMKCWxvY2FsIFBhcnNlZEFyZ3MsIEl0ZW1zQ291bnQsIElzQXJyYXkgPSBQYXJzZXI6UGFyc2VUYWJsZUludG9TdHJpbmcoewoJCU5vQnJhY2tldHMgPSB0cnVlLAoJCU5vVmFyaWFibGVzID0gTm9WYXJpYWJsZXMsCgkJVGFibGUgPSBBcmdzLAoJCUluZGVudCA9IEluZGVudAoJfSkKCgktLS8vIENyZWF0ZSB0YWJsZSB2YXJpYWJsZSBpZiBub3QgYW4gYXJyYXkKCWlmIG5vdCBJc0FycmF5IG9yIE5vVmFyaWFibGVzIHRoZW4KCQlQYXJzZWRBcmdzID0gVmFyaWFibGVzOk1ha2VWYXJpYWJsZSh7CgkJCVZhbHVlID0gKCJ7JXN9Iik6Zm9ybWF0KFBhcnNlZEFyZ3MpLAoJCQlDb21tZW50ID0gbm90IElzQXJyYXkgYW5kICJBcmd1bWVudHMgYXJlbid0IG9yZGVyZWQiIG9yIG5pbCwKCQkJTmFtZSA9ICJSZW1vdGVBcmdzIiwKCQkJQ2xhc3MgPSAiUmVtb3RlIgoJCX0pCgllbmQKCgktLS8vIFdyYXAgaW4gYSB1bnBhY2sgaWYgdGhlIHRhYmxlIGlzIGEgZGljdAoJaWYgSXRlbXNDb3VudCA+IDAgYW5kIG5vdCBJc0FycmF5IHRoZW4KCQlQYXJzZWRBcmdzID0gYHVucGFjayh7UGFyc2VkQXJnc30sIDEsIHRhYmxlLm1heG4oe1BhcnNlZEFyZ3N9KSlgCgllbmQKCgktLS8vIEZpcmVzaWduYWwgc2NyaXB0IGZvciBjbGllbnQgcmVjaWV2ZXMKCWlmIElzUmVjZWl2ZSB0aGVuCgkJbG9jYWwgU2Vjb25kID0gSXRlbXNDb3VudCA8PSAwIGFuZCAiIiBvciBgLCB7UGFyc2VkQXJnc31gCgkJbG9jYWwgU2lnbmFsID0gYHtSZW1vdGVWYXJpYWJsZX0ue01ldGhvZH1gCgoJCWxvY2FsIENvZGUgPSBgLS0gVGhpcyBkYXRhIHdhcyByZWNlaXZlZCBmcm9tIHRoZSBzZXJ2ZXJgCgkJUGFyc2VkQXJncyA9IHNlbGY6SW5kZW50KEluZGVudFN0cmluZywgQ29kZSkKCQlDb2RlIC4uPSBgXG57SW5kZW50U3RyaW5nfWZpcmVzaWduYWwoe1NpZ25hbH17U2Vjb25kfSlgCgkJCgkJcmV0dXJuIENvZGUKCWVuZAoJCgktLS8vIFJlbW90ZSBpbnZva2Ugc2NyaXB0CglyZXR1cm4gYHtSZW1vdGVWYXJpYWJsZX06e01ldGhvZH0oe1BhcnNlZEFyZ3N9KWAKZW5kCgotLS8vIFZhcmlhYmxlczogJVZhcmlhYmxlTmFtZSUKZnVuY3Rpb24gR2VuZXJhdGlvbjpBcHBseVZhcmlhYmxlcyhTdHJpbmc6IHN0cmluZywgVmFyaWFibGVzOiB0YWJsZSwgLi4uKTogc3RyaW5nCglmb3IgVmFyaWFibGUsIFZhbHVlIGluIFZhcmlhYmxlcyBkbwoJCS0tLy8gSW52b2tlIHZhbHVlIGZ1bmN0aW9uCgkJaWYgdHlwZW9mKFZhbHVlKSA9PSAiZnVuY3Rpb24iIHRoZW4KCQkJVmFsdWUgPSBWYWx1ZSguLi4pCgkJZW5kCgoJCVN0cmluZyA9IFN0cmluZzpnc3ViKGAlJXtWYXJpYWJsZX0lJWAsIGZ1bmN0aW9uKCkKCQkJcmV0dXJuIFZhbHVlCgkJZW5kKQoJZW5kCglyZXR1cm4gU3RyaW5nCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlSW5kZW50KEluZGVudDogbnVtYmVyKQoJcmV0dXJuIHN0cmluZy5yZXAoIgkiLCBJbmRlbnQpCmVuZAoKdHlwZSBTY3JpcHREYXRhID0gewoJVmFyaWFibGVzOiB0YWJsZSwKCU1ldGFNZXRob2Q6IHN0cmluZwp9CmZ1bmN0aW9uIEdlbmVyYXRpb246TWFrZUNhbGxDb2RlKFNjcmlwdFR5cGU6IHN0cmluZywgRGF0YTogU2NyaXB0RGF0YSk6IHN0cmluZwoJbG9jYWwgU2NyaXB0VGVtcGxhdGVzID0gc2VsZi5TY3JpcHRUZW1wbGF0ZXMKCWxvY2FsIFRlbXBsYXRlID0gU2NyaXB0VGVtcGxhdGVzW1NjcmlwdFR5cGVdCgoJYXNzZXJ0KFRlbXBsYXRlLCBge1NjcmlwdFR5cGV9IGlzIG5vdCBhIHZhbGlkIHNjcmlwdCB0eXBlIWApCgoJbG9jYWwgVmFyaWFibGVzID0gRGF0YS5WYXJpYWJsZXMKCWxvY2FsIE1ldGFNZXRob2QgPSBEYXRhLk1ldGFNZXRob2QKCWxvY2FsIE1ldGFNZXRob2RzID0geyJfX2luZGV4IiwgIl9fbmFtZWNhbGwiLCAiQ29ubmVjdCJ9CgoJbG9jYWwgZnVuY3Rpb24gQ29tcGlsZShUZW1wbGF0ZTogdGFibGUpOiBzdHJpbmcKCQlsb2NhbCBPdXQgPSAiIgoKCQlmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBUZW1wbGF0ZSBkbwoJCQktLS8vIE1ldGFNZXRob2QgY2hlY2sKCQkJbG9jYWwgSXNNZXRhVHlwZU9ubHkgPSB0YWJsZS5maW5kKE1ldGFNZXRob2RzLCBLZXkpCgkJCWlmIElzTWV0YVR5cGVPbmx5IHRoZW4KCQkJCWlmIEtleSA9PSBNZXRhTWV0aG9kIHRoZW4KCQkJCQlsb2NhbCBMaW5lID0gQ29tcGlsZShWYWx1ZSkKCQkJCQlPdXQgLi49IExpbmUKCQkJCWVuZAoJCQkJY29udGludWUKCQkJZW5kCgoJCQktLS8vIEluZm9ybWF0aW9uCgkJCWxvY2FsIENvbnRlbnQsIEluZGVudCA9IFZhbHVlWzFdLCBWYWx1ZVsyXSBvciAwCgkJCUluZGVudCA9IG1hdGguY2xhbXAoSW5kZW50LTEsIDAsIDk5OTkpCgoJCQktLS8vIE1ha2UgbGluZQoJCQlsb2NhbCBMaW5lID0gc2VsZjpBcHBseVZhcmlhYmxlcyhDb250ZW50LCBWYXJpYWJsZXMsIEluZGVudCkKCQkJbG9jYWwgSW5kZW50U3RyaW5nID0gc2VsZjpNYWtlSW5kZW50KEluZGVudCkKCgkJCS0tLy8gQXBwZW5kIHRvIGNvZGUKCQkJT3V0IC4uPSBge0luZGVudFN0cmluZ317TGluZX1cbmAKCQllbmQKCgkJcmV0dXJuIE91dAoJZW5kCgkKCXJldHVybiBDb21waWxlKFRlbXBsYXRlKQplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246UmVtb3RlU2NyaXB0KE1vZHVsZSwgRGF0YTogUmVtb3RlRGF0YSwgU2NyaXB0VHlwZTogc3RyaW5nKTogc3RyaW5nCgktLS8vIFVucGFjayBkYXRhCglsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQoJbG9jYWwgQXJncyA9IERhdGEuQXJncwoJbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKCWxvY2FsIE1ldGFNZXRob2QgPSBEYXRhLk1ldGFNZXRob2QKCgktLS8vIFJlbW90ZSBpbmZvCglsb2NhbCBDbGFzc05hbWUgPSBIb29rOkluZGV4KFJlbW90ZSwgIkNsYXNzTmFtZSIpCglsb2NhbCBJc05pbFBhcmVudCA9IEhvb2s6SW5kZXgoUmVtb3RlLCAiUGFyZW50IikgPT0gbmlsCgkKCWxvY2FsIFZhcmlhYmxlcyA9IE1vZHVsZS5WYXJpYWJsZXMKCWxvY2FsIEZvcm1hdHRlciA9IE1vZHVsZS5Gb3JtYXR0ZXIKCQoJLS0vLyBQcmUtcmVuZGVyIHZhcmlhYmxlcwoJVmFyaWFibGVzOlByZXJlbmRlclZhcmlhYmxlcyhBcmdzLCB7Ikluc3RhbmNlIn0pCgoJLS0vLyBDcmVhdGUgcmVtb3RlIHZhcmlhYmxlCglsb2NhbCBSZW1vdGVWYXJpYWJsZSA9IFZhcmlhYmxlczpNYWtlVmFyaWFibGUoewoJCVZhbHVlID0gRm9ybWF0dGVyOkZvcm1hdChSZW1vdGUsIHsKCQkJTm9WYXJpYWJsZXMgPSB0cnVlCgkJfSksCgkJQ29tbWVudCA9IGB7Q2xhc3NOYW1lfSB7SXNOaWxQYXJlbnQgYW5kICJ8IFJlbW90ZSBwYXJlbnQgaXMgbmlsIiBvciAiIn1gLAoJCU5hbWUgPSBGb3JtYXR0ZXI6TWFrZU5hbWUoUmVtb3RlKSwKCQlMb29rdXAgPSBSZW1vdGUsCgkJQ2xhc3MgPSAiUmVtb3RlIgoJfSkKCgktLS8vIEdlbmVyYXRlIGNhbGwgc2NyaXB0Cglsb2NhbCBDYWxsQ29kZSA9IHNlbGY6TWFrZUNhbGxDb2RlKFNjcmlwdFR5cGUsIHsKCQlWYXJpYWJsZXMgPSB7CgkJCVsiUmVtb3RlQ2FsbCJdID0gZnVuY3Rpb24oSW5kZW50OiBudW1iZXIpCgkJCQlyZXR1cm4gc2VsZjpDYWxsUmVtb3RlU2NyaXB0KERhdGEsIHsKCQkJCQlSZW1vdGVWYXJpYWJsZSA9IFJlbW90ZVZhcmlhYmxlLAoJCQkJCUluZGVudCA9IEluZGVudCwKCQkJCQlNb2R1bGUgPSBNb2R1bGUKCQkJCX0pCgkJCWVuZCwKCQkJWyJSZW1vdGUiXSA9IFJlbW90ZVZhcmlhYmxlLAoJCQlbIk1ldGhvZCJdID0gTWV0aG9kLAoJCQlbIlNpZ25hbCJdID0gYHtSZW1vdGVWYXJpYWJsZX0ue01ldGhvZH1gCgkJfSwKCQlNZXRhTWV0aG9kID0gTWV0YU1ldGhvZAoJfSkKCQoJLS0vLyBNYWtlIGNvZGUKCWxvY2FsIENvZGUgPSBzZWxmOkdldEJhc2UoTW9kdWxlKQoJcmV0dXJuIGB7Q29kZX1cbntDYWxsQ29kZX1gCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpDb25uZWN0aW9uc1RhYmxlKFNpZ25hbDogUkJYU2NyaXB0U2lnbmFsKTogdGFibGUKCWxvY2FsIENvbm5lY3Rpb25zID0gZ2V0Y29ubmVjdGlvbnMoU2lnbmFsKQoJbG9jYWwgRGF0YUFycmF5ID0ge30KCglmb3IgXywgQ29ubmVjdGlvbiBpbiBuZXh0LCBDb25uZWN0aW9ucyBkbwoJCWxvY2FsIEZ1bmN0aW9uID0gQ29ubmVjdGlvbi5GdW5jdGlvbgoJCWxvY2FsIFNjcmlwdCA9IHJhd2dldChnZXRmZW52KEZ1bmN0aW9uKSwgInNjcmlwdCIpCgoJCS0tLy8gU2tpcCBpZiBzZWxmCgkJaWYgU2NyaXB0ID09IFRoaXNTY3JpcHQgdGhlbiBjb250aW51ZSBlbmQKCgkJLS0vLyBDb25uZWN0aW9uIGRhdGEKCQlsb2NhbCBEYXRhID0gewoJCQlGdW5jdGlvbiA9IEZ1bmN0aW9uLAoJCQlTdGF0ZSA9IENvbm5lY3Rpb24uU3RhdGUsCgkJCVNjcmlwdCA9IFNjcmlwdAoJCX0KCgkJdGFibGUuaW5zZXJ0KERhdGFBcnJheSwgRGF0YSkKCWVuZAoKCXJldHVybiBEYXRhQXJyYXkKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOlRhYmxlU2NyaXB0KE1vZHVsZSwgVGFibGU6IHRhYmxlKTogc3RyaW5nCgktLS8vIFByZS1yZW5kZXIgdmFyaWFibGVzCglNb2R1bGUuVmFyaWFibGVzOlByZXJlbmRlclZhcmlhYmxlcyhUYWJsZSwgeyJJbnN0YW5jZSJ9KQoKCS0tLy8gUGFyc2UgYXJndW1lbnRzCglsb2NhbCBQYXJzZWRUYWJsZSA9IE1vZHVsZS5QYXJzZXI6UGFyc2VUYWJsZUludG9TdHJpbmcoewoJCVRhYmxlID0gVGFibGUKCX0pCgoJLS0vLyBHZW5lcmF0ZSBzY3JpcHQKCWxvY2FsIENvZGUsIE5vVmFyaWFibGVzID0gc2VsZjpHZXRCYXNlKE1vZHVsZSkKCWxvY2FsIFNlcGVyYXRvciA9IE5vVmFyaWFibGVzIGFuZCAiIiBvciAiXG4iCglDb2RlIC4uPSBge1NlcGVyYXRvcn1yZXR1cm4ge1BhcnNlZFRhYmxlfWAKCglyZXR1cm4gQ29kZQplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246TWFrZVR5cGVzVGFibGUoVGFibGU6IHRhYmxlKTogdGFibGUKCWxvY2FsIFR5cGVzID0ge30KCglmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBUYWJsZSBkbwoJCWxvY2FsIFR5cGUgPSB0eXBlb2YoVmFsdWUpCgkJaWYgVHlwZSA9PSAidGFibGUiIHRoZW4KCQkJVHlwZSA9IHNlbGY6TWFrZVR5cGVzVGFibGUoVmFsdWUpCgkJZW5kCgoJCVR5cGVzW0tleV0gPSBUeXBlCgllbmQKCglyZXR1cm4gVHlwZXMKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkNvbm5lY3Rpb25JbmZvKFJlbW90ZTogSW5zdGFuY2UsIENsYXNzRGF0YTogdGFibGUpOiB0YWJsZT8KCWxvY2FsIFJlY2VpdmVNZXRob2RzID0gQ2xhc3NEYXRhLlJlY2VpdmUKCWlmIG5vdCBSZWNlaXZlTWV0aG9kcyB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBDb25uZWN0aW9ucyA9IHt9Cglmb3IgXywgTWV0aG9kOiBzdHJpbmcgaW4gbmV4dCwgUmVjZWl2ZU1ldGhvZHMgZG8KCQlwY2FsbChmdW5jdGlvbigpIC0tIFRPRE86IEdFVENBTExCQUNLVkFMVUUKCQkJbG9jYWwgU2lnbmFsID0gSG9vazpJbmRleChSZW1vdGUsIE1ldGhvZCkKCQkJQ29ubmVjdGlvbnNbTWV0aG9kXSA9IHNlbGY6Q29ubmVjdGlvbnNUYWJsZShTaWduYWwpCgkJZW5kKQoJZW5kCgoJcmV0dXJuIENvbm5lY3Rpb25zCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpBZHZhbmNlZEluZm8oTW9kdWxlLCBEYXRhOiB0YWJsZSk6IHN0cmluZwoJLS0vLyBVbnBhY2sgcmVtb3RlIGRhdGEKCWxvY2FsIEZ1bmN0aW9uID0gRGF0YS5DYWxsaW5nRnVuY3Rpb24KCWxvY2FsIENsYXNzRGF0YSA9IERhdGEuQ2xhc3NEYXRhCglsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQoJbG9jYWwgQXJncyA9IERhdGEuQXJncwoJCgktLS8vIEFkdmFuY2VkIGluZm8gdGFibGUgYmFzZQoJbG9jYWwgRnVuY3Rpb25JbmZvID0gewoJCVsiQ2FsbGVyIl0gPSB7CgkJCVsiU291cmNlU2NyaXB0Il0gPSBEYXRhLlNvdXJjZVNjcmlwdCwKCQkJWyJDYWxsaW5nU2NyaXB0Il0gPSBEYXRhLkNhbGxpbmdTY3JpcHQsCgkJCVsiQ2FsbGluZ0Z1bmN0aW9uIl0gPSBGdW5jdGlvbgoJCX0sCgkJWyJSZW1vdGUiXSA9IHsKCQkJWyJSZW1vdGUiXSA9IFJlbW90ZSwKCQkJWyJSZW1vdGVJRCJdID0gRGF0YS5JZCwKCQkJWyJNZXRob2QiXSA9IERhdGEuTWV0aG9kLAoJCQlbIkNvbm5lY3Rpb25zIl0gPSBzZWxmOkNvbm5lY3Rpb25JbmZvKFJlbW90ZSwgQ2xhc3NEYXRhKQoJCX0sCgkJWyJBcmd1bWVudHMiXSA9IHsKCQkJWyJMZW5ndGgiXSA9ICNBcmdzLAoJCQlbIlR5cGVzIl0gPSBzZWxmOk1ha2VUeXBlc1RhYmxlKEFyZ3MpLAoJCX0sCgkJWyJNZXRhTWV0aG9kIl0gPSBEYXRhLk1ldGFNZXRob2QsCgkJWyJJc0FjdG9yIl0gPSBEYXRhLklzQWN0b3IsCgl9CgoJLS0vLyBTb21lIGNsb3N1cmVzIG1heSBub3QgYmUgbHVhCglpZiBGdW5jdGlvbiBhbmQgaXNsY2xvc3VyZShGdW5jdGlvbikgdGhlbgoJCUZ1bmN0aW9uSW5mb1siVXBWYWx1ZXMiXSA9IGRlYnVnLmdldHVwdmFsdWVzKEZ1bmN0aW9uKQoJCUZ1bmN0aW9uSW5mb1siQ29uc3RhbnRzIl0gPSBkZWJ1Zy5nZXRjb25zdGFudHMoRnVuY3Rpb24pCgllbmQKCgktLS8vIEdlbmVyYXRlIHNjcmlwdAoJcmV0dXJuIHNlbGY6VGFibGVTY3JpcHQoTW9kdWxlLCBGdW5jdGlvbkluZm8pCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpEdW1wTG9ncyhMb2dzOiB0YWJsZSk6IHN0cmluZwoJbG9jYWwgQmFzZURhdGEKCWxvY2FsIFBhcnNlZCA9IHsKCQlSZW1vdGUgPSBuaWwsCgkJQ2FsbHMgPSB7fQoJfQoKCS0tLy8gQ3JlYXRlIG5ldyBwYXJzZXIgaW5zdGFuY2UKCWxvY2FsIE1vZHVsZSA9IEdlbmVyYXRpb246TmV3UGFyc2VyKCkKCglmb3IgXywgRGF0YSBpbiBMb2dzIGRvCgkJbG9jYWwgQ2FsbHMgPSBQYXJzZWQuQ2FsbHMKCQlsb2NhbCBUYWJsZSA9IHsKCQkJQXJncyA9IERhdGEuQXJncywKCQkJVGltZXN0YW1wID0gRGF0YS5UaW1lc3RhbXAsCgkJCVJldHVyblZhbHVlcyA9IERhdGEuUmV0dXJuVmFsdWVzLAoJCQlNZXRob2QgPSBEYXRhLk1ldGhvZCwKCQkJTWV0YU1ldGhvZCA9IERhdGEuTWV0YU1ldGhvZCwKCQkJQ2FsbGluZ1NjcmlwdCA9IERhdGEuQ2FsbGluZ1NjcmlwdCwKCQl9CgoJCS0tLy8gQXBwZW5kCgkJdGFibGUuaW5zZXJ0KENhbGxzLCBUYWJsZSkKCgkJLS0vLyBTZXQgQmFzZURhdGEKCQlpZiBub3QgQmFzZURhdGEgdGhlbgoJCQlCYXNlRGF0YSA9IERhdGEKCQllbmQKCWVuZAoKCS0tLy8gQmFzZWRhdGEgbWVyZ2UKCVBhcnNlZC5SZW1vdGUgPSBCYXNlRGF0YS5SZW1vdGUKCgktLS8vIENvbXBpbGUgYW5kIHNhdmUKCWxvY2FsIE91dHB1dCA9IHNlbGY6VGFibGVTY3JpcHQoTW9kdWxlLCBQYXJzZWQpCglsb2NhbCBGaWxlUGF0aCA9IHNlbGY6V3JpdGVEdW1wKE91dHB1dCkKCQoJcmV0dXJuIEZpbGVQYXRoCmVuZAoKcmV0dXJuIEdlbmVyYXRpb24=]],
},Communication={'base64',
[[dHlwZSB0YWJsZSA9IHsNCiAgICBbYW55XTogYW55DQp9DQoNCi0tLy8gTW9kdWxlDQpsb2NhbCBNb2R1bGUgPSB7DQogICAgQ29tbUNhbGxiYWNrcyA9IHt9DQp9DQoNCmxvY2FsIENvbW1XcmFwcGVyID0ge30NCkNvbW1XcmFwcGVyLl9faW5kZXggPSBDb21tV3JhcHBlcg0KDQotLS8vIFNlcmlhbGl6ZXIgY2FjaGUNCmxvY2FsIFNlcmlhbGl6ZUNhY2hlID0gc2V0bWV0YXRhYmxlKHt9LCB7X19tb2RlID0gImsifSkNCmxvY2FsIERlc2VyaWFsaXplQ2FjaGUgPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAiayJ9KQ0KDQotLS8vIFNlcnZpY2VzDQpsb2NhbCBDb3JlR3VpDQoNCi0tLy8gTW9kdWxlcw0KbG9jYWwgSG9vaw0KbG9jYWwgQ2hhbm5lbA0KbG9jYWwgQ29uZmlnDQpsb2NhbCBQcm9jZXNzDQoNCmZ1bmN0aW9uIE1vZHVsZTpJbml0KERhdGEpDQogICAgbG9jYWwgTW9kdWxlcyA9IERhdGEuTW9kdWxlcw0KICAgIGxvY2FsIFNlcnZpY2VzID0gRGF0YS5TZXJ2aWNlcw0KDQogICAgSG9vayA9IE1vZHVsZXMuSG9vaw0KICAgIFByb2Nlc3MgPSBNb2R1bGVzLlByb2Nlc3MNCiAgICBDb25maWcgPSBNb2R1bGVzLkNvbmZpZyBvciBDb25maWcNCiAgICBDb3JlR3VpID0gU2VydmljZXMuQ29yZUd1aQ0KZW5kDQoNCmZ1bmN0aW9uIENvbW1XcmFwcGVyOkZpcmUoLi4uKQ0KICAgIGxvY2FsIFF1ZXVlID0gc2VsZi5RdWV1ZQ0KICAgIHRhYmxlLmluc2VydChRdWV1ZSwgey4uLn0pDQplbmQNCg0KZnVuY3Rpb24gQ29tbVdyYXBwZXI6UHJvY2Vzc0FyZ3VtZW50cyhBcmd1bWVudHMpIA0KICAgIGxvY2FsIENoYW5uZWwgPSBzZWxmLkNoYW5uZWwNCiAgICBDaGFubmVsOkZpcmUoUHJvY2VzczpVbnBhY2soQXJndW1lbnRzKSkNCmVuZA0KDQpmdW5jdGlvbiBDb21tV3JhcHBlcjpQcm9jZXNzUXVldWUoKQ0KICAgIGxvY2FsIFF1ZXVlID0gc2VsZi5RdWV1ZQ0KDQogICAgZm9yIEluZGV4ID0gMSwgI1F1ZXVlIGRvDQogICAgICAgIGxvY2FsIEFyZ3VtZW50cyA9IHRhYmxlLnJlbW92ZShRdWV1ZSkNCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQ0KICAgICAgICAgICAgc2VsZjpQcm9jZXNzQXJndW1lbnRzKEFyZ3VtZW50cykgDQogICAgICAgIGVuZCkNCiAgICBlbmQNCmVuZA0KDQpmdW5jdGlvbiBDb21tV3JhcHBlcjpCZWdpblF1ZXVlU2VydmljZSgpDQogICAgY29yb3V0aW5lLndyYXAoZnVuY3Rpb24oKQ0KICAgICAgICB3aGlsZSB3YWl0KCkgZG8NCiAgICAgICAgICAgIHNlbGY6UHJvY2Vzc1F1ZXVlKCkNCiAgICAgICAgZW5kDQogICAgZW5kKSgpDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOk5ld0NvbW1XcmFwKENoYW5uZWw6IEJpbmRhYmxlRXZlbnQpDQogICAgbG9jYWwgQmFzZSA9IHsNCiAgICAgICAgUXVldWUgPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAidiJ9KSwNCiAgICAgICAgQ2hhbm5lbCA9IENoYW5uZWwsDQogICAgICAgIEV2ZW50ID0gQ2hhbm5lbC5FdmVudA0KICAgIH0NCg0KICAgIC0tLy8gQ3JlYXRlIG5ldyB3cmFwcGVyIGNsYXNzDQogICAgbG9jYWwgV3JhcHBlZCA9IHNldG1ldGF0YWJsZShCYXNlLCBDb21tV3JhcHBlcikNCiAgICBXcmFwcGVkOkJlZ2luUXVldWVTZXJ2aWNlKCkNCg0KICAgIHJldHVybiBXcmFwcGVkDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOk1ha2VEZWJ1Z0lkSGFuZGxlcigpOiBCaW5kYWJsZUZ1bmN0aW9uDQogICAgLS0vLyBVc2luZyBCaW5kYWJsZUZ1bmN0aW9uIGFzIGl0IGRvZXMgbm90IHJlcXVpcmUgYSB0aHJlYWQgcGVybWlzc2lvbiBjaGFuZ2UNCiAgICBsb2NhbCBSZW1vdGUgPSBJbnN0YW5jZS5uZXcoIkJpbmRhYmxlRnVuY3Rpb24iKQ0KICAgIGZ1bmN0aW9uIFJlbW90ZS5Pbkludm9rZShPYmplY3Q6IEluc3RhbmNlKTogc3RyaW5nDQogICAgICAgIHJldHVybiBPYmplY3Q6R2V0RGVidWdJZCgpDQogICAgZW5kDQoNCiAgICBzZWxmLkRlYnVnSWRSZW1vdGUgPSBSZW1vdGUNCiAgICBzZWxmLkRlYnVnSWRJbnZva2UgPSBSZW1vdGUuSW52b2tlDQoNCiAgICByZXR1cm4gUmVtb3RlDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkdldERlYnVnSWQoT2JqZWN0OiBJbnN0YW5jZSk6IHN0cmluZw0KICAgIGxvY2FsIEludm9rZSA9IHNlbGYuRGVidWdJZEludm9rZQ0KICAgIGxvY2FsIFJlbW90ZSA9IHNlbGYuRGVidWdJZFJlbW90ZQ0KCXJldHVybiBJbnZva2UoUmVtb3RlLCBPYmplY3QpDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkdldEhpZGRlblBhcmVudCgpOiBJbnN0YW5jZQ0KICAgIC0tLy8gVXNlIGdldGh1aSBpZiBpdCBleGlzdHMNCiAgICBpZiBnZXRodWkgdGhlbiByZXR1cm4gZ2V0aHVpKCkgZW5kDQogICAgcmV0dXJuIENvcmVHdWkNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6Q3JlYXRlQ29tbUNoYW5uZWwoKTogKG51bWJlciwgQmluZGFibGVFdmVudCkNCiAgICAtLS8vIFVzZSBuYXRpdmUgaWYgaXQgZXhpc3RzDQogICAgbG9jYWwgRm9yY2UgPSBDb25maWcgYW5kIENvbmZpZy5Gb3JjZVVzZUN1c3RvbUNvbW0gb3IgZmFsc2UNCiAgICBpZiBjcmVhdGVfY29tbV9jaGFubmVsIGFuZCBub3QgRm9yY2UgdGhlbg0KICAgICAgICByZXR1cm4gY3JlYXRlX2NvbW1fY2hhbm5lbCgpDQogICAgZW5kDQoNCiAgICBsb2NhbCBQYXJlbnQgPSBzZWxmOkdldEhpZGRlblBhcmVudCgpDQogICAgbG9jYWwgQ2hhbm5lbElkID0gbWF0aC5yYW5kb20oMSwgMTAwMDAwMDApDQoNCiAgICAtLS8vIEJpbmRhYmxlRXZlbnQNCiAgICBsb2NhbCBDaGFubmVsID0gSW5zdGFuY2UubmV3KCJCaW5kYWJsZUV2ZW50IiwgUGFyZW50KQ0KICAgIENoYW5uZWwuTmFtZSA9IENoYW5uZWxJZA0KDQogICAgcmV0dXJuIENoYW5uZWxJZCwgQ2hhbm5lbA0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpHZXRDb21tQ2hhbm5lbChDaGFubmVsSWQ6IG51bWJlcik6IEJpbmRhYmxlRXZlbnQ/DQogICAgLS0vLyBVc2UgbmF0aXZlIGlmIGl0IGV4aXN0cw0KICAgIGxvY2FsIEZvcmNlID0gQ29uZmlnIGFuZCBDb25maWcuRm9yY2VVc2VDdXN0b21Db21tIG9yIGZhbHNlDQogICAgaWYgZ2V0X2NvbW1fY2hhbm5lbCBhbmQgbm90IEZvcmNlIHRoZW4NCiAgICAgICAgbG9jYWwgQ2hhbm5lbCA9IGdldF9jb21tX2NoYW5uZWwoQ2hhbm5lbElkKQ0KICAgICAgICByZXR1cm4gQ2hhbm5lbCwgZmFsc2UNCiAgICBlbmQNCg0KICAgIGxvY2FsIFBhcmVudCA9IHNlbGY6R2V0SGlkZGVuUGFyZW50KCkNCiAgICBsb2NhbCBDaGFubmVsID0gUGFyZW50OkZpbmRGaXJzdENoaWxkKENoYW5uZWxJZCkNCg0KICAgIC0tLy8gV3JhcCB0aGUgY2hhbm5lbCAoUHJldmVudHMgdGhyZWFkIHBlcm1pc3Npb24gZXJyb3JzKQ0KICAgIGxvY2FsIFdyYXBwZWQgPSBzZWxmOk5ld0NvbW1XcmFwKENoYW5uZWwpDQogICAgcmV0dXJuIFdyYXBwZWQsIHRydWUNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6Q2hlY2tWYWx1ZShWYWx1ZSwgSW5ib3VuZDogYm9vbGVhbj8pDQogICAgIC0tLy8gTm8gc2VyaWFsaXppbmcgIG5lZWRlZA0KICAgIGlmIHR5cGVvZihWYWx1ZSkgfj0gInRhYmxlIiB0aGVuIA0KICAgICAgICByZXR1cm4gVmFsdWUgDQogICAgZW5kDQogICANCiAgICAtLS8vIERlc2VyaWFsaXplDQogICAgaWYgSW5ib3VuZCB0aGVuDQogICAgICAgIHJldHVybiBzZWxmOkRlc2VyaWFsaXplVGFibGUoVmFsdWUpDQogICAgZW5kDQoNCiAgICAtLS8vIFNlcmlhbGl6ZQ0KICAgIHJldHVybiBzZWxmOlNlcmlhbGl6ZVRhYmxlKFZhbHVlKQ0KZW5kDQoNCmxvY2FsIFRpY2sgPSAwDQpmdW5jdGlvbiBNb2R1bGU6V2FpdENoZWNrKCkNCiAgICBUaWNrICs9IDENCiAgICBpZiBUaWNrID4gNDAgdGhlbg0KICAgICAgICBUaWNrID0gMCAtLSBJIGNvdWxkIHVzZSBtb2R1bHVzIGhlcmUgYnV0IHRoZSBpbnRlcmdlciB3aWxsIGJlIG1hc3NpdmUNCiAgICAgICAgd2FpdCgpDQogICAgZW5kDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOk1ha2VQYWNrZXQoSW5kZXgsIFZhbHVlKTogdGFibGUNCiAgICBzZWxmOldhaXRDaGVjaygpDQogICAgcmV0dXJuIHsNCiAgICAgICAgSW5kZXggPSBzZWxmOkNoZWNrVmFsdWUoSW5kZXgpLCANCiAgICAgICAgVmFsdWUgPSBzZWxmOkNoZWNrVmFsdWUoVmFsdWUpDQogICAgfQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpSZWFkUGFja2V0KFBhY2tldDogdGFibGUpOiAoYW55LCBhbnkpDQogICAgaWYgdHlwZW9mKFBhY2tldCkgfj0gInRhYmxlIiB0aGVuIHJldHVybiBQYWNrZXQgZW5kDQogICAgDQogICAgbG9jYWwgS2V5ID0gc2VsZjpDaGVja1ZhbHVlKFBhY2tldC5JbmRleCwgdHJ1ZSkNCiAgICBsb2NhbCBWYWx1ZSA9IHNlbGY6Q2hlY2tWYWx1ZShQYWNrZXQuVmFsdWUsIHRydWUpDQogICAgc2VsZjpXYWl0Q2hlY2soKQ0KDQogICAgcmV0dXJuIEtleSwgVmFsdWUNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6U2VyaWFsaXplVGFibGUoVGFibGU6IHRhYmxlKTogdGFibGUNCiAgICAtLS8vIENoZWNrIGNhY2hlIGZvciBleGlzdGluZw0KICAgIGxvY2FsIENhY2hlZCA9IFNlcmlhbGl6ZUNhY2hlW1RhYmxlXQ0KICAgIGlmIENhY2hlZCB0aGVuIHJldHVybiBDYWNoZWQgZW5kDQoNCiAgICBsb2NhbCBTZXJpYWxpemVkID0ge30NCiAgICBTZXJpYWxpemVDYWNoZVtUYWJsZV0gPSBTZXJpYWxpemVkDQoNCiAgICBmb3IgSW5kZXgsIFZhbHVlIGluIG5leHQsIFRhYmxlIGRvDQogICAgICAgIGxvY2FsIFBhY2tldCA9IHNlbGY6TWFrZVBhY2tldChJbmRleCwgVmFsdWUpDQogICAgICAgIHRhYmxlLmluc2VydChTZXJpYWxpemVkLCBQYWNrZXQpDQogICAgZW5kDQoNCiAgICByZXR1cm4gU2VyaWFsaXplZA0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpEZXNlcmlhbGl6ZVRhYmxlKFNlcmlhbGl6ZWQ6IHRhYmxlKTogdGFibGUNCiAgICAtLS8vIENoZWNrIGZvciBjYWNoZWQNCiAgICBsb2NhbCBDYWNoZWQgPSBEZXNlcmlhbGl6ZUNhY2hlW1NlcmlhbGl6ZWRdDQogICAgaWYgQ2FjaGVkIHRoZW4gcmV0dXJuIENhY2hlZCBlbmQNCg0KICAgIGxvY2FsIFRhYmxlID0ge30NCiAgICBEZXNlcmlhbGl6ZUNhY2hlW1NlcmlhbGl6ZWRdID0gVGFibGUNCiAgICANCiAgICBmb3IgXywgUGFja2V0IGluIG5leHQsIFNlcmlhbGl6ZWQgZG8NCiAgICAgICAgbG9jYWwgSW5kZXgsIFZhbHVlID0gc2VsZjpSZWFkUGFja2V0KFBhY2tldCkNCiAgICAgICAgaWYgSW5kZXggPT0gbmlsIHRoZW4gY29udGludWUgZW5kDQoNCiAgICAgICAgVGFibGVbSW5kZXhdID0gVmFsdWUNCiAgICBlbmQNCg0KICAgIHJldHVybiBUYWJsZQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpTZXRDaGFubmVsKE5ld0NoYW5uZWw6IG51bWJlcikNCiAgICBDaGFubmVsID0gTmV3Q2hhbm5lbA0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpDb25zb2xlUHJpbnQoLi4uKQ0KICAgIHNlbGY6Q29tbXVuaWNhdGUoIlByaW50IiwgLi4uKQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpRdWV1ZUxvZyhEYXRhKQ0KICAgIHNwYXduKGZ1bmN0aW9uKCkNCiAgICAgICAgbG9jYWwgU2VyaWFsaXplZEFyZ3MgPSBzZWxmOlNlcmlhbGl6ZVRhYmxlKERhdGEuQXJncykNCiAgICAgICAgRGF0YS5BcmdzID0gU2VyaWFsaXplZEFyZ3MNCg0KICAgICAgICBzZWxmOkNvbW11bmljYXRlKCJRdWV1ZUxvZyIsIERhdGEpDQogICAgZW5kKQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpBZGRDb21tQ2FsbGJhY2soVHlwZTogc3RyaW5nLCBDYWxsYmFjazogKC4uLmFueSkgLT4gLi4uYW55KQ0KICAgIGxvY2FsIENvbW1DYWxsYmFja3MgPSBzZWxmLkNvbW1DYWxsYmFja3MNCiAgICBDb21tQ2FsbGJhY2tzW1R5cGVdID0gQ2FsbGJhY2sNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6R2V0Q29tbUNhbGxiYWNrKFR5cGU6IHN0cmluZyk6ICguLi5hbnkpIC0+IC4uLmFueQ0KICAgIGxvY2FsIENvbW1DYWxsYmFja3MgPSBzZWxmLkNvbW1DYWxsYmFja3MNCiAgICByZXR1cm4gQ29tbUNhbGxiYWNrc1tUeXBlXQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgUHJvcGVydHk6IHN0cmluZykNCiAgICBpZiB0eXBlb2YoQ2hhbm5lbCkgPT0gIkluc3RhbmNlIiB0aGVuDQogICAgICAgIHJldHVybiBIb29rOkluZGV4KENoYW5uZWwsIFByb3BlcnR5KQ0KICAgIGVuZA0KDQogICAgLS0vLyBTb21lIGV4ZWN1dG9ycyByZXR1cm4gYSBVc2VyRGF0YSB0eXBlDQogICAgcmV0dXJuIENoYW5uZWxbUHJvcGVydHldDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkNvbW11bmljYXRlKC4uLikNCiAgICBsb2NhbCBGaXJlID0gc2VsZjpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgIkZpcmUiKQ0KICAgIEZpcmUoQ2hhbm5lbCwgLi4uKQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpBZGRDb25uZWN0aW9uKENhbGxiYWNrKTogUkJYU2NyaXB0Q29ubmVjdGlvbg0KICAgIGxvY2FsIEV2ZW50ID0gc2VsZjpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgIkV2ZW50IikNCiAgICByZXR1cm4gRXZlbnQ6Q29ubmVjdChDYWxsYmFjaykNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6QWRkVHlwZUNhbGxiYWNrKFR5cGU6IHN0cmluZywgQ2FsbGJhY2spOiBSQlhTY3JpcHRDb25uZWN0aW9uDQogICAgbG9jYWwgRXZlbnQgPSBzZWxmOkNoYW5uZWxJbmRleChDaGFubmVsLCAiRXZlbnQiKQ0KICAgIHJldHVybiBFdmVudDpDb25uZWN0KGZ1bmN0aW9uKFJlY2l2ZWRUeXBlOiBzdHJpbmcsIC4uLikNCiAgICAgICAgaWYgUmVjaXZlZFR5cGUgfj0gVHlwZSB0aGVuIHJldHVybiBlbmQNCiAgICAgICAgQ2FsbGJhY2soLi4uKQ0KICAgIGVuZCkNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6QWRkVHlwZUNhbGxiYWNrcyhUeXBlczogdGFibGUpDQogICAgZm9yIFR5cGU6IHN0cmluZywgQ2FsbGJhY2sgaW4gbmV4dCwgVHlwZXMgZG8NCiAgICAgICAgc2VsZjpBZGRUeXBlQ2FsbGJhY2soVHlwZSwgQ2FsbGJhY2spDQogICAgZW5kDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkNyZWF0ZUNoYW5uZWwoKTogbnVtYmVyDQogICAgbG9jYWwgQ2hhbm5lbElELCBFdmVudCA9IHNlbGY6Q3JlYXRlQ29tbUNoYW5uZWwoKQ0KDQogICAgLS0vLyBDb25uZWN0IEdldENvbW1DYWxsYmFjayBmdW5jdGlvbg0KICAgIEV2ZW50LkV2ZW50OkNvbm5lY3QoZnVuY3Rpb24oVHlwZTogc3RyaW5nLCAuLi4pDQogICAgICAgIGxvY2FsIENhbGxiYWNrID0gc2VsZjpHZXRDb21tQ2FsbGJhY2soVHlwZSkNCiAgICAgICAgaWYgQ2FsbGJhY2sgdGhlbg0KICAgICAgICAgICAgQ2FsbGJhY2soLi4uKQ0KICAgICAgICBlbmQNCiAgICBlbmQpDQoNCiAgICByZXR1cm4gQ2hhbm5lbElELCBFdmVudA0KZW5kDQoNCk1vZHVsZTpNYWtlRGVidWdJZEhhbmRsZXIoKQ0KDQpyZXR1cm4gTW9kdWxl]]
}},d.Players local i=e:LoadLibraries(g)local j,k,l,m,n,o,p=i.Process,i.Hook,i.Ui
,i.Generation,i.Communication,i.Config,e:GetAsset('ProggyClean.ttf',true)local q
=e:CreateFont('ProggyClean',p)l:SetFontFile(q)j:CheckConfig(o)e:LoadModules(i,{
Modules=i,Services=d})local r,s=l:CreateMainWindow(),j:CheckIsSupported()if not
s then r:Close()return end local t,u=n:CreateChannel()n:AddCommCallback(
'QueueLog',function(...)l:QueueLog(...)end)n:AddCommCallback('Print',function(
...)l:ConsoleLog(...)end)local v=h.LocalPlayer m:SetSwapsCallback(function(w)w:
AddSwap(v,{String='LocalPlayer'})w:AddSwap(v.Character,{String='Character',
NextParent=v})end)l:CreateWindowContent(r)l:SetCommChannel(u)l:BeginLogService()
local w=e:MakeActorScript(g,t)k:LoadHooks(w,t)local x=l:AskUser{Title=
'Enable function patches?',Content={
[[On some executors, function patches can prevent common detections that executor has]]
,
[[By enabling this, it MAY trigger hook detections in some games, this is why you are asked.]]
,"If it doesn't work, rejoin and press 'No'",'',
'(This does not affect game functionality)'},Options={'Yes','No'}}=='Yes'u:Fire(
'BeginHooks',{PatchFunctions=x})
